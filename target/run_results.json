{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.6", "generated_at": "2024-09-09T01:43:30.607645Z", "invocation_id": "33201a61-d9f7-4a88-8b92-475d9eb4f961", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-09T01:43:28.683526Z", "completed_at": "2024-09-09T01:43:28.698166Z"}, {"name": "execute", "started_at": "2024-09-09T01:43:28.698611Z", "completed_at": "2024-09-09T01:43:30.528404Z"}], "thread_id": "Thread-1", "execution_time": 1.9179260730743408, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b6e7c7-0103-0748-0000-0002ef22c919"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.banxware_assignment.transformed_sales_data", "compiled": true, "compiled_code": "-- models/transformed_sales_data.sql\n\n\n\nWITH raw_data AS (\n    SELECT\n        ORDER_ID AS order_id,\n        ORDER_DATE AS order_date,\n        CUSTOMER_ID AS customer_id,\n        PRODUCT_ID AS product_id,\n        PRODUCT_NAME AS product_name,\n        QUANTITY AS quantity,\n        PRICE AS price,\n        ORDER_STATUS AS order_status\n    FROM HOME_ASSIGNMENT.PUBLIC.raw_sales_data\n),\n\n-- Extract year, month, and day from order_date\nextracted_date AS (\n    SELECT\n        order_id,\n        order_date,\n        customer_id,\n        product_id,\n        product_name,\n        quantity,\n        price,\n        order_status,\n        EXTRACT(YEAR FROM TO_DATE(order_date, 'MM/DD/YYYY')) AS order_year,\n        EXTRACT(MONTH FROM TO_DATE(order_date, 'MM/DD/YYYY')) AS order_month,\n        EXTRACT(DAY FROM TO_DATE(order_date, 'MM/DD/YYYY')) AS order_day\n    FROM raw_data\n),\n\n-- Calculate total sales amount for each order\naggregated_data AS (\n    SELECT\n        order_id,\n        customer_id,\n        order_year,\n        order_month,\n        order_day,\n        SUM(quantity * price) AS total_sales_amount\n    FROM extracted_date\n    GROUP BY\n        order_id,\n        customer_id,\n        order_year,\n        order_month,\n        order_day\n)\n\nSELECT * FROM aggregated_data", "relation_name": "HOME_ASSIGNMENT.PUBLIC.transformed_sales_data"}], "elapsed_time": 3.1810569763183594, "args": {"empty": false, "warn_error_options": {"include": [], "exclude": []}, "require_resource_names_without_spaces": false, "profiles_dir": "/Users/neerajchauhan/.dbt", "write_json": true, "log_level": "info", "log_level_file": "debug", "partial_parse": true, "require_explicit_package_overrides_for_builtin_materializations": true, "use_colors": true, "which": "run", "select": ["transformed_sales_data"], "printer_width": 80, "log_format_file": "debug", "log_path": "/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs", "version_check": true, "enable_legacy_logger": false, "defer": false, "project_dir": "/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment", "send_anonymous_usage_stats": true, "populate_cache": true, "quiet": false, "strict_mode": false, "macro_debugging": false, "invocation_command": "dbt run --models transformed_sales_data", "partial_parse_file_diff": true, "vars": {}, "log_file_max_bytes": 10485760, "cache_selected_only": false, "static_parser": true, "exclude": [], "source_freshness_run_project_hooks": false, "indirect_selection": "eager", "log_format": "default", "use_colors_file": true, "introspect": true, "favor_state": false, "print": true, "show_resource_report": false}}