[0m23:09:19.021499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105051430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10715b5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10715ba30>]}


============================== 23:09:19.025567 | e13b2584-f613-4e87-8641-d382f0c61b84 ==============================
[0m23:09:19.025567 [info ] [MainThread]: Running with dbt=1.8.6
[0m23:09:19.026076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/neerajchauhan/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:09:19.036326 [info ] [MainThread]: dbt version: 1.8.6
[0m23:09:19.036672 [info ] [MainThread]: python version: 3.9.7
[0m23:09:19.036925 [info ] [MainThread]: python path: /Users/neerajchauhan/mambaforge/envs/virat/bin/python
[0m23:09:19.037167 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m23:09:20.079942 [info ] [MainThread]: Using profiles dir at /Users/neerajchauhan/.dbt
[0m23:09:20.080378 [info ] [MainThread]: Using profiles.yml file at /Users/neerajchauhan/.dbt/profiles.yml
[0m23:09:20.080648 [info ] [MainThread]: Using dbt_project.yml file at /Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/dbt_project.yml
[0m23:09:20.081142 [info ] [MainThread]: adapter type: snowflake
[0m23:09:20.081393 [info ] [MainThread]: adapter version: 1.8.3
[0m23:09:20.172850 [info ] [MainThread]: Configuration:
[0m23:09:20.173283 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:09:20.173542 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:09:20.173787 [info ] [MainThread]: Required dependencies:
[0m23:09:20.174098 [debug] [MainThread]: Executing "git --help"
[0m23:09:20.217180 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:09:20.218164 [debug] [MainThread]: STDERR: "b''"
[0m23:09:20.218543 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:09:20.218851 [info ] [MainThread]: Connection:
[0m23:09:20.219200 [info ] [MainThread]:   account: wqhpkrz-hu74532
[0m23:09:20.219428 [info ] [MainThread]:   user: NEERAJ4527
[0m23:09:20.219651 [info ] [MainThread]:   database: HOME_ASSIGNMENT
[0m23:09:20.219868 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m23:09:20.220085 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m23:09:20.220298 [info ] [MainThread]:   schema: PUBLIC
[0m23:09:20.220516 [info ] [MainThread]:   authenticator: None
[0m23:09:20.220730 [info ] [MainThread]:   oauth_client_id: None
[0m23:09:20.220944 [info ] [MainThread]:   query_tag: None
[0m23:09:20.221157 [info ] [MainThread]:   client_session_keep_alive: False
[0m23:09:20.221372 [info ] [MainThread]:   host: None
[0m23:09:20.221585 [info ] [MainThread]:   port: None
[0m23:09:20.221799 [info ] [MainThread]:   proxy_host: None
[0m23:09:20.222013 [info ] [MainThread]:   proxy_port: None
[0m23:09:20.222228 [info ] [MainThread]:   protocol: None
[0m23:09:20.222442 [info ] [MainThread]:   connect_retries: 1
[0m23:09:20.222655 [info ] [MainThread]:   connect_timeout: None
[0m23:09:20.222870 [info ] [MainThread]:   retry_on_database_errors: False
[0m23:09:20.223085 [info ] [MainThread]:   retry_all: False
[0m23:09:20.223300 [info ] [MainThread]:   insecure_mode: False
[0m23:09:20.223517 [info ] [MainThread]:   reuse_connections: None
[0m23:09:20.224154 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:09:20.232051 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m23:09:20.233872 [debug] [MainThread]: Using snowflake connection "debug"
[0m23:09:20.234201 [debug] [MainThread]: On debug: select 1 as id
[0m23:09:20.234478 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:09:20.736410 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.502 seconds
[0m23:09:20.740443 [debug] [MainThread]: On debug: Close
[0m23:09:20.831132 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m23:09:20.832228 [info ] [MainThread]: [32mAll checks passed![0m
[0m23:09:20.838092 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.8867006, "process_user_time": 3.597487, "process_kernel_time": 0.538458, "process_mem_max_rss": "183861248", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:09:20.839007 [debug] [MainThread]: Command `dbt debug` succeeded at 23:09:20.838830 after 1.89 seconds
[0m23:09:20.839597 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:09:20.840198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105051430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e6d5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b2a0a60>]}
[0m23:09:20.840815 [debug] [MainThread]: Flushing usage events
[0m23:17:24.706707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065974f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086c8dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086c8310>]}


============================== 23:17:24.711005 | 9cacd3d0-a37a-4883-aa35-8bc8e52f9c9a ==============================
[0m23:17:24.711005 [info ] [MainThread]: Running with dbt=1.8.6
[0m23:17:24.711533 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs', 'version_check': 'True', 'profiles_dir': '/Users/neerajchauhan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:17:24.721733 [info ] [MainThread]: dbt version: 1.8.6
[0m23:17:24.722067 [info ] [MainThread]: python version: 3.9.7
[0m23:17:24.722327 [info ] [MainThread]: python path: /Users/neerajchauhan/mambaforge/envs/virat/bin/python
[0m23:17:24.722568 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m23:17:25.768649 [info ] [MainThread]: Using profiles dir at /Users/neerajchauhan/.dbt
[0m23:17:25.769096 [info ] [MainThread]: Using profiles.yml file at /Users/neerajchauhan/.dbt/profiles.yml
[0m23:17:25.769359 [info ] [MainThread]: Using dbt_project.yml file at /Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/dbt_project.yml
[0m23:17:25.769902 [info ] [MainThread]: adapter type: snowflake
[0m23:17:25.770228 [info ] [MainThread]: adapter version: 1.8.3
[0m23:17:25.862844 [info ] [MainThread]: Configuration:
[0m23:17:25.863273 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:17:25.863535 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:17:25.863781 [info ] [MainThread]: Required dependencies:
[0m23:17:25.864093 [debug] [MainThread]: Executing "git --help"
[0m23:17:25.914804 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:17:25.916018 [debug] [MainThread]: STDERR: "b''"
[0m23:17:25.916339 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:17:25.916616 [info ] [MainThread]: Connection:
[0m23:17:25.916925 [info ] [MainThread]:   account: wqhpkrz-hu74532
[0m23:17:25.917158 [info ] [MainThread]:   user: NEERAJ4527
[0m23:17:25.917384 [info ] [MainThread]:   database: HOME_ASSIGNMENT
[0m23:17:25.917606 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m23:17:25.917824 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m23:17:25.918043 [info ] [MainThread]:   schema: PUBLIC
[0m23:17:25.918267 [info ] [MainThread]:   authenticator: None
[0m23:17:25.918487 [info ] [MainThread]:   oauth_client_id: None
[0m23:17:25.918704 [info ] [MainThread]:   query_tag: None
[0m23:17:25.918923 [info ] [MainThread]:   client_session_keep_alive: False
[0m23:17:25.919140 [info ] [MainThread]:   host: None
[0m23:17:25.919352 [info ] [MainThread]:   port: None
[0m23:17:25.919598 [info ] [MainThread]:   proxy_host: None
[0m23:17:25.919813 [info ] [MainThread]:   proxy_port: None
[0m23:17:25.920026 [info ] [MainThread]:   protocol: None
[0m23:17:25.920239 [info ] [MainThread]:   connect_retries: 1
[0m23:17:25.920451 [info ] [MainThread]:   connect_timeout: None
[0m23:17:25.920665 [info ] [MainThread]:   retry_on_database_errors: False
[0m23:17:25.920878 [info ] [MainThread]:   retry_all: False
[0m23:17:25.921088 [info ] [MainThread]:   insecure_mode: False
[0m23:17:25.921299 [info ] [MainThread]:   reuse_connections: None
[0m23:17:25.921864 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:17:25.928069 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m23:17:25.929528 [debug] [MainThread]: Using snowflake connection "debug"
[0m23:17:25.929829 [debug] [MainThread]: On debug: select 1 as id
[0m23:17:25.930078 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:17:26.432814 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.503 seconds
[0m23:17:26.435281 [debug] [MainThread]: On debug: Close
[0m23:17:26.546182 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m23:17:26.548073 [info ] [MainThread]: [32mAll checks passed![0m
[0m23:17:26.553562 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.9171147, "process_user_time": 3.554584, "process_kernel_time": 0.543867, "process_mem_max_rss": "184942592", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:17:26.554571 [debug] [MainThread]: Command `dbt debug` succeeded at 23:17:26.554381 after 1.92 seconds
[0m23:17:26.555139 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:17:26.555722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065974f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120206be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120284e50>]}
[0m23:17:26.556360 [debug] [MainThread]: Flushing usage events
[0m23:17:34.493784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102467460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104598dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104598280>]}


============================== 23:17:34.497736 | cbd038f4-f7e5-4643-a0e6-47408c111718 ==============================
[0m23:17:34.497736 [info ] [MainThread]: Running with dbt=1.8.6
[0m23:17:34.498251 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/neerajchauhan/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:17:35.426149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbd038f4-f7e5-4643-a0e6-47408c111718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026cdc10>]}
[0m23:17:35.486648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbd038f4-f7e5-4643-a0e6-47408c111718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e9f3b50>]}
[0m23:17:35.488197 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:17:35.504465 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m23:17:35.505293 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:17:35.505634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cbd038f4-f7e5-4643-a0e6-47408c111718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11eaf4b20>]}
[0m23:17:36.692975 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:17:36.693451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cbd038f4-f7e5-4643-a0e6-47408c111718', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ee0a280>]}
[0m23:17:36.906255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbd038f4-f7e5-4643-a0e6-47408c111718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f2a9130>]}
[0m23:17:37.007311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbd038f4-f7e5-4643-a0e6-47408c111718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f298ac0>]}
[0m23:17:37.007827 [info ] [MainThread]: Found 2 models, 2 seeds, 4 data tests, 448 macros
[0m23:17:37.008124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbd038f4-f7e5-4643-a0e6-47408c111718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11eeb8c40>]}
[0m23:17:37.009300 [info ] [MainThread]: 
[0m23:17:37.009761 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:17:37.013618 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOME_ASSIGNMENT'
[0m23:17:37.025901 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT"
[0m23:17:37.026218 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT"} */
show terse schemas in database HOME_ASSIGNMENT
    limit 10000
[0m23:17:37.026477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:17:37.453568 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.427 seconds
[0m23:17:37.457647 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: Close
[0m23:17:37.569928 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT, now list_HOME_ASSIGNMENT_PUBLIC)
[0m23:17:37.584861 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT_PUBLIC"
[0m23:17:37.585354 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT_PUBLIC"} */
show objects in HOME_ASSIGNMENT.PUBLIC limit 10000
[0m23:17:37.585752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:17:37.928533 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.342 seconds
[0m23:17:37.933490 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: Close
[0m23:17:38.039581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbd038f4-f7e5-4643-a0e6-47408c111718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10272f940>]}
[0m23:17:38.041297 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:17:38.042056 [info ] [MainThread]: 
[0m23:17:38.047166 [debug] [Thread-1  ]: Began running node seed.banxware_assignment.customers
[0m23:17:38.047877 [debug] [Thread-2  ]: Began running node seed.banxware_assignment.sales
[0m23:17:38.048708 [info ] [Thread-1  ]: 1 of 2 START seed file PUBLIC.raw_customer ..................................... [RUN]
[0m23:17:38.049490 [info ] [Thread-2  ]: 2 of 2 START seed file PUBLIC.raw_sales ........................................ [RUN]
[0m23:17:38.050245 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT_PUBLIC, now seed.banxware_assignment.customers)
[0m23:17:38.051346 [debug] [Thread-2  ]: Acquiring new snowflake connection 'seed.banxware_assignment.sales'
[0m23:17:38.051944 [debug] [Thread-1  ]: Began compiling node seed.banxware_assignment.customers
[0m23:17:38.052473 [debug] [Thread-2  ]: Began compiling node seed.banxware_assignment.sales
[0m23:17:38.053062 [debug] [Thread-1  ]: Began executing node seed.banxware_assignment.customers
[0m23:17:38.053592 [debug] [Thread-2  ]: Began executing node seed.banxware_assignment.sales
[0m23:17:38.113709 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:17:38.118859 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:17:38.119187 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
create table HOME_ASSIGNMENT.PUBLIC.raw_customer (id integer,name text)
[0m23:17:38.119511 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
create table HOME_ASSIGNMENT.PUBLIC.raw_sales (order_id integer,order_date text,customer_id integer,product_id integer,product_name text,quantity integer,price float8,order_status text)
[0m23:17:38.119805 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:17:38.120097 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:17:38.507443 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.387 seconds
[0m23:17:38.534466 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:17:38.535547 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.415 seconds
[0m23:17:38.536060 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
BEGIN
[0m23:17:38.541681 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:17:38.542425 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
BEGIN
[0m23:17:38.629597 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.086 seconds
[0m23:17:38.631188 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.089 seconds
[0m23:17:38.639129 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:17:38.640978 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:17:38.641588 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
insert into HOME_ASSIGNMENT.PUBLIC.raw_sales (order_id, order_date, customer_id, product_id, product_name, quantity, price, order_status) values
            (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,...
[0m23:17:38.642240 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
insert into HOME_ASSIGNMENT.PUBLIC.raw_customer (id, name) values
            (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)...
[0m23:17:39.414968 [debug] [Thread-2  ]: SQL status: SUCCESS 100 in 0.772 seconds
[0m23:17:39.417368 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:17:39.418602 [debug] [Thread-1  ]: SQL status: SUCCESS 60 in 0.771 seconds
[0m23:17:39.419160 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
COMMIT
[0m23:17:39.419829 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:17:39.421702 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
COMMIT
[0m23:17:39.722061 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.299 seconds
[0m23:17:39.723695 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.303 seconds
[0m23:17:39.734185 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.banxware_assignment.customers"
[0m23:17:39.735502 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.banxware_assignment.sales"
[0m23:17:39.777764 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: Close
[0m23:17:39.779283 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: Close
[0m23:17:39.853278 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbd038f4-f7e5-4643-a0e6-47408c111718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026cc190>]}
[0m23:17:39.853914 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbd038f4-f7e5-4643-a0e6-47408c111718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11efa63a0>]}
[0m23:17:39.854482 [info ] [Thread-1  ]: 1 of 2 OK loaded seed file PUBLIC.raw_customer ................................. [[32mINSERT 60[0m in 1.80s]
[0m23:17:39.855063 [info ] [Thread-2  ]: 2 of 2 OK loaded seed file PUBLIC.raw_sales .................................... [[32mINSERT 100[0m in 1.80s]
[0m23:17:39.855690 [debug] [Thread-1  ]: Finished running node seed.banxware_assignment.customers
[0m23:17:39.856219 [debug] [Thread-2  ]: Finished running node seed.banxware_assignment.sales
[0m23:17:39.857406 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:17:39.857738 [debug] [MainThread]: Connection 'seed.banxware_assignment.customers' was properly closed.
[0m23:17:39.858007 [debug] [MainThread]: Connection 'seed.banxware_assignment.sales' was properly closed.
[0m23:17:39.858352 [info ] [MainThread]: 
[0m23:17:39.858664 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 2.85 seconds (2.85s).
[0m23:17:39.859415 [debug] [MainThread]: Command end result
[0m23:17:39.889144 [info ] [MainThread]: 
[0m23:17:39.889559 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:17:39.889823 [info ] [MainThread]: 
[0m23:17:39.890089 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:17:39.892584 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 5.4634814, "process_user_time": 5.769881, "process_kernel_time": 0.324456, "process_mem_max_rss": "199786496", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:17:39.893020 [debug] [MainThread]: Command `dbt seed` succeeded at 23:17:39.892946 after 5.46 seconds
[0m23:17:39.893331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102467460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11eefbee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ef7d130>]}
[0m23:17:39.893644 [debug] [MainThread]: Flushing usage events
[0m23:19:02.342812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cc64f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091f8340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091f8d30>]}


============================== 23:19:02.347398 | caa18fcd-3a78-4b85-b1e4-9f63bb0ffd6c ==============================
[0m23:19:02.347398 [info ] [MainThread]: Running with dbt=1.8.6
[0m23:19:02.347926 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/neerajchauhan/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:19:03.523133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'caa18fcd-3a78-4b85-b1e4-9f63bb0ffd6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091a4a00>]}
[0m23:19:03.583743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'caa18fcd-3a78-4b85-b1e4-9f63bb0ffd6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109072d30>]}
[0m23:19:03.585303 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:19:03.602575 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m23:19:03.706932 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:19:03.707434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'caa18fcd-3a78-4b85-b1e4-9f63bb0ffd6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d22b80>]}
[0m23:19:04.860199 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:19:04.860664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'caa18fcd-3a78-4b85-b1e4-9f63bb0ffd6c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ff20df0>]}
[0m23:19:05.059371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'caa18fcd-3a78-4b85-b1e4-9f63bb0ffd6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12aceb130>]}
[0m23:19:05.158949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'caa18fcd-3a78-4b85-b1e4-9f63bb0ffd6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ad73340>]}
[0m23:19:05.159444 [info ] [MainThread]: Found 2 models, 2 seeds, 4 data tests, 448 macros
[0m23:19:05.159742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'caa18fcd-3a78-4b85-b1e4-9f63bb0ffd6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12acf1250>]}
[0m23:19:05.160904 [info ] [MainThread]: 
[0m23:19:05.161354 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:19:05.165146 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOME_ASSIGNMENT'
[0m23:19:05.177132 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT"
[0m23:19:05.177441 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT"} */
show terse schemas in database HOME_ASSIGNMENT
    limit 10000
[0m23:19:05.177704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:19:05.632059 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.454 seconds
[0m23:19:05.636314 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: Close
[0m23:19:05.742842 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT, now list_HOME_ASSIGNMENT_PUBLIC)
[0m23:19:05.758946 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT_PUBLIC"
[0m23:19:05.759427 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT_PUBLIC"} */
show objects in HOME_ASSIGNMENT.PUBLIC limit 10000
[0m23:19:05.759813 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:19:06.132782 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.373 seconds
[0m23:19:06.138113 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: Close
[0m23:19:06.229575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'caa18fcd-3a78-4b85-b1e4-9f63bb0ffd6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070c7040>]}
[0m23:19:06.230948 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:19:06.231659 [info ] [MainThread]: 
[0m23:19:06.235923 [debug] [Thread-1  ]: Began running node seed.banxware_assignment.customers
[0m23:19:06.236602 [debug] [Thread-2  ]: Began running node seed.banxware_assignment.sales
[0m23:19:06.237455 [info ] [Thread-1  ]: 1 of 2 START seed file PUBLIC.raw_customer_data ................................ [RUN]
[0m23:19:06.238266 [info ] [Thread-2  ]: 2 of 2 START seed file PUBLIC.raw_sales_data ................................... [RUN]
[0m23:19:06.239752 [debug] [Thread-2  ]: Acquiring new snowflake connection 'seed.banxware_assignment.sales'
[0m23:19:06.238999 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT_PUBLIC, now seed.banxware_assignment.customers)
[0m23:19:06.240742 [debug] [Thread-2  ]: Began compiling node seed.banxware_assignment.sales
[0m23:19:06.241331 [debug] [Thread-1  ]: Began compiling node seed.banxware_assignment.customers
[0m23:19:06.241871 [debug] [Thread-2  ]: Began executing node seed.banxware_assignment.sales
[0m23:19:06.242378 [debug] [Thread-1  ]: Began executing node seed.banxware_assignment.customers
[0m23:19:06.303998 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:19:06.304915 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:19:06.305254 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
create table HOME_ASSIGNMENT.PUBLIC.raw_customer_data (id integer,name text)
[0m23:19:06.305585 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
create table HOME_ASSIGNMENT.PUBLIC.raw_sales_data (order_id integer,order_date text,customer_id integer,product_id integer,product_name text,quantity integer,price float8,order_status text)
[0m23:19:06.305900 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:19:06.306172 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:19:06.983821 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.678 seconds
[0m23:19:07.006526 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:19:07.007595 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
BEGIN
[0m23:19:07.008621 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.702 seconds
[0m23:19:07.014837 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:19:07.015564 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
BEGIN
[0m23:19:07.092492 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.084 seconds
[0m23:19:07.095442 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:19:07.096231 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
insert into HOME_ASSIGNMENT.PUBLIC.raw_customer_data (id, name) values
            (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%...
[0m23:19:07.099385 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.083 seconds
[0m23:19:07.107787 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:19:07.108536 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
insert into HOME_ASSIGNMENT.PUBLIC.raw_sales_data (order_id, order_date, customer_id, product_id, product_name, quantity, price, order_status) values
            (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%...
[0m23:19:07.685371 [debug] [Thread-2  ]: SQL status: SUCCESS 100 in 0.576 seconds
[0m23:19:07.688027 [debug] [Thread-1  ]: SQL status: SUCCESS 60 in 0.591 seconds
[0m23:19:07.689123 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:19:07.690180 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:19:07.690817 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
COMMIT
[0m23:19:07.691374 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
COMMIT
[0m23:19:07.992182 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.299 seconds
[0m23:19:07.993582 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.302 seconds
[0m23:19:08.001775 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.banxware_assignment.customers"
[0m23:19:08.002854 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.banxware_assignment.sales"
[0m23:19:08.045366 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: Close
[0m23:19:08.046812 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: Close
[0m23:19:08.120394 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caa18fcd-3a78-4b85-b1e4-9f63bb0ffd6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070641c0>]}
[0m23:19:08.121063 [info ] [Thread-2  ]: 2 of 2 OK loaded seed file PUBLIC.raw_sales_data ............................... [[32mINSERT 100[0m in 1.88s]
[0m23:19:08.121714 [debug] [Thread-2  ]: Finished running node seed.banxware_assignment.sales
[0m23:19:08.144096 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caa18fcd-3a78-4b85-b1e4-9f63bb0ffd6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a833070>]}
[0m23:19:08.144735 [info ] [Thread-1  ]: 1 of 2 OK loaded seed file PUBLIC.raw_customer_data ............................ [[32mINSERT 60[0m in 1.91s]
[0m23:19:08.145431 [debug] [Thread-1  ]: Finished running node seed.banxware_assignment.customers
[0m23:19:08.146760 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:19:08.147188 [debug] [MainThread]: Connection 'seed.banxware_assignment.customers' was properly closed.
[0m23:19:08.147541 [debug] [MainThread]: Connection 'seed.banxware_assignment.sales' was properly closed.
[0m23:19:08.147951 [info ] [MainThread]: 
[0m23:19:08.148369 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 2.99 seconds (2.99s).
[0m23:19:08.149354 [debug] [MainThread]: Command end result
[0m23:19:08.194674 [info ] [MainThread]: 
[0m23:19:08.195155 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:19:08.195431 [info ] [MainThread]: 
[0m23:19:08.195701 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:19:08.198207 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 5.9315133, "process_user_time": 5.875162, "process_kernel_time": 0.431669, "process_mem_max_rss": "199262208", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:19:08.198643 [debug] [MainThread]: Command `dbt seed` succeeded at 23:19:08.198563 after 5.93 seconds
[0m23:19:08.198962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cc64f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fd087c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089d3f10>]}
[0m23:19:08.199289 [debug] [MainThread]: Flushing usage events
[0m23:21:50.312226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103159400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105254d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052541c0>]}


============================== 23:21:50.316455 | c76d0144-4083-467b-8eb9-0fdfd2d715ed ==============================
[0m23:21:50.316455 [info ] [MainThread]: Running with dbt=1.8.6
[0m23:21:50.316963 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/neerajchauhan/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:21:51.498721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c76d0144-4083-467b-8eb9-0fdfd2d715ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033956a0>]}
[0m23:21:51.559467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c76d0144-4083-467b-8eb9-0fdfd2d715ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f05eb0>]}
[0m23:21:51.560576 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:21:51.576763 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m23:21:51.713398 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:21:51.713905 [debug] [MainThread]: Partial parsing: added file: banxware_assignment://models/example/transformed_sales_data.sql
[0m23:21:51.940471 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.banxware_assignment.transformed_sales_data' (models/example/transformed_sales_data.sql) depends on a node named 'raw_sales_data' which was not found
[0m23:21:51.943232 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.6989788, "process_user_time": 4.05124, "process_kernel_time": 0.39637, "process_mem_max_rss": "190808064", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:21:51.943677 [debug] [MainThread]: Command `dbt run` failed at 23:21:51.943594 after 1.70 seconds
[0m23:21:51.943996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103159400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1276a0b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051fae80>]}
[0m23:21:51.944320 [debug] [MainThread]: Flushing usage events
[0m23:28:17.439042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107365460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094705b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109470bb0>]}


============================== 23:28:17.443222 | 893712b2-2327-45d9-8ea9-a0addef33616 ==============================
[0m23:28:17.443222 [info ] [MainThread]: Running with dbt=1.8.6
[0m23:28:17.443767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs', 'profiles_dir': '/Users/neerajchauhan/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:28:18.615730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '893712b2-2327-45d9-8ea9-a0addef33616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109403670>]}
[0m23:28:18.676101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '893712b2-2327-45d9-8ea9-a0addef33616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e5a940>]}
[0m23:28:18.677646 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:28:18.694316 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m23:28:18.832188 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m23:28:18.832712 [debug] [MainThread]: Partial parsing: added file: banxware_assignment://models/example/transformed_sales_data.sql
[0m23:28:18.833128 [debug] [MainThread]: Partial parsing: updated file: banxware_assignment://models/example/schema.yml
[0m23:28:19.134185 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:28:19.134656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '893712b2-2327-45d9-8ea9-a0addef33616', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128719880>]}
[0m23:28:19.244922 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.banxware_assignment.transformed_sales_data' (models/example/transformed_sales_data.sql) depends on a node named 'raw_sales_data' which was not found
[0m23:28:19.249575 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.879624, "process_user_time": 4.206205, "process_kernel_time": 0.393784, "process_mem_max_rss": "186843136", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:28:19.250039 [debug] [MainThread]: Command `dbt run` failed at 23:28:19.249929 after 1.88 seconds
[0m23:28:19.250357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107365460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129482b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129482730>]}
[0m23:28:19.250675 [debug] [MainThread]: Flushing usage events
[0m23:28:29.553972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104619550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10674cd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10674c1c0>]}


============================== 23:28:29.557892 | 73a6f410-10c3-4f4c-a7f6-e88e9f1034d7 ==============================
[0m23:28:29.557892 [info ] [MainThread]: Running with dbt=1.8.6
[0m23:28:29.558373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs', 'debug': 'False', 'profiles_dir': '/Users/neerajchauhan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:28:30.471251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73a6f410-10c3-4f4c-a7f6-e88e9f1034d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10488d6a0>]}
[0m23:28:30.530845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73a6f410-10c3-4f4c-a7f6-e88e9f1034d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122cf3520>]}
[0m23:28:30.531668 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:28:30.549278 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m23:28:30.684259 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m23:28:30.684795 [debug] [MainThread]: Partial parsing: added file: banxware_assignment://models/example/transformed_sales_data.sql
[0m23:28:30.685220 [debug] [MainThread]: Partial parsing: updated file: banxware_assignment://models/example/schema.yml
[0m23:28:30.966460 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:28:30.966930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '73a6f410-10c3-4f4c-a7f6-e88e9f1034d7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123fcebb0>]}
[0m23:28:31.077447 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.banxware_assignment.transformed_sales_data' (models/example/transformed_sales_data.sql) depends on a node named 'raw_sales_data' which was not found
[0m23:28:31.080918 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 1.5913445, "process_user_time": 4.227378, "process_kernel_time": 0.291718, "process_mem_max_rss": "198180864", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:28:31.081364 [debug] [MainThread]: Command `dbt seed` failed at 23:28:31.081280 after 1.59 seconds
[0m23:28:31.081686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104619550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124a82ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124a826a0>]}
[0m23:28:31.081998 [debug] [MainThread]: Flushing usage events
[0m23:29:25.934987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074bd400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111935430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111935fa0>]}


============================== 23:29:25.939378 | d12811cf-bbbf-4f13-9592-54625e385a04 ==============================
[0m23:29:25.939378 [info ] [MainThread]: Running with dbt=1.8.6
[0m23:29:25.939954 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/neerajchauhan/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt list', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:29:27.120183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd12811cf-bbbf-4f13-9592-54625e385a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11197dca0>]}
[0m23:29:27.180478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd12811cf-bbbf-4f13-9592-54625e385a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c61c10>]}
[0m23:29:27.181988 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:29:27.199357 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m23:29:27.338125 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m23:29:27.338676 [debug] [MainThread]: Partial parsing: added file: banxware_assignment://models/example/transformed_sales_data.sql
[0m23:29:27.339114 [debug] [MainThread]: Partial parsing: updated file: banxware_assignment://models/example/schema.yml
[0m23:29:27.621361 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:29:27.621841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd12811cf-bbbf-4f13-9592-54625e385a04', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15584c880>]}
[0m23:29:27.730824 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.banxware_assignment.transformed_sales_data' (models/example/transformed_sales_data.sql) depends on a node named 'raw_sales_data' which was not found
[0m23:29:27.734489 [debug] [MainThread]: Resource report: {"command_name": "list", "command_wall_clock_time": 1.8739916, "process_user_time": 4.211116, "process_kernel_time": 0.406381, "process_mem_max_rss": "193167360", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:29:27.734930 [debug] [MainThread]: Command `dbt list` failed at 23:29:27.734842 after 1.87 seconds
[0m23:29:27.735252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074bd400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155944dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1559449a0>]}
[0m23:29:27.735564 [debug] [MainThread]: Flushing usage events
[0m23:30:58.979250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095095e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109509dc0>]}


============================== 23:30:58.983391 | a6ecee77-a117-4187-b0f6-df8e0e4d09d7 ==============================
[0m23:30:58.983391 [info ] [MainThread]: Running with dbt=1.8.6
[0m23:30:58.983948 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/neerajchauhan/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt list', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:31:00.165957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6ecee77-a117-4187-b0f6-df8e0e4d09d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076336a0>]}
[0m23:31:00.225891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6ecee77-a117-4187-b0f6-df8e0e4d09d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1341d0430>]}
[0m23:31:00.227424 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:31:00.243354 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m23:31:00.380922 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:31:00.381535 [debug] [MainThread]: Partial parsing: updated file: banxware_assignment://models/example/schema.yml
[0m23:31:00.493830 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:31:00.494291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a6ecee77-a117-4187-b0f6-df8e0e4d09d7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13431ff40>]}
[0m23:31:00.505717 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'transformed_sales_data' in the 'models' section of file 'models/example/schema.yml'
[0m23:31:00.612786 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.banxware_assignment.unique_transformed_sales_data_order_id.7b8e430813' (models/example/schema.yml) depends on a node named 'transformed_sales_data' in package '' which was not found
[0m23:31:00.613239 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.banxware_assignment.not_null_transformed_sales_data_order_id.54001b98d7' (models/example/schema.yml) depends on a node named 'transformed_sales_data' in package '' which was not found
[0m23:31:00.613546 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.banxware_assignment.not_null_transformed_sales_data_order_date.fc8c228a19' (models/example/schema.yml) depends on a node named 'transformed_sales_data' in package '' which was not found
[0m23:31:00.613837 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.banxware_assignment.not_null_transformed_sales_data_customer_id.7f0272dd40' (models/example/schema.yml) depends on a node named 'transformed_sales_data' in package '' which was not found
[0m23:31:00.691502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6ecee77-a117-4187-b0f6-df8e0e4d09d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1347f6130>]}
[0m23:31:00.801657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6ecee77-a117-4187-b0f6-df8e0e4d09d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1347a39d0>]}
[0m23:31:00.804751 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.8930463, "process_user_time": 4.208745, "process_kernel_time": 0.405794, "process_mem_max_rss": "188907520", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:31:00.805206 [debug] [MainThread]: Command `dbt list` succeeded at 23:31:00.805117 after 1.89 seconds
[0m23:31:00.805524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1347d2a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107740b50>]}
[0m23:31:00.805853 [debug] [MainThread]: Flushing usage events
[0m23:31:21.735258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ef5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107038280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107038e50>]}


============================== 23:31:21.739259 | b505c1fa-4a36-499e-b1b4-4891a824afce ==============================
[0m23:31:21.739259 [info ] [MainThread]: Running with dbt=1.8.6
[0m23:31:21.739755 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/neerajchauhan/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m23:31:22.844349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b505c1fa-4a36-499e-b1b4-4891a824afce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051636a0>]}
[0m23:31:22.904122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b505c1fa-4a36-499e-b1b4-4891a824afce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12949f520>]}
[0m23:31:22.904970 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:31:22.921195 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m23:31:23.057280 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:31:23.057668 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:31:23.153236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b505c1fa-4a36-499e-b1b4-4891a824afce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129682580>]}
[0m23:31:23.252588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b505c1fa-4a36-499e-b1b4-4891a824afce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a23a070>]}
[0m23:31:23.253084 [info ] [MainThread]: Found 2 models, 2 seeds, 4 data tests, 448 macros
[0m23:31:23.253389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b505c1fa-4a36-499e-b1b4-4891a824afce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a23a580>]}
[0m23:31:23.254665 [info ] [MainThread]: 
[0m23:31:23.255133 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:31:23.258973 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOME_ASSIGNMENT'
[0m23:31:23.272311 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT"
[0m23:31:23.272631 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT"} */
show terse schemas in database HOME_ASSIGNMENT
    limit 10000
[0m23:31:23.272902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:31:23.774086 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.501 seconds
[0m23:31:23.780058 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: Close
[0m23:31:23.874837 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT, now list_HOME_ASSIGNMENT_PUBLIC)
[0m23:31:23.889940 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT_PUBLIC"
[0m23:31:23.890468 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT_PUBLIC"} */
show objects in HOME_ASSIGNMENT.PUBLIC limit 10000
[0m23:31:23.890878 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:31:24.256602 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.365 seconds
[0m23:31:24.263237 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: Close
[0m23:31:24.344041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b505c1fa-4a36-499e-b1b4-4891a824afce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1296825e0>]}
[0m23:31:24.345203 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:31:24.345726 [info ] [MainThread]: 
[0m23:31:24.349740 [debug] [Thread-1  ]: Began running node seed.banxware_assignment.customers
[0m23:31:24.350402 [debug] [Thread-2  ]: Began running node seed.banxware_assignment.sales
[0m23:31:24.351205 [info ] [Thread-1  ]: 1 of 2 START seed file PUBLIC.raw_customer_data ................................ [RUN]
[0m23:31:24.351977 [info ] [Thread-2  ]: 2 of 2 START seed file PUBLIC.raw_sales_data ................................... [RUN]
[0m23:31:24.352659 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT_PUBLIC, now seed.banxware_assignment.customers)
[0m23:31:24.353782 [debug] [Thread-2  ]: Acquiring new snowflake connection 'seed.banxware_assignment.sales'
[0m23:31:24.354324 [debug] [Thread-1  ]: Began compiling node seed.banxware_assignment.customers
[0m23:31:24.354821 [debug] [Thread-2  ]: Began compiling node seed.banxware_assignment.sales
[0m23:31:24.355284 [debug] [Thread-1  ]: Began executing node seed.banxware_assignment.customers
[0m23:31:24.355707 [debug] [Thread-2  ]: Began executing node seed.banxware_assignment.sales
[0m23:31:24.419579 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:31:24.419066 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:31:24.420060 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
BEGIN
[0m23:31:24.420395 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
BEGIN
[0m23:31:24.420692 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:31:24.420957 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:31:24.743754 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.322 seconds
[0m23:31:24.745835 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:31:24.746703 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
truncate table "HOME_ASSIGNMENT"."PUBLIC"."RAW_SALES_DATA"
  ;
[0m23:31:24.753027 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.332 seconds
[0m23:31:24.753990 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:31:24.754603 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
truncate table "HOME_ASSIGNMENT"."PUBLIC"."RAW_CUSTOMER_DATA"
  ;
[0m23:31:24.946000 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.198 seconds
[0m23:31:24.947192 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:31:24.947904 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
COMMIT
[0m23:31:24.958226 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.203 seconds
[0m23:31:24.962229 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:31:24.962926 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
COMMIT
[0m23:31:25.176745 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.228 seconds
[0m23:31:25.203563 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:31:25.204621 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
BEGIN
[0m23:31:25.205396 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.242 seconds
[0m23:31:25.208476 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:31:25.208905 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
BEGIN
[0m23:31:25.303233 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.093 seconds
[0m23:31:25.306332 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:31:25.307147 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
insert into HOME_ASSIGNMENT.PUBLIC.raw_customer_data (id, name) values
            (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%...
[0m23:31:25.310320 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.104 seconds
[0m23:31:25.318209 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:31:25.319472 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
insert into HOME_ASSIGNMENT.PUBLIC.raw_sales_data (order_id, order_date, customer_id, product_id, product_name, quantity, price, order_status) values
            (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%...
[0m23:31:26.104772 [debug] [Thread-2  ]: SQL status: SUCCESS 100 in 0.784 seconds
[0m23:31:26.106729 [debug] [Thread-1  ]: SQL status: SUCCESS 60 in 0.798 seconds
[0m23:31:26.108121 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:31:26.108997 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:31:26.109763 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
COMMIT
[0m23:31:26.110445 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
COMMIT
[0m23:31:26.340599 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.229 seconds
[0m23:31:26.358501 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.banxware_assignment.customers"
[0m23:31:26.385807 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: Close
[0m23:31:26.388486 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.277 seconds
[0m23:31:26.389284 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.banxware_assignment.sales"
[0m23:31:26.392175 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: Close
[0m23:31:26.459604 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b505c1fa-4a36-499e-b1b4-4891a824afce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10515c1c0>]}
[0m23:31:26.460330 [info ] [Thread-1  ]: 1 of 2 OK loaded seed file PUBLIC.raw_customer_data ............................ [[32mINSERT 60[0m in 2.11s]
[0m23:31:26.461065 [debug] [Thread-1  ]: Finished running node seed.banxware_assignment.customers
[0m23:31:26.470985 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b505c1fa-4a36-499e-b1b4-4891a824afce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a438fa0>]}
[0m23:31:26.471598 [info ] [Thread-2  ]: 2 of 2 OK loaded seed file PUBLIC.raw_sales_data ............................... [[32mINSERT 100[0m in 2.12s]
[0m23:31:26.472286 [debug] [Thread-2  ]: Finished running node seed.banxware_assignment.sales
[0m23:31:26.473659 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:31:26.474064 [debug] [MainThread]: Connection 'seed.banxware_assignment.customers' was properly closed.
[0m23:31:26.474415 [debug] [MainThread]: Connection 'seed.banxware_assignment.sales' was properly closed.
[0m23:31:26.474831 [info ] [MainThread]: 
[0m23:31:26.475226 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 3.22 seconds (3.22s).
[0m23:31:26.476072 [debug] [MainThread]: Command end result
[0m23:31:26.508155 [info ] [MainThread]: 
[0m23:31:26.508595 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:31:26.508865 [info ] [MainThread]: 
[0m23:31:26.509132 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:31:26.511652 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 4.84308, "process_user_time": 4.570932, "process_kernel_time": 0.407941, "process_mem_max_rss": "192266240", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:31:26.512086 [debug] [MainThread]: Command `dbt seed` succeeded at 23:31:26.512007 after 4.84 seconds
[0m23:31:26.512409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ef5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106941d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a23a070>]}
[0m23:31:26.512716 [debug] [MainThread]: Flushing usage events
[0m23:31:31.152763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10483d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069812e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106981be0>]}


============================== 23:31:31.156722 | c0755c91-42f8-41cd-a950-c8ef780294fb ==============================
[0m23:31:31.156722 [info ] [MainThread]: Running with dbt=1.8.6
[0m23:31:31.157237 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/neerajchauhan/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt list', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:31:32.050405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0755c91-42f8-41cd-a950-c8ef780294fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123805e80>]}
[0m23:31:32.110255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0755c91-42f8-41cd-a950-c8ef780294fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067fa4c0>]}
[0m23:31:32.111394 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:31:32.126734 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m23:31:32.260764 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:31:32.261142 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:31:32.356887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0755c91-42f8-41cd-a950-c8ef780294fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123aab520>]}
[0m23:31:32.464873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0755c91-42f8-41cd-a950-c8ef780294fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1237f33d0>]}
[0m23:31:32.467634 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.379891, "process_user_time": 3.964993, "process_kernel_time": 0.282178, "process_mem_max_rss": "192987136", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:31:32.468073 [debug] [MainThread]: Command `dbt list` succeeded at 23:31:32.467992 after 1.38 seconds
[0m23:31:32.468386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10483d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123805e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1237f3430>]}
[0m23:31:32.468683 [debug] [MainThread]: Flushing usage events
[0m23:34:01.321527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b224f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c64340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c64d30>]}


============================== 23:34:01.325534 | df2ec819-89e1-41c1-a028-58051490c82e ==============================
[0m23:34:01.325534 [info ] [MainThread]: Running with dbt=1.8.6
[0m23:34:01.326030 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/neerajchauhan/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:34:02.515050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df2ec819-89e1-41c1-a028-58051490c82e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c10a00>]}
[0m23:34:02.575175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df2ec819-89e1-41c1-a028-58051490c82e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aded30>]}
[0m23:34:02.576744 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:34:02.593714 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m23:34:02.732787 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:34:02.733304 [debug] [MainThread]: Partial parsing: added file: banxware_assignment://models/example/transformed_sales_data.sql
[0m23:34:03.028665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df2ec819-89e1-41c1-a028-58051490c82e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127568e80>]}
[0m23:34:03.127401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df2ec819-89e1-41c1-a028-58051490c82e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1275aac70>]}
[0m23:34:03.127904 [info ] [MainThread]: Found 3 models, 2 seeds, 4 data tests, 448 macros
[0m23:34:03.128209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df2ec819-89e1-41c1-a028-58051490c82e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127492d90>]}
[0m23:34:03.129426 [info ] [MainThread]: 
[0m23:34:03.129882 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:34:03.133825 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOME_ASSIGNMENT'
[0m23:34:03.145761 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT"
[0m23:34:03.146082 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT"} */
show terse schemas in database HOME_ASSIGNMENT
    limit 10000
[0m23:34:03.146334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:34:04.794847 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.648 seconds
[0m23:34:04.797586 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: Close
[0m23:34:04.889135 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT, now list_HOME_ASSIGNMENT_PUBLIC)
[0m23:34:04.904643 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT_PUBLIC"
[0m23:34:04.905134 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT_PUBLIC"} */
show objects in HOME_ASSIGNMENT.PUBLIC limit 10000
[0m23:34:04.905524 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:34:05.433012 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.527 seconds
[0m23:34:05.438397 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: Close
[0m23:34:05.517337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df2ec819-89e1-41c1-a028-58051490c82e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12742a610>]}
[0m23:34:05.518571 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:34:05.519255 [info ] [MainThread]: 
[0m23:34:05.523533 [debug] [Thread-1  ]: Began running node model.banxware_assignment.my_first_dbt_model
[0m23:34:05.524210 [debug] [Thread-2  ]: Began running node model.banxware_assignment.transformed_sales_data
[0m23:34:05.525025 [info ] [Thread-1  ]: 1 of 3 START sql table model PUBLIC.my_first_dbt_model ......................... [RUN]
[0m23:34:05.525822 [info ] [Thread-2  ]: 2 of 3 START sql view model PUBLIC.transformed_sales_data ...................... [RUN]
[0m23:34:05.526525 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT_PUBLIC, now model.banxware_assignment.my_first_dbt_model)
[0m23:34:05.529128 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.banxware_assignment.transformed_sales_data'
[0m23:34:05.529675 [debug] [Thread-1  ]: Began compiling node model.banxware_assignment.my_first_dbt_model
[0m23:34:05.530155 [debug] [Thread-2  ]: Began compiling node model.banxware_assignment.transformed_sales_data
[0m23:34:05.542034 [debug] [Thread-1  ]: Writing injected SQL for node "model.banxware_assignment.my_first_dbt_model"
[0m23:34:05.545570 [debug] [Thread-2  ]: Writing injected SQL for node "model.banxware_assignment.transformed_sales_data"
[0m23:34:05.547062 [debug] [Thread-2  ]: Began executing node model.banxware_assignment.transformed_sales_data
[0m23:34:05.547493 [debug] [Thread-1  ]: Began executing node model.banxware_assignment.my_first_dbt_model
[0m23:34:05.593543 [debug] [Thread-2  ]: Writing runtime sql for node "model.banxware_assignment.transformed_sales_data"
[0m23:34:05.597993 [debug] [Thread-1  ]: Writing runtime sql for node "model.banxware_assignment.my_first_dbt_model"
[0m23:34:05.599310 [debug] [Thread-1  ]: Using snowflake connection "model.banxware_assignment.my_first_dbt_model"
[0m23:34:05.600336 [debug] [Thread-2  ]: Using snowflake connection "model.banxware_assignment.transformed_sales_data"
[0m23:34:05.600674 [debug] [Thread-1  ]: On model.banxware_assignment.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.my_first_dbt_model"} */
create or replace transient table HOME_ASSIGNMENT.PUBLIC.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m23:34:05.601065 [debug] [Thread-2  ]: On model.banxware_assignment.transformed_sales_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.transformed_sales_data"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.transformed_sales_data
  
   as (
    -- models/transformed_sales_data.sql

WITH raw_data AS (
    -- Select all columns from raw_sales_data for transformation
    SELECT
        order_id,
        customer_id,
        order_date,
        order_amount,
        -- Extracting year, month, and day from the order_date field
        EXTRACT(YEAR FROM order_date) AS order_year,
        EXTRACT(MONTH FROM order_date) AS order_month,
        EXTRACT(DAY FROM order_date) AS order_day,
        -- Calculate the total sales amount for each order
        order_amount * quantity AS total_sales_amount
    FROM 
        HOME_ASSIGNMENT.PUBLIC.raw_sales_data  -- Reference the raw_sales_data seed file
)

-- Final transformation: Select required fields for the transformed table
SELECT
    order_id,
    customer_id,
    order_year,
    order_month,
    order_day,
    total_sales_amount
FROM 
    raw_data;
[0m23:34:05.601425 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:34:05.601739 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:34:05.992722 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01b6e6ce-0103-075d-0000-0002ef22894d
[0m23:34:05.993542 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 32 at position 12 unexpected ';'.
[0m23:34:05.994352 [debug] [Thread-2  ]: On model.banxware_assignment.transformed_sales_data: Close
[0m23:34:06.101402 [debug] [Thread-2  ]: Database Error in model transformed_sales_data (models/example/transformed_sales_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 32 at position 12 unexpected ';'.
  compiled Code at target/run/banxware_assignment/models/example/transformed_sales_data.sql
[0m23:34:06.104680 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df2ec819-89e1-41c1-a028-58051490c82e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104055190>]}
[0m23:34:06.105787 [error] [Thread-2  ]: 2 of 3 ERROR creating sql view model PUBLIC.transformed_sales_data ............. [[31mERROR[0m in 0.58s]
[0m23:34:06.106765 [debug] [Thread-2  ]: Finished running node model.banxware_assignment.transformed_sales_data
[0m23:34:06.872998 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.271 seconds
[0m23:34:06.906788 [debug] [Thread-1  ]: On model.banxware_assignment.my_first_dbt_model: Close
[0m23:34:07.010998 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df2ec819-89e1-41c1-a028-58051490c82e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104918c40>]}
[0m23:34:07.012820 [info ] [Thread-1  ]: 1 of 3 OK created sql table model PUBLIC.my_first_dbt_model .................... [[32mSUCCESS 1[0m in 1.48s]
[0m23:34:07.014303 [debug] [Thread-1  ]: Finished running node model.banxware_assignment.my_first_dbt_model
[0m23:34:07.015472 [debug] [Thread-4  ]: Began running node model.banxware_assignment.my_second_dbt_model
[0m23:34:07.016390 [info ] [Thread-4  ]: 3 of 3 START sql view model PUBLIC.my_second_dbt_model ......................... [RUN]
[0m23:34:07.017281 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.banxware_assignment.my_second_dbt_model'
[0m23:34:07.017840 [debug] [Thread-4  ]: Began compiling node model.banxware_assignment.my_second_dbt_model
[0m23:34:07.022586 [debug] [Thread-4  ]: Writing injected SQL for node "model.banxware_assignment.my_second_dbt_model"
[0m23:34:07.023552 [debug] [Thread-4  ]: Began executing node model.banxware_assignment.my_second_dbt_model
[0m23:34:07.027745 [debug] [Thread-4  ]: Writing runtime sql for node "model.banxware_assignment.my_second_dbt_model"
[0m23:34:07.028954 [debug] [Thread-4  ]: Using snowflake connection "model.banxware_assignment.my_second_dbt_model"
[0m23:34:07.029434 [debug] [Thread-4  ]: On model.banxware_assignment.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.my_second_dbt_model"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from HOME_ASSIGNMENT.PUBLIC.my_first_dbt_model
where id = 1
  );
[0m23:34:07.029898 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:34:07.460459 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.430 seconds
[0m23:34:07.466641 [debug] [Thread-4  ]: On model.banxware_assignment.my_second_dbt_model: Close
[0m23:34:07.547914 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df2ec819-89e1-41c1-a028-58051490c82e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1279a2df0>]}
[0m23:34:07.549221 [info ] [Thread-4  ]: 3 of 3 OK created sql view model PUBLIC.my_second_dbt_model .................... [[32mSUCCESS 1[0m in 0.53s]
[0m23:34:07.550303 [debug] [Thread-4  ]: Finished running node model.banxware_assignment.my_second_dbt_model
[0m23:34:07.552032 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:34:07.552492 [debug] [MainThread]: Connection 'model.banxware_assignment.my_first_dbt_model' was properly closed.
[0m23:34:07.552898 [debug] [MainThread]: Connection 'model.banxware_assignment.transformed_sales_data' was properly closed.
[0m23:34:07.553284 [debug] [MainThread]: Connection 'model.banxware_assignment.my_second_dbt_model' was properly closed.
[0m23:34:07.553829 [info ] [MainThread]: 
[0m23:34:07.554355 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 4.42 seconds (4.42s).
[0m23:34:07.555769 [debug] [MainThread]: Command end result
[0m23:34:07.594948 [info ] [MainThread]: 
[0m23:34:07.595365 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:34:07.595624 [info ] [MainThread]: 
[0m23:34:07.595953 [error] [MainThread]:   Database Error in model transformed_sales_data (models/example/transformed_sales_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 32 at position 12 unexpected ';'.
  compiled Code at target/run/banxware_assignment/models/example/transformed_sales_data.sql
[0m23:34:07.596215 [info ] [MainThread]: 
[0m23:34:07.596476 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:34:07.598988 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.3493724, "process_user_time": 4.808786, "process_kernel_time": 0.465499, "process_mem_max_rss": "198017024", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:34:07.599422 [debug] [MainThread]: Command `dbt run` failed at 23:34:07.599343 after 6.35 seconds
[0m23:34:07.599803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b224f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ece130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10464f4f0>]}
[0m23:34:07.600150 [debug] [MainThread]: Flushing usage events
[0m23:38:40.921014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026b5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047f8280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047f8e50>]}


============================== 23:38:40.925415 | d18c88a7-2bb3-4f2e-9776-d267ae157737 ==============================
[0m23:38:40.925415 [info ] [MainThread]: Running with dbt=1.8.6
[0m23:38:40.925934 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/neerajchauhan/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:38:42.135645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd18c88a7-2bb3-4f2e-9776-d267ae157737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10292a6a0>]}
[0m23:38:42.195644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd18c88a7-2bb3-4f2e-9776-d267ae157737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1405b3520>]}
[0m23:38:42.197340 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:38:42.214165 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m23:38:42.353057 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:38:42.353650 [debug] [MainThread]: Partial parsing: updated file: banxware_assignment://models/example/transformed_sales_data.sql
[0m23:38:42.649641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd18c88a7-2bb3-4f2e-9776-d267ae157737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140c85ee0>]}
[0m23:38:42.749144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd18c88a7-2bb3-4f2e-9776-d267ae157737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140c83fd0>]}
[0m23:38:42.749650 [info ] [MainThread]: Found 3 models, 2 seeds, 4 data tests, 448 macros
[0m23:38:42.749956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd18c88a7-2bb3-4f2e-9776-d267ae157737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140cc5cd0>]}
[0m23:38:42.751148 [info ] [MainThread]: 
[0m23:38:42.751592 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:38:42.755475 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOME_ASSIGNMENT'
[0m23:38:42.767442 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT"
[0m23:38:42.767749 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT"} */
show terse schemas in database HOME_ASSIGNMENT
    limit 10000
[0m23:38:42.768002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:38:43.557226 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.789 seconds
[0m23:38:43.561718 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: Close
[0m23:38:43.669826 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT, now list_HOME_ASSIGNMENT_PUBLIC)
[0m23:38:43.686227 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT_PUBLIC"
[0m23:38:43.686771 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT_PUBLIC"} */
show objects in HOME_ASSIGNMENT.PUBLIC limit 10000
[0m23:38:43.687165 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:38:44.491787 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.804 seconds
[0m23:38:44.497322 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: Close
[0m23:38:44.609363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd18c88a7-2bb3-4f2e-9776-d267ae157737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140c6d790>]}
[0m23:38:44.610613 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:38:44.611322 [info ] [MainThread]: 
[0m23:38:44.615661 [debug] [Thread-1  ]: Began running node model.banxware_assignment.my_first_dbt_model
[0m23:38:44.616363 [debug] [Thread-2  ]: Began running node model.banxware_assignment.transformed_sales_data
[0m23:38:44.617203 [info ] [Thread-1  ]: 1 of 3 START sql table model PUBLIC.my_first_dbt_model ......................... [RUN]
[0m23:38:44.618024 [info ] [Thread-2  ]: 2 of 3 START sql view model PUBLIC.transformed_sales_data ...................... [RUN]
[0m23:38:44.618821 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT_PUBLIC, now model.banxware_assignment.my_first_dbt_model)
[0m23:38:44.621553 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.banxware_assignment.transformed_sales_data'
[0m23:38:44.622072 [debug] [Thread-1  ]: Began compiling node model.banxware_assignment.my_first_dbt_model
[0m23:38:44.622521 [debug] [Thread-2  ]: Began compiling node model.banxware_assignment.transformed_sales_data
[0m23:38:44.638344 [debug] [Thread-2  ]: Writing injected SQL for node "model.banxware_assignment.transformed_sales_data"
[0m23:38:44.638833 [debug] [Thread-1  ]: Writing injected SQL for node "model.banxware_assignment.my_first_dbt_model"
[0m23:38:44.640369 [debug] [Thread-1  ]: Began executing node model.banxware_assignment.my_first_dbt_model
[0m23:38:44.640789 [debug] [Thread-2  ]: Began executing node model.banxware_assignment.transformed_sales_data
[0m23:38:44.688212 [debug] [Thread-1  ]: Writing runtime sql for node "model.banxware_assignment.my_first_dbt_model"
[0m23:38:44.689982 [debug] [Thread-2  ]: Writing runtime sql for node "model.banxware_assignment.transformed_sales_data"
[0m23:38:44.691987 [debug] [Thread-2  ]: Using snowflake connection "model.banxware_assignment.transformed_sales_data"
[0m23:38:44.692708 [debug] [Thread-1  ]: Using snowflake connection "model.banxware_assignment.my_first_dbt_model"
[0m23:38:44.693081 [debug] [Thread-2  ]: On model.banxware_assignment.transformed_sales_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.transformed_sales_data"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.transformed_sales_data
  
   as (
    -- models/transformed_sales_data.sql

WITH raw_data AS (
    SELECT
        ORDER_ID AS order_id,
        ORDER_DATE AS order_date,
        CUSTOMER_ID AS customer_id,
        PRODUCT_ID AS product_id,
        PRODUCT_NAME AS product_name,
        QUANTITY AS quantity,
        PRICE AS price,
        ORDER_STATUS AS order_status
    FROM HOME_ASSIGNMENT.PUBLIC.raw_sales_data
),

-- Extract year, month, and day from order_date
extracted_date AS (
    SELECT
        order_id,
        order_date,
        customer_id,
        product_id,
        product_name,
        quantity,
        price,
        order_status,
        EXTRACT(YEAR FROM TO_DATE(order_date, 'YYYY-MM-DD')) AS order_year,
        EXTRACT(MONTH FROM TO_DATE(order_date, 'YYYY-MM-DD')) AS order_month,
        EXTRACT(DAY FROM TO_DATE(order_date, 'YYYY-MM-DD')) AS order_day
    FROM raw_data
),

-- Calculate total sales amount for each order
aggregated_data AS (
    SELECT
        order_id,
        customer_id,
        order_year,
        order_month,
        order_day,
        SUM(quantity * price) AS total_sales_amount,
    FROM extracted_date
    GROUP BY
        order_id,
        customer_id,
        order_year,
        order_month,
        order_day
)

SELECT * FROM aggregated_data;
[0m23:38:44.693494 [debug] [Thread-1  ]: On model.banxware_assignment.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.my_first_dbt_model"} */
create or replace transient table HOME_ASSIGNMENT.PUBLIC.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m23:38:44.693835 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:38:44.694138 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:38:45.350937 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01b6e6d2-0103-075d-0000-0002ef228981
[0m23:38:45.351697 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 54 at position 29 unexpected ';'.
[0m23:38:45.352438 [debug] [Thread-2  ]: On model.banxware_assignment.transformed_sales_data: Close
[0m23:38:45.447555 [debug] [Thread-2  ]: Database Error in model transformed_sales_data (models/example/transformed_sales_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 54 at position 29 unexpected ';'.
  compiled Code at target/run/banxware_assignment/models/example/transformed_sales_data.sql
[0m23:38:45.450053 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd18c88a7-2bb3-4f2e-9776-d267ae157737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1419d2940>]}
[0m23:38:45.450965 [error] [Thread-2  ]: 2 of 3 ERROR creating sql view model PUBLIC.transformed_sales_data ............. [[31mERROR[0m in 0.83s]
[0m23:38:45.451779 [debug] [Thread-2  ]: Finished running node model.banxware_assignment.transformed_sales_data
[0m23:38:45.813394 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.119 seconds
[0m23:38:45.849239 [debug] [Thread-1  ]: On model.banxware_assignment.my_first_dbt_model: Close
[0m23:38:45.926257 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd18c88a7-2bb3-4f2e-9776-d267ae157737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10479fdc0>]}
[0m23:38:45.927372 [info ] [Thread-1  ]: 1 of 3 OK created sql table model PUBLIC.my_first_dbt_model .................... [[32mSUCCESS 1[0m in 1.31s]
[0m23:38:45.928152 [debug] [Thread-1  ]: Finished running node model.banxware_assignment.my_first_dbt_model
[0m23:38:45.929114 [debug] [Thread-4  ]: Began running node model.banxware_assignment.my_second_dbt_model
[0m23:38:45.929738 [info ] [Thread-4  ]: 3 of 3 START sql view model PUBLIC.my_second_dbt_model ......................... [RUN]
[0m23:38:45.930406 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.banxware_assignment.my_second_dbt_model'
[0m23:38:45.930863 [debug] [Thread-4  ]: Began compiling node model.banxware_assignment.my_second_dbt_model
[0m23:38:45.935022 [debug] [Thread-4  ]: Writing injected SQL for node "model.banxware_assignment.my_second_dbt_model"
[0m23:38:45.936004 [debug] [Thread-4  ]: Began executing node model.banxware_assignment.my_second_dbt_model
[0m23:38:45.940190 [debug] [Thread-4  ]: Writing runtime sql for node "model.banxware_assignment.my_second_dbt_model"
[0m23:38:45.941300 [debug] [Thread-4  ]: Using snowflake connection "model.banxware_assignment.my_second_dbt_model"
[0m23:38:45.941727 [debug] [Thread-4  ]: On model.banxware_assignment.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.my_second_dbt_model"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from HOME_ASSIGNMENT.PUBLIC.my_first_dbt_model
where id = 1
  );
[0m23:38:45.942113 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:38:46.367879 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.425 seconds
[0m23:38:46.375233 [debug] [Thread-4  ]: On model.banxware_assignment.my_second_dbt_model: Close
[0m23:38:46.477440 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd18c88a7-2bb3-4f2e-9776-d267ae157737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1419a54c0>]}
[0m23:38:46.479439 [info ] [Thread-4  ]: 3 of 3 OK created sql view model PUBLIC.my_second_dbt_model .................... [[32mSUCCESS 1[0m in 0.55s]
[0m23:38:46.480904 [debug] [Thread-4  ]: Finished running node model.banxware_assignment.my_second_dbt_model
[0m23:38:46.482784 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:38:46.483261 [debug] [MainThread]: Connection 'model.banxware_assignment.my_first_dbt_model' was properly closed.
[0m23:38:46.483697 [debug] [MainThread]: Connection 'model.banxware_assignment.transformed_sales_data' was properly closed.
[0m23:38:46.484099 [debug] [MainThread]: Connection 'model.banxware_assignment.my_second_dbt_model' was properly closed.
[0m23:38:46.484672 [info ] [MainThread]: 
[0m23:38:46.485188 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 3.73 seconds (3.73s).
[0m23:38:46.486604 [debug] [MainThread]: Command end result
[0m23:38:46.527540 [info ] [MainThread]: 
[0m23:38:46.527964 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:38:46.528226 [info ] [MainThread]: 
[0m23:38:46.528555 [error] [MainThread]:   Database Error in model transformed_sales_data (models/example/transformed_sales_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 54 at position 29 unexpected ';'.
  compiled Code at target/run/banxware_assignment/models/example/transformed_sales_data.sql
[0m23:38:46.528821 [info ] [MainThread]: 
[0m23:38:46.529081 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:38:46.531584 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.6802206, "process_user_time": 4.746256, "process_kernel_time": 0.562571, "process_mem_max_rss": "199163904", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:38:46.531977 [debug] [MainThread]: Command `dbt run` failed at 23:38:46.531906 after 5.68 seconds
[0m23:38:46.532287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026b5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10292a6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041db460>]}
[0m23:38:46.532593 [debug] [MainThread]: Flushing usage events
[0m23:39:57.251726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f924f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070d4340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070d4d30>]}


============================== 23:39:57.255985 | 4169d31a-11d8-4d05-be2c-09de67eee02e ==============================
[0m23:39:57.255985 [info ] [MainThread]: Running with dbt=1.8.6
[0m23:39:57.256557 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/neerajchauhan/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:39:58.428355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4169d31a-11d8-4d05-be2c-09de67eee02e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107080a00>]}
[0m23:39:58.488392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4169d31a-11d8-4d05-be2c-09de67eee02e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f4ed30>]}
[0m23:39:58.489962 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:39:58.507331 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m23:39:58.645366 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:39:58.645955 [debug] [MainThread]: Partial parsing: updated file: banxware_assignment://models/example/transformed_sales_data.sql
[0m23:39:58.942435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4169d31a-11d8-4d05-be2c-09de67eee02e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132d05e80>]}
[0m23:39:59.040430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4169d31a-11d8-4d05-be2c-09de67eee02e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132d179d0>]}
[0m23:39:59.040925 [info ] [MainThread]: Found 3 models, 2 seeds, 4 data tests, 448 macros
[0m23:39:59.041229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4169d31a-11d8-4d05-be2c-09de67eee02e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132d26220>]}
[0m23:39:59.042416 [info ] [MainThread]: 
[0m23:39:59.042864 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:39:59.046729 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOME_ASSIGNMENT'
[0m23:39:59.058775 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT"
[0m23:39:59.059093 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT"} */
show terse schemas in database HOME_ASSIGNMENT
    limit 10000
[0m23:39:59.059356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:39:59.546138 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.486 seconds
[0m23:39:59.550019 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: Close
[0m23:39:59.635312 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT, now list_HOME_ASSIGNMENT_PUBLIC)
[0m23:39:59.650865 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT_PUBLIC"
[0m23:39:59.651372 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT_PUBLIC"} */
show objects in HOME_ASSIGNMENT.PUBLIC limit 10000
[0m23:39:59.651775 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:40:00.061008 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.409 seconds
[0m23:40:00.065903 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: Close
[0m23:40:00.261946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4169d31a-11d8-4d05-be2c-09de67eee02e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132d44220>]}
[0m23:40:00.263100 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:40:00.263769 [info ] [MainThread]: 
[0m23:40:00.267948 [debug] [Thread-1  ]: Began running node model.banxware_assignment.my_first_dbt_model
[0m23:40:00.268624 [debug] [Thread-2  ]: Began running node model.banxware_assignment.transformed_sales_data
[0m23:40:00.269451 [info ] [Thread-1  ]: 1 of 3 START sql table model PUBLIC.my_first_dbt_model ......................... [RUN]
[0m23:40:00.270240 [info ] [Thread-2  ]: 2 of 3 START sql view model PUBLIC.transformed_sales_data ...................... [RUN]
[0m23:40:00.270936 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT_PUBLIC, now model.banxware_assignment.my_first_dbt_model)
[0m23:40:00.273548 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.banxware_assignment.transformed_sales_data'
[0m23:40:00.274104 [debug] [Thread-1  ]: Began compiling node model.banxware_assignment.my_first_dbt_model
[0m23:40:00.274647 [debug] [Thread-2  ]: Began compiling node model.banxware_assignment.transformed_sales_data
[0m23:40:00.286319 [debug] [Thread-1  ]: Writing injected SQL for node "model.banxware_assignment.my_first_dbt_model"
[0m23:40:00.289819 [debug] [Thread-2  ]: Writing injected SQL for node "model.banxware_assignment.transformed_sales_data"
[0m23:40:00.291152 [debug] [Thread-1  ]: Began executing node model.banxware_assignment.my_first_dbt_model
[0m23:40:00.291561 [debug] [Thread-2  ]: Began executing node model.banxware_assignment.transformed_sales_data
[0m23:40:00.339335 [debug] [Thread-1  ]: Writing runtime sql for node "model.banxware_assignment.my_first_dbt_model"
[0m23:40:00.341983 [debug] [Thread-2  ]: Writing runtime sql for node "model.banxware_assignment.transformed_sales_data"
[0m23:40:00.344275 [debug] [Thread-2  ]: Using snowflake connection "model.banxware_assignment.transformed_sales_data"
[0m23:40:00.345005 [debug] [Thread-1  ]: Using snowflake connection "model.banxware_assignment.my_first_dbt_model"
[0m23:40:00.345394 [debug] [Thread-2  ]: On model.banxware_assignment.transformed_sales_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.transformed_sales_data"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.transformed_sales_data
  
   as (
    -- models/transformed_sales_data.sql

WITH raw_data AS (
    SELECT
        ORDER_ID AS order_id,
        ORDER_DATE AS order_date,
        CUSTOMER_ID AS customer_id,
        PRODUCT_ID AS product_id,
        PRODUCT_NAME AS product_name,
        QUANTITY AS quantity,
        PRICE AS price,
        ORDER_STATUS AS order_status
    FROM HOME_ASSIGNMENT.PUBLIC.raw_sales_data
),

-- Extract year, month, and day from order_date
extracted_date AS (
    SELECT
        order_id,
        order_date,
        customer_id,
        product_id,
        product_name,
        quantity,
        price,
        order_status,
        EXTRACT(YEAR FROM TO_DATE(order_date, 'YYYY-MM-DD')) AS order_year,
        EXTRACT(MONTH FROM TO_DATE(order_date, 'YYYY-MM-DD')) AS order_month,
        EXTRACT(DAY FROM TO_DATE(order_date, 'YYYY-MM-DD')) AS order_day
    FROM raw_data
),

-- Calculate total sales amount for each order
aggregated_data AS (
    SELECT
        order_id,
        customer_id,
        order_year,
        order_month,
        order_day,
        SUM(quantity * price) AS total_sales_amount
    FROM extracted_date
    GROUP BY
        order_id,
        customer_id,
        order_year,
        order_month,
        order_day
)

SELECT * FROM aggregated_data;
[0m23:40:00.345801 [debug] [Thread-1  ]: On model.banxware_assignment.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.my_first_dbt_model"} */
create or replace transient table HOME_ASSIGNMENT.PUBLIC.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m23:40:00.346135 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:40:00.346432 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:40:00.681053 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01b6e6d4-0103-075f-0000-0002ef223fd1
[0m23:40:00.681875 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 54 at position 29 unexpected ';'.
[0m23:40:00.682658 [debug] [Thread-2  ]: On model.banxware_assignment.transformed_sales_data: Close
[0m23:40:01.003491 [debug] [Thread-2  ]: Database Error in model transformed_sales_data (models/example/transformed_sales_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 54 at position 29 unexpected ';'.
  compiled Code at target/run/banxware_assignment/models/example/transformed_sales_data.sql
[0m23:40:01.006107 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4169d31a-11d8-4d05-be2c-09de67eee02e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134152820>]}
[0m23:40:01.007189 [error] [Thread-2  ]: 2 of 3 ERROR creating sql view model PUBLIC.transformed_sales_data ............. [[31mERROR[0m in 0.73s]
[0m23:40:01.008146 [debug] [Thread-2  ]: Finished running node model.banxware_assignment.transformed_sales_data
[0m23:40:01.180091 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.833 seconds
[0m23:40:01.216278 [debug] [Thread-1  ]: On model.banxware_assignment.my_first_dbt_model: Close
[0m23:40:01.396265 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4169d31a-11d8-4d05-be2c-09de67eee02e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d88c40>]}
[0m23:40:01.397721 [info ] [Thread-1  ]: 1 of 3 OK created sql table model PUBLIC.my_first_dbt_model .................... [[32mSUCCESS 1[0m in 1.13s]
[0m23:40:01.398916 [debug] [Thread-1  ]: Finished running node model.banxware_assignment.my_first_dbt_model
[0m23:40:01.400332 [debug] [Thread-4  ]: Began running node model.banxware_assignment.my_second_dbt_model
[0m23:40:01.401193 [info ] [Thread-4  ]: 3 of 3 START sql view model PUBLIC.my_second_dbt_model ......................... [RUN]
[0m23:40:01.402021 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.banxware_assignment.my_second_dbt_model'
[0m23:40:01.402610 [debug] [Thread-4  ]: Began compiling node model.banxware_assignment.my_second_dbt_model
[0m23:40:01.407751 [debug] [Thread-4  ]: Writing injected SQL for node "model.banxware_assignment.my_second_dbt_model"
[0m23:40:01.408928 [debug] [Thread-4  ]: Began executing node model.banxware_assignment.my_second_dbt_model
[0m23:40:01.413289 [debug] [Thread-4  ]: Writing runtime sql for node "model.banxware_assignment.my_second_dbt_model"
[0m23:40:01.414799 [debug] [Thread-4  ]: Using snowflake connection "model.banxware_assignment.my_second_dbt_model"
[0m23:40:01.415304 [debug] [Thread-4  ]: On model.banxware_assignment.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.my_second_dbt_model"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from HOME_ASSIGNMENT.PUBLIC.my_first_dbt_model
where id = 1
  );
[0m23:40:01.415771 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:40:02.513330 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.097 seconds
[0m23:40:02.519530 [debug] [Thread-4  ]: On model.banxware_assignment.my_second_dbt_model: Close
[0m23:40:02.612447 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4169d31a-11d8-4d05-be2c-09de67eee02e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134125a60>]}
[0m23:40:02.614495 [info ] [Thread-4  ]: 3 of 3 OK created sql view model PUBLIC.my_second_dbt_model .................... [[32mSUCCESS 1[0m in 1.21s]
[0m23:40:02.615857 [debug] [Thread-4  ]: Finished running node model.banxware_assignment.my_second_dbt_model
[0m23:40:02.618120 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:40:02.618633 [debug] [MainThread]: Connection 'model.banxware_assignment.my_first_dbt_model' was properly closed.
[0m23:40:02.619055 [debug] [MainThread]: Connection 'model.banxware_assignment.transformed_sales_data' was properly closed.
[0m23:40:02.619452 [debug] [MainThread]: Connection 'model.banxware_assignment.my_second_dbt_model' was properly closed.
[0m23:40:02.619999 [info ] [MainThread]: 
[0m23:40:02.620497 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 3.58 seconds (3.58s).
[0m23:40:02.621906 [debug] [MainThread]: Command end result
[0m23:40:02.661644 [info ] [MainThread]: 
[0m23:40:02.662166 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:40:02.662482 [info ] [MainThread]: 
[0m23:40:02.662828 [error] [MainThread]:   Database Error in model transformed_sales_data (models/example/transformed_sales_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 54 at position 29 unexpected ';'.
  compiled Code at target/run/banxware_assignment/models/example/transformed_sales_data.sql
[0m23:40:02.663102 [info ] [MainThread]: 
[0m23:40:02.663366 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:40:02.666322 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.483492, "process_user_time": 4.823569, "process_kernel_time": 0.433148, "process_mem_max_rss": "194985984", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:40:02.668320 [debug] [MainThread]: Command `dbt run` failed at 23:40:02.668210 after 5.49 seconds
[0m23:40:02.668698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f924f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106abff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132d17340>]}
[0m23:40:02.669039 [debug] [MainThread]: Flushing usage events
[0m23:43:38.263227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107129400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092342b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109234e50>]}


============================== 23:43:38.267428 | 5e6d009d-8f6d-40f3-906f-f37ce20d4358 ==============================
[0m23:43:38.267428 [info ] [MainThread]: Running with dbt=1.8.6
[0m23:43:38.267948 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/neerajchauhan/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:43:39.441492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e6d009d-8f6d-40f3-906f-f37ce20d4358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073626a0>]}
[0m23:43:39.501765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e6d009d-8f6d-40f3-906f-f37ce20d4358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ed5eb0>]}
[0m23:43:39.503244 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:43:39.520317 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m23:43:39.658404 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:43:39.659000 [debug] [MainThread]: Partial parsing: updated file: banxware_assignment://models/example/transformed_sales_data.sql
[0m23:43:39.955898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e6d009d-8f6d-40f3-906f-f37ce20d4358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c46df10>]}
[0m23:43:40.054421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e6d009d-8f6d-40f3-906f-f37ce20d4358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c47d760>]}
[0m23:43:40.054929 [info ] [MainThread]: Found 3 models, 2 seeds, 4 data tests, 448 macros
[0m23:43:40.055235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e6d009d-8f6d-40f3-906f-f37ce20d4358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c48c160>]}
[0m23:43:40.056413 [info ] [MainThread]: 
[0m23:43:40.056870 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:43:40.060772 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOME_ASSIGNMENT'
[0m23:43:40.072836 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT"
[0m23:43:40.073153 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT"} */
show terse schemas in database HOME_ASSIGNMENT
    limit 10000
[0m23:43:40.073406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:40.456691 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.383 seconds
[0m23:43:40.461890 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: Close
[0m23:43:40.555426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT, now list_HOME_ASSIGNMENT_PUBLIC)
[0m23:43:40.571477 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT_PUBLIC"
[0m23:43:40.571993 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT_PUBLIC"} */
show objects in HOME_ASSIGNMENT.PUBLIC limit 10000
[0m23:43:40.572377 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:43:40.963280 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.391 seconds
[0m23:43:40.967402 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: Close
[0m23:43:41.054061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e6d009d-8f6d-40f3-906f-f37ce20d4358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c4ad0a0>]}
[0m23:43:41.055769 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:43:41.056756 [info ] [MainThread]: 
[0m23:43:41.060467 [debug] [Thread-1  ]: Began running node model.banxware_assignment.my_first_dbt_model
[0m23:43:41.061161 [debug] [Thread-2  ]: Began running node model.banxware_assignment.transformed_sales_data
[0m23:43:41.062029 [info ] [Thread-1  ]: 1 of 3 START sql table model PUBLIC.my_first_dbt_model ......................... [RUN]
[0m23:43:41.062953 [info ] [Thread-2  ]: 2 of 3 START sql view model PUBLIC.transformed_sales_data ...................... [RUN]
[0m23:43:41.063850 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT_PUBLIC, now model.banxware_assignment.my_first_dbt_model)
[0m23:43:41.066468 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.banxware_assignment.transformed_sales_data'
[0m23:43:41.067043 [debug] [Thread-1  ]: Began compiling node model.banxware_assignment.my_first_dbt_model
[0m23:43:41.067523 [debug] [Thread-2  ]: Began compiling node model.banxware_assignment.transformed_sales_data
[0m23:43:41.078952 [debug] [Thread-1  ]: Writing injected SQL for node "model.banxware_assignment.my_first_dbt_model"
[0m23:43:41.082430 [debug] [Thread-2  ]: Writing injected SQL for node "model.banxware_assignment.transformed_sales_data"
[0m23:43:41.086088 [debug] [Thread-2  ]: Began executing node model.banxware_assignment.transformed_sales_data
[0m23:43:41.086533 [debug] [Thread-1  ]: Began executing node model.banxware_assignment.my_first_dbt_model
[0m23:43:41.132393 [debug] [Thread-2  ]: Writing runtime sql for node "model.banxware_assignment.transformed_sales_data"
[0m23:43:41.137381 [debug] [Thread-1  ]: Writing runtime sql for node "model.banxware_assignment.my_first_dbt_model"
[0m23:43:41.138592 [debug] [Thread-1  ]: Using snowflake connection "model.banxware_assignment.my_first_dbt_model"
[0m23:43:41.139528 [debug] [Thread-2  ]: Using snowflake connection "model.banxware_assignment.transformed_sales_data"
[0m23:43:41.139867 [debug] [Thread-1  ]: On model.banxware_assignment.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.my_first_dbt_model"} */
create or replace transient table HOME_ASSIGNMENT.PUBLIC.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m23:43:41.140285 [debug] [Thread-2  ]: On model.banxware_assignment.transformed_sales_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.transformed_sales_data"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.transformed_sales_data
  
   as (
    -- models/transformed_sales_data.sql

WITH raw_data AS (
    SELECT
        ORDER_ID AS order_id,
        ORDER_DATE AS order_date,
        CUSTOMER_ID AS customer_id,
        PRODUCT_ID AS product_id,
        PRODUCT_NAME AS product_name,
        QUANTITY AS quantity,
        PRICE AS price,
        ORDER_STATUS AS order_status
    FROM HOME_ASSIGNMENT.PUBLIC.raw_sales_data
),

-- -- Extract year, month, and day from order_date
-- extracted_date AS (
--     SELECT
--         order_id,
--         order_date,
--         customer_id,
--         product_id,
--         product_name,
--         quantity,
--         price,
--         order_status,
--         EXTRACT(YEAR FROM TO_DATE(order_date, 'YYYY-MM-DD')) AS order_year,
--         EXTRACT(MONTH FROM TO_DATE(order_date, 'YYYY-MM-DD')) AS order_month,
--         EXTRACT(DAY FROM TO_DATE(order_date, 'YYYY-MM-DD')) AS order_day
--     FROM raw_data
-- ),

-- -- Calculate total sales amount for each order
-- aggregated_data AS (
--     SELECT
--         order_id,
--         customer_id,
--         order_year,
--         order_month,
--         order_day,
--         SUM(quantity * price) AS total_sales_amount
--     FROM extracted_date
--     GROUP BY
--         order_id,
--         customer_id,
--         order_year,
--         order_month,
--         order_day
-- )

SELECT * FROM raw_data;
[0m23:43:41.140685 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:43:41.140979 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:43:41.499062 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01b6e6d7-0103-075d-0000-0002ef2289a9
[0m23:43:41.499887 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 54 at position 0 unexpected 'SELECT'.
[0m23:43:41.500638 [debug] [Thread-2  ]: On model.banxware_assignment.transformed_sales_data: Close
[0m23:43:41.595176 [debug] [Thread-2  ]: Database Error in model transformed_sales_data (models/example/transformed_sales_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 54 at position 0 unexpected 'SELECT'.
  compiled Code at target/run/banxware_assignment/models/example/transformed_sales_data.sql
[0m23:43:41.598081 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e6d009d-8f6d-40f3-906f-f37ce20d4358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c7f1bb0>]}
[0m23:43:41.599126 [error] [Thread-2  ]: 2 of 3 ERROR creating sql view model PUBLIC.transformed_sales_data ............. [[31mERROR[0m in 0.53s]
[0m23:43:41.600054 [debug] [Thread-2  ]: Finished running node model.banxware_assignment.transformed_sales_data
[0m23:43:42.064969 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.924 seconds
[0m23:43:42.097903 [debug] [Thread-1  ]: On model.banxware_assignment.my_first_dbt_model: Close
[0m23:43:42.182923 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e6d009d-8f6d-40f3-906f-f37ce20d4358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091c7640>]}
[0m23:43:42.184033 [info ] [Thread-1  ]: 1 of 3 OK created sql table model PUBLIC.my_first_dbt_model .................... [[32mSUCCESS 1[0m in 1.12s]
[0m23:43:42.184958 [debug] [Thread-1  ]: Finished running node model.banxware_assignment.my_first_dbt_model
[0m23:43:42.186137 [debug] [Thread-4  ]: Began running node model.banxware_assignment.my_second_dbt_model
[0m23:43:42.186982 [info ] [Thread-4  ]: 3 of 3 START sql view model PUBLIC.my_second_dbt_model ......................... [RUN]
[0m23:43:42.187817 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.banxware_assignment.my_second_dbt_model'
[0m23:43:42.188399 [debug] [Thread-4  ]: Began compiling node model.banxware_assignment.my_second_dbt_model
[0m23:43:42.193149 [debug] [Thread-4  ]: Writing injected SQL for node "model.banxware_assignment.my_second_dbt_model"
[0m23:43:42.194175 [debug] [Thread-4  ]: Began executing node model.banxware_assignment.my_second_dbt_model
[0m23:43:42.198461 [debug] [Thread-4  ]: Writing runtime sql for node "model.banxware_assignment.my_second_dbt_model"
[0m23:43:42.199628 [debug] [Thread-4  ]: Using snowflake connection "model.banxware_assignment.my_second_dbt_model"
[0m23:43:42.200151 [debug] [Thread-4  ]: On model.banxware_assignment.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.my_second_dbt_model"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from HOME_ASSIGNMENT.PUBLIC.my_first_dbt_model
where id = 1
  );
[0m23:43:42.200610 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:43:42.777530 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.577 seconds
[0m23:43:42.781762 [debug] [Thread-4  ]: On model.banxware_assignment.my_second_dbt_model: Close
[0m23:43:42.858885 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e6d009d-8f6d-40f3-906f-f37ce20d4358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c675d90>]}
[0m23:43:42.860634 [info ] [Thread-4  ]: 3 of 3 OK created sql view model PUBLIC.my_second_dbt_model .................... [[32mSUCCESS 1[0m in 0.67s]
[0m23:43:42.861916 [debug] [Thread-4  ]: Finished running node model.banxware_assignment.my_second_dbt_model
[0m23:43:42.863669 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:43:42.864154 [debug] [MainThread]: Connection 'model.banxware_assignment.my_first_dbt_model' was properly closed.
[0m23:43:42.864571 [debug] [MainThread]: Connection 'model.banxware_assignment.transformed_sales_data' was properly closed.
[0m23:43:42.864960 [debug] [MainThread]: Connection 'model.banxware_assignment.my_second_dbt_model' was properly closed.
[0m23:43:42.865506 [info ] [MainThread]: 
[0m23:43:42.866017 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 2.81 seconds (2.81s).
[0m23:43:42.867392 [debug] [MainThread]: Command end result
[0m23:43:42.910358 [info ] [MainThread]: 
[0m23:43:42.911091 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:43:42.911666 [info ] [MainThread]: 
[0m23:43:42.912107 [error] [MainThread]:   Database Error in model transformed_sales_data (models/example/transformed_sales_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 54 at position 0 unexpected 'SELECT'.
  compiled Code at target/run/banxware_assignment/models/example/transformed_sales_data.sql
[0m23:43:42.912872 [info ] [MainThread]: 
[0m23:43:42.913232 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:43:42.916593 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.721621, "process_user_time": 4.794486, "process_kernel_time": 0.436132, "process_mem_max_rss": "194953216", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:43:42.917383 [debug] [MainThread]: Command `dbt run` failed at 23:43:42.917293 after 4.72 seconds
[0m23:43:42.917745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107129400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c0604f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bf706d0>]}
[0m23:43:42.918080 [debug] [MainThread]: Flushing usage events
[0m23:43:55.852754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107045550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109178d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091781c0>]}


============================== 23:43:55.857183 | d69e4b16-096e-4a50-be0c-2b684bf1c680 ==============================
[0m23:43:55.857183 [info ] [MainThread]: Running with dbt=1.8.6
[0m23:43:55.857752 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs', 'profiles_dir': '/Users/neerajchauhan/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:43:56.930564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd69e4b16-096e-4a50-be0c-2b684bf1c680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072b36a0>]}
[0m23:43:56.991359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd69e4b16-096e-4a50-be0c-2b684bf1c680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121cf3520>]}
[0m23:43:56.992549 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:43:57.009507 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m23:43:57.144981 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:43:57.145375 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:43:57.240270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd69e4b16-096e-4a50-be0c-2b684bf1c680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121dab0a0>]}
[0m23:43:57.342504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd69e4b16-096e-4a50-be0c-2b684bf1c680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1250922b0>]}
[0m23:43:57.343010 [info ] [MainThread]: Found 3 models, 2 seeds, 4 data tests, 448 macros
[0m23:43:57.343320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd69e4b16-096e-4a50-be0c-2b684bf1c680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121e27670>]}
[0m23:43:57.344590 [info ] [MainThread]: 
[0m23:43:57.345070 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:43:57.348874 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOME_ASSIGNMENT'
[0m23:43:57.362212 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT"
[0m23:43:57.362527 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT"} */
show terse schemas in database HOME_ASSIGNMENT
    limit 10000
[0m23:43:57.362786 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:57.937194 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.574 seconds
[0m23:43:57.940778 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: Close
[0m23:43:58.030865 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT, now list_HOME_ASSIGNMENT_PUBLIC)
[0m23:43:58.046965 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT_PUBLIC"
[0m23:43:58.047473 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT_PUBLIC"} */
show objects in HOME_ASSIGNMENT.PUBLIC limit 10000
[0m23:43:58.047867 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:43:58.464020 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.416 seconds
[0m23:43:58.469465 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: Close
[0m23:43:58.557370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd69e4b16-096e-4a50-be0c-2b684bf1c680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ec1910>]}
[0m23:43:58.558609 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:43:58.559278 [info ] [MainThread]: 
[0m23:43:58.563398 [debug] [Thread-1  ]: Began running node seed.banxware_assignment.customers
[0m23:43:58.564091 [debug] [Thread-2  ]: Began running node seed.banxware_assignment.sales
[0m23:43:58.564942 [info ] [Thread-1  ]: 1 of 2 START seed file PUBLIC.raw_customer_data ................................ [RUN]
[0m23:43:58.565737 [info ] [Thread-2  ]: 2 of 2 START seed file PUBLIC.raw_sales_data ................................... [RUN]
[0m23:43:58.566460 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT_PUBLIC, now seed.banxware_assignment.customers)
[0m23:43:58.567603 [debug] [Thread-2  ]: Acquiring new snowflake connection 'seed.banxware_assignment.sales'
[0m23:43:58.568175 [debug] [Thread-1  ]: Began compiling node seed.banxware_assignment.customers
[0m23:43:58.568695 [debug] [Thread-2  ]: Began compiling node seed.banxware_assignment.sales
[0m23:43:58.569225 [debug] [Thread-1  ]: Began executing node seed.banxware_assignment.customers
[0m23:43:58.569653 [debug] [Thread-2  ]: Began executing node seed.banxware_assignment.sales
[0m23:43:58.632944 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:43:58.633985 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:43:58.634312 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
BEGIN
[0m23:43:58.634646 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
BEGIN
[0m23:43:58.634939 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:43:58.635216 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:43:58.943174 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.307 seconds
[0m23:43:58.944654 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:43:58.945259 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
truncate table "HOME_ASSIGNMENT"."PUBLIC"."RAW_SALES_DATA"
  ;
[0m23:43:58.973188 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.338 seconds
[0m23:43:58.974267 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:43:58.974853 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
truncate table "HOME_ASSIGNMENT"."PUBLIC"."RAW_CUSTOMER_DATA"
  ;
[0m23:43:59.161513 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.215 seconds
[0m23:43:59.163471 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:43:59.164295 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
COMMIT
[0m23:43:59.207345 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.231 seconds
[0m23:43:59.209392 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:43:59.210578 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
COMMIT
[0m23:43:59.407678 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.196 seconds
[0m23:43:59.434036 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:43:59.434665 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
BEGIN
[0m23:43:59.882709 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.447 seconds
[0m23:43:59.886801 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:43:59.887768 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
insert into HOME_ASSIGNMENT.PUBLIC.raw_customer_data (id, name) values
            (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%...
[0m23:43:59.976798 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.812 seconds
[0m23:43:59.987201 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:43:59.987955 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
BEGIN
[0m23:44:00.063823 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.075 seconds
[0m23:44:00.073145 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:44:00.073905 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
insert into HOME_ASSIGNMENT.PUBLIC.raw_sales_data (order_id, order_date, customer_id, product_id, product_name, quantity, price, order_status) values
            (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%...
[0m23:44:00.498097 [debug] [Thread-2  ]: SQL status: SUCCESS 100 in 0.423 seconds
[0m23:44:00.500378 [debug] [Thread-1  ]: SQL status: SUCCESS 60 in 0.612 seconds
[0m23:44:00.501337 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:44:00.502044 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:44:00.502610 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
COMMIT
[0m23:44:00.503155 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
COMMIT
[0m23:44:00.698574 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.194 seconds
[0m23:44:00.711466 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.banxware_assignment.customers"
[0m23:44:00.713363 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.210 seconds
[0m23:44:00.714533 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.banxware_assignment.sales"
[0m23:44:00.745334 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: Close
[0m23:44:00.748009 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: Close
[0m23:44:00.826417 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd69e4b16-096e-4a50-be0c-2b684bf1c680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125386df0>]}
[0m23:44:00.827201 [info ] [Thread-1  ]: 1 of 2 OK loaded seed file PUBLIC.raw_customer_data ............................ [[32mINSERT 60[0m in 2.26s]
[0m23:44:00.827951 [debug] [Thread-1  ]: Finished running node seed.banxware_assignment.customers
[0m23:44:00.977979 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd69e4b16-096e-4a50-be0c-2b684bf1c680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125386d00>]}
[0m23:44:00.979363 [info ] [Thread-2  ]: 2 of 2 OK loaded seed file PUBLIC.raw_sales_data ............................... [[32mINSERT 100[0m in 2.41s]
[0m23:44:00.980525 [debug] [Thread-2  ]: Finished running node seed.banxware_assignment.sales
[0m23:44:00.982473 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:44:00.982935 [debug] [MainThread]: Connection 'seed.banxware_assignment.customers' was properly closed.
[0m23:44:00.983337 [debug] [MainThread]: Connection 'seed.banxware_assignment.sales' was properly closed.
[0m23:44:00.983828 [info ] [MainThread]: 
[0m23:44:00.984337 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 3.64 seconds (3.64s).
[0m23:44:00.985576 [debug] [MainThread]: Command end result
[0m23:44:01.027026 [info ] [MainThread]: 
[0m23:44:01.027484 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:44:01.027755 [info ] [MainThread]: 
[0m23:44:01.028029 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:44:01.030460 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 5.248272, "process_user_time": 4.632725, "process_kernel_time": 0.389064, "process_mem_max_rss": "192299008", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:44:01.030865 [debug] [MainThread]: Command `dbt seed` succeeded at 23:44:01.030793 after 5.25 seconds
[0m23:44:01.031173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107045550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125489e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121da00a0>]}
[0m23:44:01.031481 [debug] [MainThread]: Flushing usage events
[0m23:44:48.313611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e75550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fb8280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fb8e50>]}


============================== 23:44:48.317928 | f07e1f15-62e5-4b3e-a0e8-1fe03f95c752 ==============================
[0m23:44:48.317928 [info ] [MainThread]: Running with dbt=1.8.6
[0m23:44:48.318423 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/neerajchauhan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:44:49.503249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f07e1f15-62e5-4b3e-a0e8-1fe03f95c752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e36a0>]}
[0m23:44:49.563680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f07e1f15-62e5-4b3e-a0e8-1fe03f95c752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b4f3520>]}
[0m23:44:49.565256 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:44:49.583107 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m23:44:49.721384 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:44:49.721773 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:44:49.816548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f07e1f15-62e5-4b3e-a0e8-1fe03f95c752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b5a90a0>]}
[0m23:44:49.914699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f07e1f15-62e5-4b3e-a0e8-1fe03f95c752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b4f3640>]}
[0m23:44:49.915207 [info ] [MainThread]: Found 3 models, 2 seeds, 4 data tests, 448 macros
[0m23:44:49.915510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f07e1f15-62e5-4b3e-a0e8-1fe03f95c752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a83c160>]}
[0m23:44:49.916802 [info ] [MainThread]: 
[0m23:44:49.917254 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:44:49.921194 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOME_ASSIGNMENT'
[0m23:44:49.934436 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT"
[0m23:44:49.934748 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT"} */
show terse schemas in database HOME_ASSIGNMENT
    limit 10000
[0m23:44:49.935001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:44:50.300731 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.366 seconds
[0m23:44:50.303888 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: Close
[0m23:44:50.397914 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT, now list_HOME_ASSIGNMENT_PUBLIC)
[0m23:44:50.413622 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT_PUBLIC"
[0m23:44:50.414154 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT_PUBLIC"} */
show objects in HOME_ASSIGNMENT.PUBLIC limit 10000
[0m23:44:50.414549 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:44:50.779325 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.364 seconds
[0m23:44:50.786185 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: Close
[0m23:44:50.880050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f07e1f15-62e5-4b3e-a0e8-1fe03f95c752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10513f0d0>]}
[0m23:44:50.881574 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:44:50.882214 [info ] [MainThread]: 
[0m23:44:50.886393 [debug] [Thread-1  ]: Began running node model.banxware_assignment.my_first_dbt_model
[0m23:44:50.887087 [debug] [Thread-2  ]: Began running node model.banxware_assignment.transformed_sales_data
[0m23:44:50.887901 [info ] [Thread-1  ]: 1 of 3 START sql table model PUBLIC.my_first_dbt_model ......................... [RUN]
[0m23:44:50.888673 [info ] [Thread-2  ]: 2 of 3 START sql view model PUBLIC.transformed_sales_data ...................... [RUN]
[0m23:44:50.889373 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT_PUBLIC, now model.banxware_assignment.my_first_dbt_model)
[0m23:44:50.890545 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.banxware_assignment.transformed_sales_data'
[0m23:44:50.891117 [debug] [Thread-1  ]: Began compiling node model.banxware_assignment.my_first_dbt_model
[0m23:44:50.891662 [debug] [Thread-2  ]: Began compiling node model.banxware_assignment.transformed_sales_data
[0m23:44:50.903592 [debug] [Thread-1  ]: Writing injected SQL for node "model.banxware_assignment.my_first_dbt_model"
[0m23:44:50.907029 [debug] [Thread-2  ]: Writing injected SQL for node "model.banxware_assignment.transformed_sales_data"
[0m23:44:50.908704 [debug] [Thread-2  ]: Began executing node model.banxware_assignment.transformed_sales_data
[0m23:44:50.909126 [debug] [Thread-1  ]: Began executing node model.banxware_assignment.my_first_dbt_model
[0m23:44:50.955117 [debug] [Thread-2  ]: Writing runtime sql for node "model.banxware_assignment.transformed_sales_data"
[0m23:44:50.955654 [debug] [Thread-1  ]: Writing runtime sql for node "model.banxware_assignment.my_first_dbt_model"
[0m23:44:50.956991 [debug] [Thread-2  ]: Using snowflake connection "model.banxware_assignment.transformed_sales_data"
[0m23:44:50.957706 [debug] [Thread-1  ]: Using snowflake connection "model.banxware_assignment.my_first_dbt_model"
[0m23:44:50.958102 [debug] [Thread-2  ]: On model.banxware_assignment.transformed_sales_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.transformed_sales_data"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.transformed_sales_data
  
   as (
    -- models/transformed_sales_data.sql

WITH raw_data AS (
    SELECT
        ORDER_ID AS order_id,
        ORDER_DATE AS order_date,
        CUSTOMER_ID AS customer_id,
        PRODUCT_ID AS product_id,
        PRODUCT_NAME AS product_name,
        QUANTITY AS quantity,
        PRICE AS price,
        ORDER_STATUS AS order_status
    FROM HOME_ASSIGNMENT.PUBLIC.raw_sales_data
),

-- -- Extract year, month, and day from order_date
-- extracted_date AS (
--     SELECT
--         order_id,
--         order_date,
--         customer_id,
--         product_id,
--         product_name,
--         quantity,
--         price,
--         order_status,
--         EXTRACT(YEAR FROM TO_DATE(order_date, 'YYYY-MM-DD')) AS order_year,
--         EXTRACT(MONTH FROM TO_DATE(order_date, 'YYYY-MM-DD')) AS order_month,
--         EXTRACT(DAY FROM TO_DATE(order_date, 'YYYY-MM-DD')) AS order_day
--     FROM raw_data
-- ),

-- -- Calculate total sales amount for each order
-- aggregated_data AS (
--     SELECT
--         order_id,
--         customer_id,
--         order_year,
--         order_month,
--         order_day,
--         SUM(quantity * price) AS total_sales_amount
--     FROM extracted_date
--     GROUP BY
--         order_id,
--         customer_id,
--         order_year,
--         order_month,
--         order_day
-- )

SELECT * FROM raw_data;
[0m23:44:50.958522 [debug] [Thread-1  ]: On model.banxware_assignment.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.my_first_dbt_model"} */
create or replace transient table HOME_ASSIGNMENT.PUBLIC.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m23:44:50.958855 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:44:50.959155 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:44:51.233482 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01b6e6d8-0103-075e-0000-0002ef22e029
[0m23:44:51.234147 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 54 at position 0 unexpected 'SELECT'.
[0m23:44:51.234780 [debug] [Thread-2  ]: On model.banxware_assignment.transformed_sales_data: Close
[0m23:44:51.313913 [debug] [Thread-2  ]: Database Error in model transformed_sales_data (models/example/transformed_sales_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 54 at position 0 unexpected 'SELECT'.
  compiled Code at target/run/banxware_assignment/models/example/transformed_sales_data.sql
[0m23:44:51.316588 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07e1f15-62e5-4b3e-a0e8-1fe03f95c752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ac7d8b0>]}
[0m23:44:51.317670 [error] [Thread-2  ]: 2 of 3 ERROR creating sql view model PUBLIC.transformed_sales_data ............. [[31mERROR[0m in 0.42s]
[0m23:44:51.318614 [debug] [Thread-2  ]: Finished running node model.banxware_assignment.transformed_sales_data
[0m23:44:51.798481 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.839 seconds
[0m23:44:51.832752 [debug] [Thread-1  ]: On model.banxware_assignment.my_first_dbt_model: Close
[0m23:44:51.915434 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07e1f15-62e5-4b3e-a0e8-1fe03f95c752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f5fdc0>]}
[0m23:44:51.916503 [info ] [Thread-1  ]: 1 of 3 OK created sql table model PUBLIC.my_first_dbt_model .................... [[32mSUCCESS 1[0m in 1.03s]
[0m23:44:51.917440 [debug] [Thread-1  ]: Finished running node model.banxware_assignment.my_first_dbt_model
[0m23:44:51.918670 [debug] [Thread-4  ]: Began running node model.banxware_assignment.my_second_dbt_model
[0m23:44:51.919562 [info ] [Thread-4  ]: 3 of 3 START sql view model PUBLIC.my_second_dbt_model ......................... [RUN]
[0m23:44:51.920439 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.banxware_assignment.my_second_dbt_model'
[0m23:44:51.921017 [debug] [Thread-4  ]: Began compiling node model.banxware_assignment.my_second_dbt_model
[0m23:44:51.925390 [debug] [Thread-4  ]: Writing injected SQL for node "model.banxware_assignment.my_second_dbt_model"
[0m23:44:51.927765 [debug] [Thread-4  ]: Began executing node model.banxware_assignment.my_second_dbt_model
[0m23:44:51.932237 [debug] [Thread-4  ]: Writing runtime sql for node "model.banxware_assignment.my_second_dbt_model"
[0m23:44:51.933435 [debug] [Thread-4  ]: Using snowflake connection "model.banxware_assignment.my_second_dbt_model"
[0m23:44:51.933874 [debug] [Thread-4  ]: On model.banxware_assignment.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.my_second_dbt_model"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from HOME_ASSIGNMENT.PUBLIC.my_first_dbt_model
where id = 1
  );
[0m23:44:51.934264 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:44:52.517688 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.583 seconds
[0m23:44:52.524161 [debug] [Thread-4  ]: On model.banxware_assignment.my_second_dbt_model: Close
[0m23:44:52.616772 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07e1f15-62e5-4b3e-a0e8-1fe03f95c752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ac36400>]}
[0m23:44:52.618821 [info ] [Thread-4  ]: 3 of 3 OK created sql view model PUBLIC.my_second_dbt_model .................... [[32mSUCCESS 1[0m in 0.70s]
[0m23:44:52.619830 [debug] [Thread-4  ]: Finished running node model.banxware_assignment.my_second_dbt_model
[0m23:44:52.622492 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:44:52.623074 [debug] [MainThread]: Connection 'model.banxware_assignment.my_first_dbt_model' was properly closed.
[0m23:44:52.623501 [debug] [MainThread]: Connection 'model.banxware_assignment.transformed_sales_data' was properly closed.
[0m23:44:52.623895 [debug] [MainThread]: Connection 'model.banxware_assignment.my_second_dbt_model' was properly closed.
[0m23:44:52.624484 [info ] [MainThread]: 
[0m23:44:52.625023 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 2.71 seconds (2.71s).
[0m23:44:52.626517 [debug] [MainThread]: Command end result
[0m23:44:52.666321 [info ] [MainThread]: 
[0m23:44:52.666781 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:44:52.667054 [info ] [MainThread]: 
[0m23:44:52.667390 [error] [MainThread]:   Database Error in model transformed_sales_data (models/example/transformed_sales_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 54 at position 0 unexpected 'SELECT'.
  compiled Code at target/run/banxware_assignment/models/example/transformed_sales_data.sql
[0m23:44:52.667654 [info ] [MainThread]: 
[0m23:44:52.667915 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:44:52.670390 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.4251943, "process_user_time": 4.557024, "process_kernel_time": 0.418902, "process_mem_max_rss": "190185472", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:44:52.670802 [debug] [MainThread]: Command `dbt run` failed at 23:44:52.670728 after 4.43 seconds
[0m23:44:52.671134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e75550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10699ee80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b4f3640>]}
[0m23:44:52.671438 [debug] [MainThread]: Flushing usage events
[0m23:45:35.172883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ccd400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dd82b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dd8e50>]}


============================== 23:45:35.177262 | e4b1380a-27a8-4278-9b73-26c8009412ef ==============================
[0m23:45:35.177262 [info ] [MainThread]: Running with dbt=1.8.6
[0m23:45:35.177790 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/neerajchauhan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:45:36.375251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4b1380a-27a8-4278-9b73-26c8009412ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f066a0>]}
[0m23:45:36.436006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4b1380a-27a8-4278-9b73-26c8009412ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a79eb0>]}
[0m23:45:36.437504 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:45:36.454739 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m23:45:36.592994 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:45:36.593579 [debug] [MainThread]: Partial parsing: updated file: banxware_assignment://models/example/transformed_sales_data.sql
[0m23:45:36.891484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4b1380a-27a8-4278-9b73-26c8009412ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bd2df10>]}
[0m23:45:36.990048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4b1380a-27a8-4278-9b73-26c8009412ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bd3e760>]}
[0m23:45:36.990558 [info ] [MainThread]: Found 3 models, 2 seeds, 4 data tests, 448 macros
[0m23:45:36.990861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4b1380a-27a8-4278-9b73-26c8009412ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bd4e160>]}
[0m23:45:36.992072 [info ] [MainThread]: 
[0m23:45:36.992529 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:45:36.996479 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOME_ASSIGNMENT'
[0m23:45:37.008463 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT"
[0m23:45:37.008784 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT"} */
show terse schemas in database HOME_ASSIGNMENT
    limit 10000
[0m23:45:37.009048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:37.483078 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.474 seconds
[0m23:45:37.487167 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: Close
[0m23:45:37.573210 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT, now list_HOME_ASSIGNMENT_PUBLIC)
[0m23:45:37.589658 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT_PUBLIC"
[0m23:45:37.590232 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT_PUBLIC"} */
show objects in HOME_ASSIGNMENT.PUBLIC limit 10000
[0m23:45:37.590646 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:45:38.191286 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.600 seconds
[0m23:45:38.197018 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: Close
[0m23:45:38.272551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4b1380a-27a8-4278-9b73-26c8009412ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bd6c0a0>]}
[0m23:45:38.273488 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:45:38.274016 [info ] [MainThread]: 
[0m23:45:38.278058 [debug] [Thread-1  ]: Began running node model.banxware_assignment.my_first_dbt_model
[0m23:45:38.278748 [debug] [Thread-2  ]: Began running node model.banxware_assignment.transformed_sales_data
[0m23:45:38.279632 [info ] [Thread-1  ]: 1 of 3 START sql table model PUBLIC.my_first_dbt_model ......................... [RUN]
[0m23:45:38.280468 [info ] [Thread-2  ]: 2 of 3 START sql view model PUBLIC.transformed_sales_data ...................... [RUN]
[0m23:45:38.281177 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT_PUBLIC, now model.banxware_assignment.my_first_dbt_model)
[0m23:45:38.283785 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.banxware_assignment.transformed_sales_data'
[0m23:45:38.284305 [debug] [Thread-1  ]: Began compiling node model.banxware_assignment.my_first_dbt_model
[0m23:45:38.284758 [debug] [Thread-2  ]: Began compiling node model.banxware_assignment.transformed_sales_data
[0m23:45:38.296152 [debug] [Thread-1  ]: Writing injected SQL for node "model.banxware_assignment.my_first_dbt_model"
[0m23:45:38.299710 [debug] [Thread-2  ]: Writing injected SQL for node "model.banxware_assignment.transformed_sales_data"
[0m23:45:38.301080 [debug] [Thread-1  ]: Began executing node model.banxware_assignment.my_first_dbt_model
[0m23:45:38.301505 [debug] [Thread-2  ]: Began executing node model.banxware_assignment.transformed_sales_data
[0m23:45:38.348457 [debug] [Thread-1  ]: Writing runtime sql for node "model.banxware_assignment.my_first_dbt_model"
[0m23:45:38.349937 [debug] [Thread-2  ]: Writing runtime sql for node "model.banxware_assignment.transformed_sales_data"
[0m23:45:38.351290 [debug] [Thread-2  ]: Using snowflake connection "model.banxware_assignment.transformed_sales_data"
[0m23:45:38.352011 [debug] [Thread-1  ]: Using snowflake connection "model.banxware_assignment.my_first_dbt_model"
[0m23:45:38.352391 [debug] [Thread-2  ]: On model.banxware_assignment.transformed_sales_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.transformed_sales_data"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.transformed_sales_data
  
   as (
    -- models/transformed_sales_data.sql

WITH raw_data AS (
    SELECT
        ORDER_ID AS order_id,
        ORDER_DATE AS order_date,
        CUSTOMER_ID AS customer_id,
        PRODUCT_ID AS product_id,
        PRODUCT_NAME AS product_name,
        QUANTITY AS quantity,
        PRICE AS price,
        ORDER_STATUS AS order_status
    FROM HOME_ASSIGNMENT.PUBLIC.raw_sales_data
)

-- -- Extract year, month, and day from order_date
-- extracted_date AS (
--     SELECT
--         order_id,
--         order_date,
--         customer_id,
--         product_id,
--         product_name,
--         quantity,
--         price,
--         order_status,
--         EXTRACT(YEAR FROM TO_DATE(order_date, 'YYYY-MM-DD')) AS order_year,
--         EXTRACT(MONTH FROM TO_DATE(order_date, 'YYYY-MM-DD')) AS order_month,
--         EXTRACT(DAY FROM TO_DATE(order_date, 'YYYY-MM-DD')) AS order_day
--     FROM raw_data
-- ),

-- -- Calculate total sales amount for each order
-- aggregated_data AS (
--     SELECT
--         order_id,
--         customer_id,
--         order_year,
--         order_month,
--         order_day,
--         SUM(quantity * price) AS total_sales_amount
--     FROM extracted_date
--     GROUP BY
--         order_id,
--         customer_id,
--         order_year,
--         order_month,
--         order_day
-- )

SELECT * FROM raw_data;
[0m23:45:38.352794 [debug] [Thread-1  ]: On model.banxware_assignment.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.my_first_dbt_model"} */
create or replace transient table HOME_ASSIGNMENT.PUBLIC.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m23:45:38.353127 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:45:38.353426 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:45:38.658748 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01b6e6d9-0103-075f-0000-0002ef22d035
[0m23:45:38.659583 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 54 at position 22 unexpected ';'.
[0m23:45:38.660350 [debug] [Thread-2  ]: On model.banxware_assignment.transformed_sales_data: Close
[0m23:45:38.743894 [debug] [Thread-2  ]: Database Error in model transformed_sales_data (models/example/transformed_sales_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 54 at position 22 unexpected ';'.
  compiled Code at target/run/banxware_assignment/models/example/transformed_sales_data.sql
[0m23:45:38.746703 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4b1380a-27a8-4278-9b73-26c8009412ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c892a00>]}
[0m23:45:38.747820 [error] [Thread-2  ]: 2 of 3 ERROR creating sql view model PUBLIC.transformed_sales_data ............. [[31mERROR[0m in 0.46s]
[0m23:45:38.748802 [debug] [Thread-2  ]: Finished running node model.banxware_assignment.transformed_sales_data
[0m23:45:39.217983 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.864 seconds
[0m23:45:39.254613 [debug] [Thread-1  ]: On model.banxware_assignment.my_first_dbt_model: Close
[0m23:45:39.335770 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4b1380a-27a8-4278-9b73-26c8009412ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d6c8e0>]}
[0m23:45:39.336881 [info ] [Thread-1  ]: 1 of 3 OK created sql table model PUBLIC.my_first_dbt_model .................... [[32mSUCCESS 1[0m in 1.05s]
[0m23:45:39.337813 [debug] [Thread-1  ]: Finished running node model.banxware_assignment.my_first_dbt_model
[0m23:45:39.338871 [debug] [Thread-4  ]: Began running node model.banxware_assignment.my_second_dbt_model
[0m23:45:39.339694 [info ] [Thread-4  ]: 3 of 3 START sql view model PUBLIC.my_second_dbt_model ......................... [RUN]
[0m23:45:39.340493 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.banxware_assignment.my_second_dbt_model'
[0m23:45:39.341042 [debug] [Thread-4  ]: Began compiling node model.banxware_assignment.my_second_dbt_model
[0m23:45:39.345714 [debug] [Thread-4  ]: Writing injected SQL for node "model.banxware_assignment.my_second_dbt_model"
[0m23:45:39.347686 [debug] [Thread-4  ]: Began executing node model.banxware_assignment.my_second_dbt_model
[0m23:45:39.351950 [debug] [Thread-4  ]: Writing runtime sql for node "model.banxware_assignment.my_second_dbt_model"
[0m23:45:39.353139 [debug] [Thread-4  ]: Using snowflake connection "model.banxware_assignment.my_second_dbt_model"
[0m23:45:39.353618 [debug] [Thread-4  ]: On model.banxware_assignment.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.my_second_dbt_model"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from HOME_ASSIGNMENT.PUBLIC.my_first_dbt_model
where id = 1
  );
[0m23:45:39.354053 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:45:39.776147 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.421 seconds
[0m23:45:39.781613 [debug] [Thread-4  ]: On model.banxware_assignment.my_second_dbt_model: Close
[0m23:45:39.862737 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4b1380a-27a8-4278-9b73-26c8009412ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c840580>]}
[0m23:45:39.864479 [info ] [Thread-4  ]: 3 of 3 OK created sql view model PUBLIC.my_second_dbt_model .................... [[32mSUCCESS 1[0m in 0.52s]
[0m23:45:39.865875 [debug] [Thread-4  ]: Finished running node model.banxware_assignment.my_second_dbt_model
[0m23:45:39.867665 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:45:39.868143 [debug] [MainThread]: Connection 'model.banxware_assignment.my_first_dbt_model' was properly closed.
[0m23:45:39.868551 [debug] [MainThread]: Connection 'model.banxware_assignment.transformed_sales_data' was properly closed.
[0m23:45:39.868957 [debug] [MainThread]: Connection 'model.banxware_assignment.my_second_dbt_model' was properly closed.
[0m23:45:39.869517 [info ] [MainThread]: 
[0m23:45:39.870033 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 2.88 seconds (2.88s).
[0m23:45:39.871415 [debug] [MainThread]: Command end result
[0m23:45:39.911299 [info ] [MainThread]: 
[0m23:45:39.911790 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:45:39.912067 [info ] [MainThread]: 
[0m23:45:39.912406 [error] [MainThread]:   Database Error in model transformed_sales_data (models/example/transformed_sales_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 54 at position 22 unexpected ';'.
  compiled Code at target/run/banxware_assignment/models/example/transformed_sales_data.sql
[0m23:45:39.912669 [info ] [MainThread]: 
[0m23:45:39.912931 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:45:39.915595 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.8117595, "process_user_time": 4.796462, "process_kernel_time": 0.466107, "process_mem_max_rss": "200572928", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:45:39.916076 [debug] [MainThread]: Command `dbt run` failed at 23:45:39.915990 after 4.81 seconds
[0m23:45:39.916427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ccd400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b8306d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b920190>]}
[0m23:45:39.916765 [debug] [MainThread]: Flushing usage events
[0m23:45:53.000257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104abd430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a8c3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a8cd90>]}


============================== 23:45:53.004760 | 1b2471d5-afac-4507-a1f3-07d47a87eca6 ==============================
[0m23:45:53.004760 [info ] [MainThread]: Running with dbt=1.8.6
[0m23:45:53.005311 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/neerajchauhan/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:45:54.070200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b2471d5-afac-4507-a1f3-07d47a87eca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cb96a0>]}
[0m23:45:54.130346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b2471d5-afac-4507-a1f3-07d47a87eca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107380370>]}
[0m23:45:54.131523 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:45:54.148917 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m23:45:54.285513 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:45:54.286134 [debug] [MainThread]: Partial parsing: updated file: banxware_assignment://models/example/transformed_sales_data.sql
[0m23:45:54.582226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b2471d5-afac-4507-a1f3-07d47a87eca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1530c5f40>]}
[0m23:45:54.694364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b2471d5-afac-4507-a1f3-07d47a87eca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1530c1730>]}
[0m23:45:54.694863 [info ] [MainThread]: Found 3 models, 2 seeds, 4 data tests, 448 macros
[0m23:45:54.695169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b2471d5-afac-4507-a1f3-07d47a87eca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153104d30>]}
[0m23:45:54.696359 [info ] [MainThread]: 
[0m23:45:54.696799 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:45:54.700677 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOME_ASSIGNMENT'
[0m23:45:54.712606 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT"
[0m23:45:54.712921 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT"} */
show terse schemas in database HOME_ASSIGNMENT
    limit 10000
[0m23:45:54.713171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:55.077020 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.363 seconds
[0m23:45:55.081025 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: Close
[0m23:45:55.170706 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT, now list_HOME_ASSIGNMENT_PUBLIC)
[0m23:45:55.187082 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT_PUBLIC"
[0m23:45:55.187620 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT_PUBLIC"} */
show objects in HOME_ASSIGNMENT.PUBLIC limit 10000
[0m23:45:55.188009 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:45:55.496148 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.308 seconds
[0m23:45:55.501789 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: Close
[0m23:45:55.607644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b2471d5-afac-4507-a1f3-07d47a87eca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1530911f0>]}
[0m23:45:55.609121 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:45:55.609892 [info ] [MainThread]: 
[0m23:45:55.614264 [debug] [Thread-1  ]: Began running node model.banxware_assignment.my_first_dbt_model
[0m23:45:55.614971 [debug] [Thread-2  ]: Began running node model.banxware_assignment.transformed_sales_data
[0m23:45:55.615807 [info ] [Thread-1  ]: 1 of 3 START sql table model PUBLIC.my_first_dbt_model ......................... [RUN]
[0m23:45:55.616604 [info ] [Thread-2  ]: 2 of 3 START sql view model PUBLIC.transformed_sales_data ...................... [RUN]
[0m23:45:55.617314 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT_PUBLIC, now model.banxware_assignment.my_first_dbt_model)
[0m23:45:55.619881 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.banxware_assignment.transformed_sales_data'
[0m23:45:55.620463 [debug] [Thread-1  ]: Began compiling node model.banxware_assignment.my_first_dbt_model
[0m23:45:55.621003 [debug] [Thread-2  ]: Began compiling node model.banxware_assignment.transformed_sales_data
[0m23:45:55.637706 [debug] [Thread-2  ]: Writing injected SQL for node "model.banxware_assignment.transformed_sales_data"
[0m23:45:55.638198 [debug] [Thread-1  ]: Writing injected SQL for node "model.banxware_assignment.my_first_dbt_model"
[0m23:45:55.639266 [debug] [Thread-1  ]: Began executing node model.banxware_assignment.my_first_dbt_model
[0m23:45:55.639662 [debug] [Thread-2  ]: Began executing node model.banxware_assignment.transformed_sales_data
[0m23:45:55.687714 [debug] [Thread-1  ]: Writing runtime sql for node "model.banxware_assignment.my_first_dbt_model"
[0m23:45:55.689537 [debug] [Thread-2  ]: Writing runtime sql for node "model.banxware_assignment.transformed_sales_data"
[0m23:45:55.690835 [debug] [Thread-2  ]: Using snowflake connection "model.banxware_assignment.transformed_sales_data"
[0m23:45:55.691556 [debug] [Thread-1  ]: Using snowflake connection "model.banxware_assignment.my_first_dbt_model"
[0m23:45:55.691938 [debug] [Thread-2  ]: On model.banxware_assignment.transformed_sales_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.transformed_sales_data"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.transformed_sales_data
  
   as (
    -- models/transformed_sales_data.sql

WITH raw_data AS (
    SELECT
        ORDER_ID AS order_id,
        ORDER_DATE AS order_date,
        CUSTOMER_ID AS customer_id,
        PRODUCT_ID AS product_id,
        PRODUCT_NAME AS product_name,
        QUANTITY AS quantity,
        PRICE AS price,
        ORDER_STATUS AS order_status
    FROM HOME_ASSIGNMENT.PUBLIC.raw_sales_data
)

-- -- Extract year, month, and day from order_date
-- extracted_date AS (
--     SELECT
--         order_id,
--         order_date,
--         customer_id,
--         product_id,
--         product_name,
--         quantity,
--         price,
--         order_status,
--         EXTRACT(YEAR FROM TO_DATE(order_date, 'YYYY-MM-DD')) AS order_year,
--         EXTRACT(MONTH FROM TO_DATE(order_date, 'YYYY-MM-DD')) AS order_month,
--         EXTRACT(DAY FROM TO_DATE(order_date, 'YYYY-MM-DD')) AS order_day
--     FROM raw_data
-- ),

-- -- Calculate total sales amount for each order
-- aggregated_data AS (
--     SELECT
--         order_id,
--         customer_id,
--         order_year,
--         order_month,
--         order_day,
--         SUM(quantity * price) AS total_sales_amount
--     FROM extracted_date
--     GROUP BY
--         order_id,
--         customer_id,
--         order_year,
--         order_month,
--         order_day
-- )

SELECT * FROM raw_data
  );
[0m23:45:55.692345 [debug] [Thread-1  ]: On model.banxware_assignment.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.my_first_dbt_model"} */
create or replace transient table HOME_ASSIGNMENT.PUBLIC.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m23:45:55.692676 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:45:55.692971 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:45:56.250979 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.558 seconds
[0m23:45:56.281182 [debug] [Thread-2  ]: On model.banxware_assignment.transformed_sales_data: Close
[0m23:45:56.363486 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b2471d5-afac-4507-a1f3-07d47a87eca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a1f610>]}
[0m23:45:56.364804 [info ] [Thread-2  ]: 2 of 3 OK created sql view model PUBLIC.transformed_sales_data ................. [[32mSUCCESS 1[0m in 0.74s]
[0m23:45:56.365771 [debug] [Thread-2  ]: Finished running node model.banxware_assignment.transformed_sales_data
[0m23:45:56.522265 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.829 seconds
[0m23:45:56.533194 [debug] [Thread-1  ]: On model.banxware_assignment.my_first_dbt_model: Close
[0m23:45:56.615052 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b2471d5-afac-4507-a1f3-07d47a87eca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15343d880>]}
[0m23:45:56.616359 [info ] [Thread-1  ]: 1 of 3 OK created sql table model PUBLIC.my_first_dbt_model .................... [[32mSUCCESS 1[0m in 1.00s]
[0m23:45:56.617284 [debug] [Thread-1  ]: Finished running node model.banxware_assignment.my_first_dbt_model
[0m23:45:56.618205 [debug] [Thread-4  ]: Began running node model.banxware_assignment.my_second_dbt_model
[0m23:45:56.619101 [info ] [Thread-4  ]: 3 of 3 START sql view model PUBLIC.my_second_dbt_model ......................... [RUN]
[0m23:45:56.620056 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.banxware_assignment.my_second_dbt_model'
[0m23:45:56.620627 [debug] [Thread-4  ]: Began compiling node model.banxware_assignment.my_second_dbt_model
[0m23:45:56.625859 [debug] [Thread-4  ]: Writing injected SQL for node "model.banxware_assignment.my_second_dbt_model"
[0m23:45:56.627081 [debug] [Thread-4  ]: Began executing node model.banxware_assignment.my_second_dbt_model
[0m23:45:56.631525 [debug] [Thread-4  ]: Writing runtime sql for node "model.banxware_assignment.my_second_dbt_model"
[0m23:45:56.632712 [debug] [Thread-4  ]: Using snowflake connection "model.banxware_assignment.my_second_dbt_model"
[0m23:45:56.633238 [debug] [Thread-4  ]: On model.banxware_assignment.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.my_second_dbt_model"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from HOME_ASSIGNMENT.PUBLIC.my_first_dbt_model
where id = 1
  );
[0m23:45:56.633717 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:45:57.385372 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.751 seconds
[0m23:45:57.393399 [debug] [Thread-4  ]: On model.banxware_assignment.my_second_dbt_model: Close
[0m23:45:57.484001 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b2471d5-afac-4507-a1f3-07d47a87eca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153544550>]}
[0m23:45:57.487012 [info ] [Thread-4  ]: 3 of 3 OK created sql view model PUBLIC.my_second_dbt_model .................... [[32mSUCCESS 1[0m in 0.86s]
[0m23:45:57.488039 [debug] [Thread-4  ]: Finished running node model.banxware_assignment.my_second_dbt_model
[0m23:45:57.489619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:45:57.490009 [debug] [MainThread]: Connection 'model.banxware_assignment.my_first_dbt_model' was properly closed.
[0m23:45:57.490344 [debug] [MainThread]: Connection 'model.banxware_assignment.transformed_sales_data' was properly closed.
[0m23:45:57.490657 [debug] [MainThread]: Connection 'model.banxware_assignment.my_second_dbt_model' was properly closed.
[0m23:45:57.491042 [info ] [MainThread]: 
[0m23:45:57.491398 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 2.79 seconds (2.79s).
[0m23:45:57.492422 [debug] [MainThread]: Command end result
[0m23:45:57.525387 [info ] [MainThread]: 
[0m23:45:57.526010 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:45:57.526290 [info ] [MainThread]: 
[0m23:45:57.526574 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:45:57.529223 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.5981865, "process_user_time": 4.770063, "process_kernel_time": 0.415035, "process_mem_max_rss": "193953792", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:45:57.529668 [debug] [MainThread]: Command `dbt run` succeeded at 23:45:57.529589 after 4.60 seconds
[0m23:45:57.529996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104abd430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152e8f7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107380370>]}
[0m23:45:57.530316 [debug] [MainThread]: Flushing usage events
[0m23:46:12.640165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051ae4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072f0430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072f0be0>]}


============================== 23:46:12.644239 | d3b62ddd-8975-40be-9e9a-8de15eb718ad ==============================
[0m23:46:12.644239 [info ] [MainThread]: Running with dbt=1.8.6
[0m23:46:12.644753 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/neerajchauhan/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:46:13.823772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3b62ddd-8975-40be-9e9a-8de15eb718ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105421610>]}
[0m23:46:13.883900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3b62ddd-8975-40be-9e9a-8de15eb718ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f8c4c0>]}
[0m23:46:13.885493 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:46:13.903184 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m23:46:14.042652 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:46:14.043221 [debug] [MainThread]: Partial parsing: updated file: banxware_assignment://models/example/transformed_sales_data.sql
[0m23:46:14.339024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3b62ddd-8975-40be-9e9a-8de15eb718ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f245e20>]}
[0m23:46:14.440359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3b62ddd-8975-40be-9e9a-8de15eb718ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f257820>]}
[0m23:46:14.440853 [info ] [MainThread]: Found 3 models, 2 seeds, 4 data tests, 448 macros
[0m23:46:14.441158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3b62ddd-8975-40be-9e9a-8de15eb718ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f266610>]}
[0m23:46:14.442359 [info ] [MainThread]: 
[0m23:46:14.442800 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:46:14.446671 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOME_ASSIGNMENT'
[0m23:46:14.458678 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT"
[0m23:46:14.458993 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT"} */
show terse schemas in database HOME_ASSIGNMENT
    limit 10000
[0m23:46:14.459258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:46:14.798477 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.339 seconds
[0m23:46:14.802580 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: Close
[0m23:46:14.918582 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT, now list_HOME_ASSIGNMENT_PUBLIC)
[0m23:46:14.929502 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT_PUBLIC"
[0m23:46:14.930111 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT_PUBLIC"} */
show objects in HOME_ASSIGNMENT.PUBLIC limit 10000
[0m23:46:14.930480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:46:15.365632 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.435 seconds
[0m23:46:15.371469 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: Close
[0m23:46:15.478347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3b62ddd-8975-40be-9e9a-8de15eb718ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f117e80>]}
[0m23:46:15.479821 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:46:15.480499 [info ] [MainThread]: 
[0m23:46:15.484909 [debug] [Thread-1  ]: Began running node model.banxware_assignment.my_first_dbt_model
[0m23:46:15.485634 [debug] [Thread-2  ]: Began running node model.banxware_assignment.transformed_sales_data
[0m23:46:15.486465 [info ] [Thread-1  ]: 1 of 3 START sql table model PUBLIC.my_first_dbt_model ......................... [RUN]
[0m23:46:15.487286 [info ] [Thread-2  ]: 2 of 3 START sql view model PUBLIC.transformed_sales_data ...................... [RUN]
[0m23:46:15.487970 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT_PUBLIC, now model.banxware_assignment.my_first_dbt_model)
[0m23:46:15.490673 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.banxware_assignment.transformed_sales_data'
[0m23:46:15.491208 [debug] [Thread-1  ]: Began compiling node model.banxware_assignment.my_first_dbt_model
[0m23:46:15.491738 [debug] [Thread-2  ]: Began compiling node model.banxware_assignment.transformed_sales_data
[0m23:46:15.503695 [debug] [Thread-1  ]: Writing injected SQL for node "model.banxware_assignment.my_first_dbt_model"
[0m23:46:15.507225 [debug] [Thread-2  ]: Writing injected SQL for node "model.banxware_assignment.transformed_sales_data"
[0m23:46:15.508211 [debug] [Thread-2  ]: Began executing node model.banxware_assignment.transformed_sales_data
[0m23:46:15.508627 [debug] [Thread-1  ]: Began executing node model.banxware_assignment.my_first_dbt_model
[0m23:46:15.554566 [debug] [Thread-2  ]: Writing runtime sql for node "model.banxware_assignment.transformed_sales_data"
[0m23:46:15.555099 [debug] [Thread-1  ]: Writing runtime sql for node "model.banxware_assignment.my_first_dbt_model"
[0m23:46:15.556219 [debug] [Thread-1  ]: Using snowflake connection "model.banxware_assignment.my_first_dbt_model"
[0m23:46:15.557748 [debug] [Thread-2  ]: Using snowflake connection "model.banxware_assignment.transformed_sales_data"
[0m23:46:15.558106 [debug] [Thread-1  ]: On model.banxware_assignment.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.my_first_dbt_model"} */
create or replace transient table HOME_ASSIGNMENT.PUBLIC.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m23:46:15.558537 [debug] [Thread-2  ]: On model.banxware_assignment.transformed_sales_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.transformed_sales_data"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.transformed_sales_data
  
   as (
    -- models/transformed_sales_data.sql

WITH raw_data AS (
    SELECT
        ORDER_ID AS order_id,
        ORDER_DATE AS order_date,
        CUSTOMER_ID AS customer_id,
        PRODUCT_ID AS product_id,
        PRODUCT_NAME AS product_name,
        QUANTITY AS quantity,
        PRICE AS price,
        ORDER_STATUS AS order_status
    FROM HOME_ASSIGNMENT.PUBLIC.raw_sales_data
)

-- Extract year, month, and day from order_date
extracted_date AS (
    SELECT
        order_id,
        order_date,
        customer_id,
        product_id,
        product_name,
        quantity,
        price,
        order_status,
        EXTRACT(YEAR FROM TO_DATE(order_date, 'YYYY-MM-DD')) AS order_year,
        EXTRACT(MONTH FROM TO_DATE(order_date, 'YYYY-MM-DD')) AS order_month,
        EXTRACT(DAY FROM TO_DATE(order_date, 'YYYY-MM-DD')) AS order_day
    FROM raw_data
),

-- Calculate total sales amount for each order
aggregated_data AS (
    SELECT
        order_id,
        customer_id,
        order_year,
        order_month,
        order_day,
        SUM(quantity * price) AS total_sales_amount
    FROM extracted_date
    GROUP BY
        order_id,
        customer_id,
        order_year,
        order_month,
        order_day
)

SELECT * FROM raw_data
  );
[0m23:46:15.558895 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:46:15.559177 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:46:15.902234 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01b6e6da-0103-0761-0000-0002ef229e3d
[0m23:46:15.902985 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 0 unexpected 'extracted_date'.
syntax error line 30 at position 59 unexpected ')'.
[0m23:46:15.903722 [debug] [Thread-2  ]: On model.banxware_assignment.transformed_sales_data: Close
[0m23:46:16.019062 [debug] [Thread-2  ]: Database Error in model transformed_sales_data (models/example/transformed_sales_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 0 unexpected 'extracted_date'.
  syntax error line 30 at position 59 unexpected ')'.
  compiled Code at target/run/banxware_assignment/models/example/transformed_sales_data.sql
[0m23:46:16.022016 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3b62ddd-8975-40be-9e9a-8de15eb718ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f5b2c70>]}
[0m23:46:16.023115 [error] [Thread-2  ]: 2 of 3 ERROR creating sql view model PUBLIC.transformed_sales_data ............. [[31mERROR[0m in 0.53s]
[0m23:46:16.024086 [debug] [Thread-2  ]: Finished running node model.banxware_assignment.transformed_sales_data
[0m23:46:16.529670 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.970 seconds
[0m23:46:16.562458 [debug] [Thread-1  ]: On model.banxware_assignment.my_first_dbt_model: Close
[0m23:46:16.643469 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3b62ddd-8975-40be-9e9a-8de15eb718ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10729ca00>]}
[0m23:46:16.644633 [info ] [Thread-1  ]: 1 of 3 OK created sql table model PUBLIC.my_first_dbt_model .................... [[32mSUCCESS 1[0m in 1.16s]
[0m23:46:16.645558 [debug] [Thread-1  ]: Finished running node model.banxware_assignment.my_first_dbt_model
[0m23:46:16.646655 [debug] [Thread-4  ]: Began running node model.banxware_assignment.my_second_dbt_model
[0m23:46:16.647353 [info ] [Thread-4  ]: 3 of 3 START sql view model PUBLIC.my_second_dbt_model ......................... [RUN]
[0m23:46:16.648042 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.banxware_assignment.my_second_dbt_model'
[0m23:46:16.648504 [debug] [Thread-4  ]: Began compiling node model.banxware_assignment.my_second_dbt_model
[0m23:46:16.652688 [debug] [Thread-4  ]: Writing injected SQL for node "model.banxware_assignment.my_second_dbt_model"
[0m23:46:16.653656 [debug] [Thread-4  ]: Began executing node model.banxware_assignment.my_second_dbt_model
[0m23:46:16.657945 [debug] [Thread-4  ]: Writing runtime sql for node "model.banxware_assignment.my_second_dbt_model"
[0m23:46:16.658979 [debug] [Thread-4  ]: Using snowflake connection "model.banxware_assignment.my_second_dbt_model"
[0m23:46:16.659395 [debug] [Thread-4  ]: On model.banxware_assignment.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.my_second_dbt_model"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from HOME_ASSIGNMENT.PUBLIC.my_first_dbt_model
where id = 1
  );
[0m23:46:16.659826 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:46:17.090545 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.430 seconds
[0m23:46:17.097671 [debug] [Thread-4  ]: On model.banxware_assignment.my_second_dbt_model: Close
[0m23:46:17.179182 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3b62ddd-8975-40be-9e9a-8de15eb718ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f3dd820>]}
[0m23:46:17.180613 [info ] [Thread-4  ]: 3 of 3 OK created sql view model PUBLIC.my_second_dbt_model .................... [[32mSUCCESS 1[0m in 0.53s]
[0m23:46:17.181634 [debug] [Thread-4  ]: Finished running node model.banxware_assignment.my_second_dbt_model
[0m23:46:17.183408 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:46:17.183865 [debug] [MainThread]: Connection 'model.banxware_assignment.my_first_dbt_model' was properly closed.
[0m23:46:17.184265 [debug] [MainThread]: Connection 'model.banxware_assignment.transformed_sales_data' was properly closed.
[0m23:46:17.184651 [debug] [MainThread]: Connection 'model.banxware_assignment.my_second_dbt_model' was properly closed.
[0m23:46:17.185189 [info ] [MainThread]: 
[0m23:46:17.185707 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 2.74 seconds (2.74s).
[0m23:46:17.187097 [debug] [MainThread]: Command end result
[0m23:46:17.228250 [info ] [MainThread]: 
[0m23:46:17.228781 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:46:17.229049 [info ] [MainThread]: 
[0m23:46:17.229388 [error] [MainThread]:   Database Error in model transformed_sales_data (models/example/transformed_sales_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 0 unexpected 'extracted_date'.
  syntax error line 30 at position 59 unexpected ')'.
  compiled Code at target/run/banxware_assignment/models/example/transformed_sales_data.sql
[0m23:46:17.229655 [info ] [MainThread]: 
[0m23:46:17.229914 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:46:17.232496 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.661663, "process_user_time": 4.780146, "process_kernel_time": 0.44359, "process_mem_max_rss": "194805760", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:46:17.232924 [debug] [MainThread]: Command `dbt run` failed at 23:46:17.232848 after 4.66 seconds
[0m23:46:17.233251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051ae4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd3310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f241d90>]}
[0m23:46:17.233559 [debug] [MainThread]: Flushing usage events
[0m23:46:32.617604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104626550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106768280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106768e50>]}


============================== 23:46:32.621696 | 434bb8d3-854d-4d09-9b6c-c001c47f6f96 ==============================
[0m23:46:32.621696 [info ] [MainThread]: Running with dbt=1.8.6
[0m23:46:32.622184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/neerajchauhan/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:46:33.691069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '434bb8d3-854d-4d09-9b6c-c001c47f6f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048936a0>]}
[0m23:46:33.750907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '434bb8d3-854d-4d09-9b6c-c001c47f6f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121133520>]}
[0m23:46:33.751725 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:46:33.769082 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m23:46:33.905970 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:46:33.906582 [debug] [MainThread]: Partial parsing: updated file: banxware_assignment://models/example/transformed_sales_data.sql
[0m23:46:34.202514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '434bb8d3-854d-4d09-9b6c-c001c47f6f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121705ee0>]}
[0m23:46:34.298659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '434bb8d3-854d-4d09-9b6c-c001c47f6f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121707fd0>]}
[0m23:46:34.299172 [info ] [MainThread]: Found 3 models, 2 seeds, 4 data tests, 448 macros
[0m23:46:34.299477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '434bb8d3-854d-4d09-9b6c-c001c47f6f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121744cd0>]}
[0m23:46:34.300659 [info ] [MainThread]: 
[0m23:46:34.301106 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:46:34.304971 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOME_ASSIGNMENT'
[0m23:46:34.317000 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT"
[0m23:46:34.317313 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT"} */
show terse schemas in database HOME_ASSIGNMENT
    limit 10000
[0m23:46:34.317568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:46:34.674510 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.357 seconds
[0m23:46:34.677730 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: Close
[0m23:46:34.759365 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT, now list_HOME_ASSIGNMENT_PUBLIC)
[0m23:46:34.775980 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT_PUBLIC"
[0m23:46:34.776535 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT_PUBLIC"} */
show objects in HOME_ASSIGNMENT.PUBLIC limit 10000
[0m23:46:34.776931 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:46:35.128167 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.351 seconds
[0m23:46:35.133699 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: Close
[0m23:46:35.223980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '434bb8d3-854d-4d09-9b6c-c001c47f6f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1216ee790>]}
[0m23:46:35.225183 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:46:35.225732 [info ] [MainThread]: 
[0m23:46:35.229958 [debug] [Thread-1  ]: Began running node model.banxware_assignment.my_first_dbt_model
[0m23:46:35.230647 [debug] [Thread-2  ]: Began running node model.banxware_assignment.transformed_sales_data
[0m23:46:35.231533 [info ] [Thread-1  ]: 1 of 3 START sql table model PUBLIC.my_first_dbt_model ......................... [RUN]
[0m23:46:35.232368 [info ] [Thread-2  ]: 2 of 3 START sql view model PUBLIC.transformed_sales_data ...................... [RUN]
[0m23:46:35.233088 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT_PUBLIC, now model.banxware_assignment.my_first_dbt_model)
[0m23:46:35.235731 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.banxware_assignment.transformed_sales_data'
[0m23:46:35.236332 [debug] [Thread-1  ]: Began compiling node model.banxware_assignment.my_first_dbt_model
[0m23:46:35.236800 [debug] [Thread-2  ]: Began compiling node model.banxware_assignment.transformed_sales_data
[0m23:46:35.248420 [debug] [Thread-1  ]: Writing injected SQL for node "model.banxware_assignment.my_first_dbt_model"
[0m23:46:35.251859 [debug] [Thread-2  ]: Writing injected SQL for node "model.banxware_assignment.transformed_sales_data"
[0m23:46:35.253064 [debug] [Thread-2  ]: Began executing node model.banxware_assignment.transformed_sales_data
[0m23:46:35.253467 [debug] [Thread-1  ]: Began executing node model.banxware_assignment.my_first_dbt_model
[0m23:46:35.299256 [debug] [Thread-2  ]: Writing runtime sql for node "model.banxware_assignment.transformed_sales_data"
[0m23:46:35.299800 [debug] [Thread-1  ]: Writing runtime sql for node "model.banxware_assignment.my_first_dbt_model"
[0m23:46:35.301760 [debug] [Thread-2  ]: Using snowflake connection "model.banxware_assignment.transformed_sales_data"
[0m23:46:35.302482 [debug] [Thread-1  ]: Using snowflake connection "model.banxware_assignment.my_first_dbt_model"
[0m23:46:35.302854 [debug] [Thread-2  ]: On model.banxware_assignment.transformed_sales_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.transformed_sales_data"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.transformed_sales_data
  
   as (
    -- models/transformed_sales_data.sql

WITH raw_data AS (
    SELECT
        ORDER_ID AS order_id,
        ORDER_DATE AS order_date,
        CUSTOMER_ID AS customer_id,
        PRODUCT_ID AS product_id,
        PRODUCT_NAME AS product_name,
        QUANTITY AS quantity,
        PRICE AS price,
        ORDER_STATUS AS order_status
    FROM HOME_ASSIGNMENT.PUBLIC.raw_sales_data
),

-- Extract year, month, and day from order_date
extracted_date AS (
    SELECT
        order_id,
        order_date,
        customer_id,
        product_id,
        product_name,
        quantity,
        price,
        order_status,
        EXTRACT(YEAR FROM TO_DATE(order_date, 'YYYY-MM-DD')) AS order_year,
        EXTRACT(MONTH FROM TO_DATE(order_date, 'YYYY-MM-DD')) AS order_month,
        EXTRACT(DAY FROM TO_DATE(order_date, 'YYYY-MM-DD')) AS order_day
    FROM raw_data
),

-- Calculate total sales amount for each order
aggregated_data AS (
    SELECT
        order_id,
        customer_id,
        order_year,
        order_month,
        order_day,
        SUM(quantity * price) AS total_sales_amount
    FROM extracted_date
    GROUP BY
        order_id,
        customer_id,
        order_year,
        order_month,
        order_day
)

SELECT * FROM raw_data
  );
[0m23:46:35.303268 [debug] [Thread-1  ]: On model.banxware_assignment.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.my_first_dbt_model"} */
create or replace transient table HOME_ASSIGNMENT.PUBLIC.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m23:46:35.303614 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:46:35.303896 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:46:35.745859 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.442 seconds
[0m23:46:35.783106 [debug] [Thread-2  ]: On model.banxware_assignment.transformed_sales_data: Close
[0m23:46:35.868677 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '434bb8d3-854d-4d09-9b6c-c001c47f6f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10670fdc0>]}
[0m23:46:35.870061 [info ] [Thread-2  ]: 2 of 3 OK created sql view model PUBLIC.transformed_sales_data ................. [[32mSUCCESS 1[0m in 0.63s]
[0m23:46:35.871118 [debug] [Thread-2  ]: Finished running node model.banxware_assignment.transformed_sales_data
[0m23:46:36.080193 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.776 seconds
[0m23:46:36.087468 [debug] [Thread-1  ]: On model.banxware_assignment.my_first_dbt_model: Close
[0m23:46:36.178616 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '434bb8d3-854d-4d09-9b6c-c001c47f6f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121b5fc70>]}
[0m23:46:36.180486 [info ] [Thread-1  ]: 1 of 3 OK created sql table model PUBLIC.my_first_dbt_model .................... [[32mSUCCESS 1[0m in 0.95s]
[0m23:46:36.181814 [debug] [Thread-1  ]: Finished running node model.banxware_assignment.my_first_dbt_model
[0m23:46:36.183060 [debug] [Thread-4  ]: Began running node model.banxware_assignment.my_second_dbt_model
[0m23:46:36.183910 [info ] [Thread-4  ]: 3 of 3 START sql view model PUBLIC.my_second_dbt_model ......................... [RUN]
[0m23:46:36.184843 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.banxware_assignment.my_second_dbt_model'
[0m23:46:36.185420 [debug] [Thread-4  ]: Began compiling node model.banxware_assignment.my_second_dbt_model
[0m23:46:36.190862 [debug] [Thread-4  ]: Writing injected SQL for node "model.banxware_assignment.my_second_dbt_model"
[0m23:46:36.192028 [debug] [Thread-4  ]: Began executing node model.banxware_assignment.my_second_dbt_model
[0m23:46:36.196572 [debug] [Thread-4  ]: Writing runtime sql for node "model.banxware_assignment.my_second_dbt_model"
[0m23:46:36.197777 [debug] [Thread-4  ]: Using snowflake connection "model.banxware_assignment.my_second_dbt_model"
[0m23:46:36.198287 [debug] [Thread-4  ]: On model.banxware_assignment.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.my_second_dbt_model"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from HOME_ASSIGNMENT.PUBLIC.my_first_dbt_model
where id = 1
  );
[0m23:46:36.198754 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:46:36.634617 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.435 seconds
[0m23:46:36.640665 [debug] [Thread-4  ]: On model.banxware_assignment.my_second_dbt_model: Close
[0m23:46:36.726981 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '434bb8d3-854d-4d09-9b6c-c001c47f6f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121a53b20>]}
[0m23:46:36.729531 [info ] [Thread-4  ]: 3 of 3 OK created sql view model PUBLIC.my_second_dbt_model .................... [[32mSUCCESS 1[0m in 0.54s]
[0m23:46:36.730935 [debug] [Thread-4  ]: Finished running node model.banxware_assignment.my_second_dbt_model
[0m23:46:36.732776 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:46:36.733262 [debug] [MainThread]: Connection 'model.banxware_assignment.my_first_dbt_model' was properly closed.
[0m23:46:36.733668 [debug] [MainThread]: Connection 'model.banxware_assignment.transformed_sales_data' was properly closed.
[0m23:46:36.734054 [debug] [MainThread]: Connection 'model.banxware_assignment.my_second_dbt_model' was properly closed.
[0m23:46:36.734646 [info ] [MainThread]: 
[0m23:46:36.735166 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 2.43 seconds (2.43s).
[0m23:46:36.736621 [debug] [MainThread]: Command end result
[0m23:46:36.775986 [info ] [MainThread]: 
[0m23:46:36.776429 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:46:36.776701 [info ] [MainThread]: 
[0m23:46:36.776970 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:46:36.779500 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.2274675, "process_user_time": 4.844776, "process_kernel_time": 0.410936, "process_mem_max_rss": "198639616", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:46:36.779935 [debug] [MainThread]: Command `dbt run` succeeded at 23:46:36.779857 after 4.23 seconds
[0m23:46:36.780269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104626550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10614bdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048936a0>]}
[0m23:46:36.780588 [debug] [MainThread]: Flushing usage events
[0m23:46:56.261482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ed3490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107014280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107014d60>]}


============================== 23:46:56.265651 | c561d4b7-ff53-478f-8d65-9404339c7ee1 ==============================
[0m23:46:56.265651 [info ] [MainThread]: Running with dbt=1.8.6
[0m23:46:56.266165 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/neerajchauhan/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m23:46:57.417265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c561d4b7-ff53-478f-8d65-9404339c7ee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d571f0>]}
[0m23:46:57.477646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c561d4b7-ff53-478f-8d65-9404339c7ee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb0490>]}
[0m23:46:57.478804 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:46:57.495691 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m23:46:57.633198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:46:57.633624 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:46:57.728716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c561d4b7-ff53-478f-8d65-9404339c7ee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129ebc7c0>]}
[0m23:46:57.829270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c561d4b7-ff53-478f-8d65-9404339c7ee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129c7a6a0>]}
[0m23:46:57.829779 [info ] [MainThread]: Found 3 models, 2 seeds, 4 data tests, 448 macros
[0m23:46:57.830094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c561d4b7-ff53-478f-8d65-9404339c7ee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a1f6160>]}
[0m23:46:57.831351 [info ] [MainThread]: 
[0m23:46:57.831803 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:46:57.835589 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOME_ASSIGNMENT'
[0m23:46:57.848741 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT"
[0m23:46:57.849068 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT"} */
show terse schemas in database HOME_ASSIGNMENT
    limit 10000
[0m23:46:57.849325 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:46:58.189053 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.339 seconds
[0m23:46:58.193322 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: Close
[0m23:46:58.297202 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT, now list_HOME_ASSIGNMENT_PUBLIC)
[0m23:46:58.313195 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT_PUBLIC"
[0m23:46:58.313718 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT_PUBLIC"} */
show objects in HOME_ASSIGNMENT.PUBLIC limit 10000
[0m23:46:58.314109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:46:58.655583 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.341 seconds
[0m23:46:58.661144 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: Close
[0m23:46:58.742569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c561d4b7-ff53-478f-8d65-9404339c7ee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129f4a760>]}
[0m23:46:58.743795 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:46:58.744369 [info ] [MainThread]: 
[0m23:46:58.748524 [debug] [Thread-1  ]: Began running node seed.banxware_assignment.customers
[0m23:46:58.749206 [debug] [Thread-2  ]: Began running node seed.banxware_assignment.sales
[0m23:46:58.749999 [info ] [Thread-1  ]: 1 of 2 START seed file PUBLIC.raw_customer_data ................................ [RUN]
[0m23:46:58.750770 [info ] [Thread-2  ]: 2 of 2 START seed file PUBLIC.raw_sales_data ................................... [RUN]
[0m23:46:58.751502 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT_PUBLIC, now seed.banxware_assignment.customers)
[0m23:46:58.752420 [debug] [Thread-1  ]: Began compiling node seed.banxware_assignment.customers
[0m23:46:58.753229 [debug] [Thread-2  ]: Acquiring new snowflake connection 'seed.banxware_assignment.sales'
[0m23:46:58.753770 [debug] [Thread-1  ]: Began executing node seed.banxware_assignment.customers
[0m23:46:58.754315 [debug] [Thread-2  ]: Began compiling node seed.banxware_assignment.sales
[0m23:46:58.767368 [debug] [Thread-2  ]: Began executing node seed.banxware_assignment.sales
[0m23:46:58.811847 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:46:58.815489 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:46:58.815817 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
BEGIN
[0m23:46:58.816149 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
BEGIN
[0m23:46:58.816455 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:46:58.816729 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:46:59.119292 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.302 seconds
[0m23:46:59.121864 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:46:59.123151 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.307 seconds
[0m23:46:59.124048 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
truncate table "HOME_ASSIGNMENT"."PUBLIC"."RAW_CUSTOMER_DATA"
  ;
[0m23:46:59.125146 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:46:59.127189 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
truncate table "HOME_ASSIGNMENT"."PUBLIC"."RAW_SALES_DATA"
  ;
[0m23:46:59.335267 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.209 seconds
[0m23:46:59.337696 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:46:59.338781 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.211 seconds
[0m23:46:59.339695 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
COMMIT
[0m23:46:59.340764 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:46:59.341856 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
COMMIT
[0m23:46:59.627917 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.286 seconds
[0m23:46:59.654508 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:46:59.655526 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.313 seconds
[0m23:46:59.656015 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
BEGIN
[0m23:46:59.661595 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:46:59.662297 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
BEGIN
[0m23:46:59.743740 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.081 seconds
[0m23:46:59.751620 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:46:59.752246 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
insert into HOME_ASSIGNMENT.PUBLIC.raw_sales_data (order_id, order_date, customer_id, product_id, product_name, quantity, price, order_status) values
            (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%...
[0m23:46:59.763146 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.101 seconds
[0m23:46:59.764706 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:46:59.765195 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
insert into HOME_ASSIGNMENT.PUBLIC.raw_customer_data (id, name) values
            (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%...
[0m23:47:00.255490 [debug] [Thread-2  ]: SQL status: SUCCESS 100 in 0.502 seconds
[0m23:47:00.257262 [debug] [Thread-1  ]: SQL status: SUCCESS 60 in 0.492 seconds
[0m23:47:00.258476 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:47:00.259170 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:47:00.259986 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
COMMIT
[0m23:47:00.260762 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
COMMIT
[0m23:47:00.561863 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.300 seconds
[0m23:47:00.563567 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.302 seconds
[0m23:47:00.574961 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.banxware_assignment.sales"
[0m23:47:00.576143 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.banxware_assignment.customers"
[0m23:47:00.615434 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: Close
[0m23:47:00.616805 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: Close
[0m23:47:00.695310 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c561d4b7-ff53-478f-8d65-9404339c7ee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a3c5fa0>]}
[0m23:47:00.696015 [info ] [Thread-2  ]: 2 of 2 OK loaded seed file PUBLIC.raw_sales_data ............................... [[32mINSERT 100[0m in 1.94s]
[0m23:47:00.696738 [debug] [Thread-2  ]: Finished running node seed.banxware_assignment.sales
[0m23:47:00.697366 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c561d4b7-ff53-478f-8d65-9404339c7ee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051381c0>]}
[0m23:47:00.697883 [info ] [Thread-1  ]: 1 of 2 OK loaded seed file PUBLIC.raw_customer_data ............................ [[32mINSERT 60[0m in 1.95s]
[0m23:47:00.698448 [debug] [Thread-1  ]: Finished running node seed.banxware_assignment.customers
[0m23:47:00.699609 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:47:00.699995 [debug] [MainThread]: Connection 'seed.banxware_assignment.customers' was properly closed.
[0m23:47:00.700303 [debug] [MainThread]: Connection 'seed.banxware_assignment.sales' was properly closed.
[0m23:47:00.700655 [info ] [MainThread]: 
[0m23:47:00.701009 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 2.87 seconds (2.87s).
[0m23:47:00.701815 [debug] [MainThread]: Command end result
[0m23:47:00.731635 [info ] [MainThread]: 
[0m23:47:00.732092 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:47:00.732375 [info ] [MainThread]: 
[0m23:47:00.732656 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:47:00.735362 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 4.5423617, "process_user_time": 4.577136, "process_kernel_time": 0.431189, "process_mem_max_rss": "191152128", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:47:00.735911 [debug] [MainThread]: Command `dbt seed` succeeded at 23:47:00.735816 after 4.54 seconds
[0m23:47:00.736333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ed3490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069ff9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb0490>]}
[0m23:47:00.736702 [debug] [MainThread]: Flushing usage events
[0m23:47:55.634785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e024c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f44460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f44be0>]}


============================== 23:47:55.639280 | 377eedf8-f4fc-4345-b21e-96660549bf27 ==============================
[0m23:47:55.639280 [info ] [MainThread]: Running with dbt=1.8.6
[0m23:47:55.639866 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs', 'debug': 'False', 'profiles_dir': '/Users/neerajchauhan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:47:56.818135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '377eedf8-f4fc-4345-b21e-96660549bf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c66340>]}
[0m23:47:56.877940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '377eedf8-f4fc-4345-b21e-96660549bf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eef1f0>]}
[0m23:47:56.879498 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:47:56.896867 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m23:47:57.033864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:47:57.034447 [debug] [MainThread]: Partial parsing: updated file: banxware_assignment://models/example/transformed_sales_data.sql
[0m23:47:57.332170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '377eedf8-f4fc-4345-b21e-96660549bf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d885e50>]}
[0m23:47:57.431049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '377eedf8-f4fc-4345-b21e-96660549bf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d89bfa0>]}
[0m23:47:57.431543 [info ] [MainThread]: Found 3 models, 2 seeds, 4 data tests, 448 macros
[0m23:47:57.431844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '377eedf8-f4fc-4345-b21e-96660549bf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d8a47f0>]}
[0m23:47:57.433027 [info ] [MainThread]: 
[0m23:47:57.433481 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:47:57.437377 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOME_ASSIGNMENT'
[0m23:47:57.449463 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT"
[0m23:47:57.449777 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT"} */
show terse schemas in database HOME_ASSIGNMENT
    limit 10000
[0m23:47:57.450029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:47:57.814605 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.364 seconds
[0m23:47:57.818148 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: Close
[0m23:47:57.903582 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT, now list_HOME_ASSIGNMENT_PUBLIC)
[0m23:47:57.919884 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT_PUBLIC"
[0m23:47:57.920381 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT_PUBLIC"} */
show objects in HOME_ASSIGNMENT.PUBLIC limit 10000
[0m23:47:57.920775 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:47:58.286890 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.366 seconds
[0m23:47:58.292603 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: Close
[0m23:47:58.388809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '377eedf8-f4fc-4345-b21e-96660549bf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d8c6d00>]}
[0m23:47:58.390108 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:47:58.390803 [info ] [MainThread]: 
[0m23:47:58.394517 [debug] [Thread-1  ]: Began running node model.banxware_assignment.my_first_dbt_model
[0m23:47:58.395192 [debug] [Thread-2  ]: Began running node model.banxware_assignment.transformed_sales_data
[0m23:47:58.395993 [info ] [Thread-1  ]: 1 of 3 START sql table model PUBLIC.my_first_dbt_model ......................... [RUN]
[0m23:47:58.396872 [info ] [Thread-2  ]: 2 of 3 START sql table model PUBLIC.transformed_sales_data ..................... [RUN]
[0m23:47:58.397681 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT_PUBLIC, now model.banxware_assignment.my_first_dbt_model)
[0m23:47:58.400229 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.banxware_assignment.transformed_sales_data'
[0m23:47:58.400779 [debug] [Thread-1  ]: Began compiling node model.banxware_assignment.my_first_dbt_model
[0m23:47:58.401329 [debug] [Thread-2  ]: Began compiling node model.banxware_assignment.transformed_sales_data
[0m23:47:58.413057 [debug] [Thread-1  ]: Writing injected SQL for node "model.banxware_assignment.my_first_dbt_model"
[0m23:47:58.416776 [debug] [Thread-2  ]: Writing injected SQL for node "model.banxware_assignment.transformed_sales_data"
[0m23:47:58.418319 [debug] [Thread-1  ]: Began executing node model.banxware_assignment.my_first_dbt_model
[0m23:47:58.418753 [debug] [Thread-2  ]: Began executing node model.banxware_assignment.transformed_sales_data
[0m23:47:58.445278 [debug] [Thread-2  ]: Dropping relation "HOME_ASSIGNMENT"."PUBLIC"."TRANSFORMED_SALES_DATA" because it is of type view
[0m23:47:58.462435 [debug] [Thread-1  ]: Writing runtime sql for node "model.banxware_assignment.my_first_dbt_model"
[0m23:47:58.462833 [debug] [Thread-2  ]: Applying DROP to: "HOME_ASSIGNMENT"."PUBLIC"."TRANSFORMED_SALES_DATA"
[0m23:47:58.468106 [debug] [Thread-2  ]: Using snowflake connection "model.banxware_assignment.transformed_sales_data"
[0m23:47:58.468483 [debug] [Thread-2  ]: On model.banxware_assignment.transformed_sales_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.transformed_sales_data"} */
drop view if exists "HOME_ASSIGNMENT"."PUBLIC"."TRANSFORMED_SALES_DATA" cascade
[0m23:47:58.468820 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:47:58.469510 [debug] [Thread-1  ]: Using snowflake connection "model.banxware_assignment.my_first_dbt_model"
[0m23:47:58.470148 [debug] [Thread-1  ]: On model.banxware_assignment.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.my_first_dbt_model"} */
create or replace transient table HOME_ASSIGNMENT.PUBLIC.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m23:47:58.470713 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:47:58.841020 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.371 seconds
[0m23:47:58.846639 [debug] [Thread-2  ]: Writing runtime sql for node "model.banxware_assignment.transformed_sales_data"
[0m23:47:58.850609 [debug] [Thread-2  ]: Using snowflake connection "model.banxware_assignment.transformed_sales_data"
[0m23:47:58.851365 [debug] [Thread-2  ]: On model.banxware_assignment.transformed_sales_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.transformed_sales_data"} */
create or replace transient table HOME_ASSIGNMENT.PUBLIC.transformed_sales_data
         as
        (-- models/transformed_sales_data.sql



WITH raw_data AS (
    SELECT
        ORDER_ID AS order_id,
        ORDER_DATE AS order_date,
        CUSTOMER_ID AS customer_id,
        PRODUCT_ID AS product_id,
        PRODUCT_NAME AS product_name,
        QUANTITY AS quantity,
        PRICE AS price,
        ORDER_STATUS AS order_status
    FROM HOME_ASSIGNMENT.PUBLIC.raw_sales_data
),

-- Extract year, month, and day from order_date
extracted_date AS (
    SELECT
        order_id,
        order_date,
        customer_id,
        product_id,
        product_name,
        quantity,
        price,
        order_status,
        EXTRACT(YEAR FROM TO_DATE(order_date, 'YYYY-MM-DD')) AS order_year,
        EXTRACT(MONTH FROM TO_DATE(order_date, 'YYYY-MM-DD')) AS order_month,
        EXTRACT(DAY FROM TO_DATE(order_date, 'YYYY-MM-DD')) AS order_day
    FROM raw_data
),

-- Calculate total sales amount for each order
aggregated_data AS (
    SELECT
        order_id,
        customer_id,
        order_year,
        order_month,
        order_day,
        SUM(quantity * price) AS total_sales_amount
    FROM extracted_date
    GROUP BY
        order_id,
        customer_id,
        order_year,
        order_month,
        order_day
)

SELECT * FROM raw_data
        );
[0m23:47:59.276105 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.805 seconds
[0m23:47:59.313023 [debug] [Thread-1  ]: On model.banxware_assignment.my_first_dbt_model: Close
[0m23:47:59.386248 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '377eedf8-f4fc-4345-b21e-96660549bf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eef1c0>]}
[0m23:47:59.387307 [info ] [Thread-1  ]: 1 of 3 OK created sql table model PUBLIC.my_first_dbt_model .................... [[32mSUCCESS 1[0m in 0.99s]
[0m23:47:59.388288 [debug] [Thread-1  ]: Finished running node model.banxware_assignment.my_first_dbt_model
[0m23:47:59.389149 [debug] [Thread-4  ]: Began running node model.banxware_assignment.my_second_dbt_model
[0m23:47:59.389870 [info ] [Thread-4  ]: 3 of 3 START sql view model PUBLIC.my_second_dbt_model ......................... [RUN]
[0m23:47:59.390675 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.banxware_assignment.my_second_dbt_model'
[0m23:47:59.391222 [debug] [Thread-4  ]: Began compiling node model.banxware_assignment.my_second_dbt_model
[0m23:47:59.396181 [debug] [Thread-4  ]: Writing injected SQL for node "model.banxware_assignment.my_second_dbt_model"
[0m23:47:59.397183 [debug] [Thread-4  ]: Began executing node model.banxware_assignment.my_second_dbt_model
[0m23:47:59.420759 [debug] [Thread-4  ]: Writing runtime sql for node "model.banxware_assignment.my_second_dbt_model"
[0m23:47:59.422040 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.570 seconds
[0m23:47:59.424243 [debug] [Thread-2  ]: On model.banxware_assignment.transformed_sales_data: Close
[0m23:47:59.425849 [debug] [Thread-4  ]: Using snowflake connection "model.banxware_assignment.my_second_dbt_model"
[0m23:47:59.426577 [debug] [Thread-4  ]: On model.banxware_assignment.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.my_second_dbt_model"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from HOME_ASSIGNMENT.PUBLIC.my_first_dbt_model
where id = 1
  );
[0m23:47:59.426977 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:47:59.501876 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '377eedf8-f4fc-4345-b21e-96660549bf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dbcc730>]}
[0m23:47:59.502530 [info ] [Thread-2  ]: 2 of 3 OK created sql table model PUBLIC.transformed_sales_data ................ [[32mSUCCESS 1[0m in 1.10s]
[0m23:47:59.503043 [debug] [Thread-2  ]: Finished running node model.banxware_assignment.transformed_sales_data
[0m23:47:59.999592 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.572 seconds
[0m23:48:00.005506 [debug] [Thread-4  ]: On model.banxware_assignment.my_second_dbt_model: Close
[0m23:48:00.087410 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '377eedf8-f4fc-4345-b21e-96660549bf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11db80730>]}
[0m23:48:00.089447 [info ] [Thread-4  ]: 3 of 3 OK created sql view model PUBLIC.my_second_dbt_model .................... [[32mSUCCESS 1[0m in 0.70s]
[0m23:48:00.090762 [debug] [Thread-4  ]: Finished running node model.banxware_assignment.my_second_dbt_model
[0m23:48:00.092574 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:48:00.093034 [debug] [MainThread]: Connection 'model.banxware_assignment.my_first_dbt_model' was properly closed.
[0m23:48:00.093433 [debug] [MainThread]: Connection 'model.banxware_assignment.transformed_sales_data' was properly closed.
[0m23:48:00.093819 [debug] [MainThread]: Connection 'model.banxware_assignment.my_second_dbt_model' was properly closed.
[0m23:48:00.094363 [info ] [MainThread]: 
[0m23:48:00.094850 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 2.66 seconds (2.66s).
[0m23:48:00.096222 [debug] [MainThread]: Command end result
[0m23:48:00.134322 [info ] [MainThread]: 
[0m23:48:00.134780 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:48:00.135046 [info ] [MainThread]: 
[0m23:48:00.135308 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:48:00.137821 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.5713577, "process_user_time": 4.671172, "process_kernel_time": 0.549261, "process_mem_max_rss": "197853184", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:48:00.138223 [debug] [MainThread]: Command `dbt run` succeeded at 23:48:00.138149 after 4.57 seconds
[0m23:48:00.138536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e024c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d6bd820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11db93af0>]}
[0m23:48:00.138843 [debug] [MainThread]: Flushing usage events
[0m23:48:11.611191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a61400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b5cd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b5c1c0>]}


============================== 23:48:11.615246 | d4055e22-22a8-4d49-a13a-11b7a1630ba7 ==============================
[0m23:48:11.615246 [info ] [MainThread]: Running with dbt=1.8.6
[0m23:48:11.615790 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/neerajchauhan/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:48:12.697661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4055e22-22a8-4d49-a13a-11b7a1630ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c9a6a0>]}
[0m23:48:12.757893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4055e22-22a8-4d49-a13a-11b7a1630ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10880deb0>]}
[0m23:48:12.759049 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:48:12.776595 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m23:48:12.912880 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:48:12.913339 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:48:13.008619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4055e22-22a8-4d49-a13a-11b7a1630ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1286fc880>]}
[0m23:48:13.107616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4055e22-22a8-4d49-a13a-11b7a1630ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128954c70>]}
[0m23:48:13.108144 [info ] [MainThread]: Found 3 models, 2 seeds, 4 data tests, 448 macros
[0m23:48:13.108460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4055e22-22a8-4d49-a13a-11b7a1630ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b5c460>]}
[0m23:48:13.109731 [info ] [MainThread]: 
[0m23:48:13.110188 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:48:13.114061 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOME_ASSIGNMENT'
[0m23:48:13.127364 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT"
[0m23:48:13.127680 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT"} */
show terse schemas in database HOME_ASSIGNMENT
    limit 10000
[0m23:48:13.127932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:13.486081 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.358 seconds
[0m23:48:13.489218 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: Close
[0m23:48:13.599616 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT, now list_HOME_ASSIGNMENT_PUBLIC)
[0m23:48:13.615553 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT_PUBLIC"
[0m23:48:13.616097 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT_PUBLIC"} */
show objects in HOME_ASSIGNMENT.PUBLIC limit 10000
[0m23:48:13.616503 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:48:13.954195 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.337 seconds
[0m23:48:13.961356 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: Close
[0m23:48:14.087322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4055e22-22a8-4d49-a13a-11b7a1630ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b32d90>]}
[0m23:48:14.088782 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:48:14.089458 [info ] [MainThread]: 
[0m23:48:14.093709 [debug] [Thread-1  ]: Began running node seed.banxware_assignment.customers
[0m23:48:14.094380 [debug] [Thread-2  ]: Began running node seed.banxware_assignment.sales
[0m23:48:14.095205 [info ] [Thread-1  ]: 1 of 2 START seed file PUBLIC.raw_customer_data ................................ [RUN]
[0m23:48:14.095982 [info ] [Thread-2  ]: 2 of 2 START seed file PUBLIC.raw_sales_data ................................... [RUN]
[0m23:48:14.096680 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT_PUBLIC, now seed.banxware_assignment.customers)
[0m23:48:14.097839 [debug] [Thread-2  ]: Acquiring new snowflake connection 'seed.banxware_assignment.sales'
[0m23:48:14.098366 [debug] [Thread-1  ]: Began compiling node seed.banxware_assignment.customers
[0m23:48:14.098928 [debug] [Thread-2  ]: Began compiling node seed.banxware_assignment.sales
[0m23:48:14.099473 [debug] [Thread-1  ]: Began executing node seed.banxware_assignment.customers
[0m23:48:14.099923 [debug] [Thread-2  ]: Began executing node seed.banxware_assignment.sales
[0m23:48:14.164282 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:48:14.163314 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:48:14.164675 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
BEGIN
[0m23:48:14.165004 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
BEGIN
[0m23:48:14.165312 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:48:14.165584 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:48:14.475262 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.309 seconds
[0m23:48:14.476827 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:48:14.477587 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
truncate table "HOME_ASSIGNMENT"."PUBLIC"."RAW_SALES_DATA"
  ;
[0m23:48:14.492129 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.326 seconds
[0m23:48:14.492966 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:48:14.493546 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
truncate table "HOME_ASSIGNMENT"."PUBLIC"."RAW_CUSTOMER_DATA"
  ;
[0m23:48:14.717699 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.223 seconds
[0m23:48:14.720211 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:48:14.721420 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
COMMIT
[0m23:48:14.844585 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.366 seconds
[0m23:48:14.846350 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:48:14.847367 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
COMMIT
[0m23:48:14.933998 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.211 seconds
[0m23:48:14.960601 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:48:14.961213 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
BEGIN
[0m23:48:15.081223 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.119 seconds
[0m23:48:15.085649 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:48:15.086392 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
insert into HOME_ASSIGNMENT.PUBLIC.raw_customer_data (id, name) values
            (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%...
[0m23:48:15.334950 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.486 seconds
[0m23:48:15.345051 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:48:15.345729 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
BEGIN
[0m23:48:15.417378 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.071 seconds
[0m23:48:15.427573 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:48:15.428331 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
insert into HOME_ASSIGNMENT.PUBLIC.raw_sales_data (order_id, order_date, customer_id, product_id, product_name, quantity, price, order_status) values
            (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%...
[0m23:48:15.434969 [debug] [Thread-1  ]: SQL status: SUCCESS 60 in 0.348 seconds
[0m23:48:15.435603 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:48:15.436570 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
COMMIT
[0m23:48:15.650867 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.213 seconds
[0m23:48:15.664758 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.banxware_assignment.customers"
[0m23:48:15.692950 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: Close
[0m23:48:15.754029 [debug] [Thread-2  ]: SQL status: SUCCESS 100 in 0.325 seconds
[0m23:48:15.754705 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:48:15.755204 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
COMMIT
[0m23:48:15.771333 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4055e22-22a8-4d49-a13a-11b7a1630ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128d06fd0>]}
[0m23:48:15.772051 [info ] [Thread-1  ]: 1 of 2 OK loaded seed file PUBLIC.raw_customer_data ............................ [[32mINSERT 60[0m in 1.67s]
[0m23:48:15.772814 [debug] [Thread-1  ]: Finished running node seed.banxware_assignment.customers
[0m23:48:15.975526 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.220 seconds
[0m23:48:15.977514 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.banxware_assignment.sales"
[0m23:48:15.983061 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: Close
[0m23:48:16.084432 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4055e22-22a8-4d49-a13a-11b7a1630ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128bfb3d0>]}
[0m23:48:16.086297 [info ] [Thread-2  ]: 2 of 2 OK loaded seed file PUBLIC.raw_sales_data ............................... [[32mINSERT 100[0m in 1.99s]
[0m23:48:16.087797 [debug] [Thread-2  ]: Finished running node seed.banxware_assignment.sales
[0m23:48:16.089737 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:48:16.090232 [debug] [MainThread]: Connection 'seed.banxware_assignment.customers' was properly closed.
[0m23:48:16.090661 [debug] [MainThread]: Connection 'seed.banxware_assignment.sales' was properly closed.
[0m23:48:16.091176 [info ] [MainThread]: 
[0m23:48:16.091686 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 2.98 seconds (2.98s).
[0m23:48:16.092914 [debug] [MainThread]: Command end result
[0m23:48:16.132271 [info ] [MainThread]: 
[0m23:48:16.132725 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:48:16.133000 [info ] [MainThread]: 
[0m23:48:16.133270 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:48:16.135734 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 4.590527, "process_user_time": 4.603147, "process_kernel_time": 0.487095, "process_mem_max_rss": "194756608", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:48:16.136170 [debug] [MainThread]: Command `dbt seed` succeeded at 23:48:16.136091 after 4.59 seconds
[0m23:48:16.136501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a61400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10880deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108557cd0>]}
[0m23:48:16.136811 [debug] [MainThread]: Flushing usage events
[0m23:51:26.291215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10502d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107128d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071281c0>]}


============================== 23:51:26.295551 | fdfa3d24-93f2-4eb7-80f7-10ce0fcd47c5 ==============================
[0m23:51:26.295551 [info ] [MainThread]: Running with dbt=1.8.6
[0m23:51:26.296094 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/neerajchauhan/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:51:27.469579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdfa3d24-93f2-4eb7-80f7-10ce0fcd47c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052696a0>]}
[0m23:51:27.529085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fdfa3d24-93f2-4eb7-80f7-10ce0fcd47c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dd9eb0>]}
[0m23:51:27.529991 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:51:27.547022 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m23:51:27.684924 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:51:27.685536 [debug] [MainThread]: Partial parsing: updated file: banxware_assignment://models/example/transformed_sales_data.sql
[0m23:51:27.985087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fdfa3d24-93f2-4eb7-80f7-10ce0fcd47c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a585f10>]}
[0m23:51:28.082604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fdfa3d24-93f2-4eb7-80f7-10ce0fcd47c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053b6c40>]}
[0m23:51:28.083102 [info ] [MainThread]: Found 3 models, 2 seeds, 4 data tests, 448 macros
[0m23:51:28.083409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdfa3d24-93f2-4eb7-80f7-10ce0fcd47c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a5c5ca0>]}
[0m23:51:28.084615 [info ] [MainThread]: 
[0m23:51:28.085074 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:51:28.089205 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOME_ASSIGNMENT'
[0m23:51:28.101425 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT"
[0m23:51:28.101753 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT"} */
show terse schemas in database HOME_ASSIGNMENT
    limit 10000
[0m23:51:28.102010 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:28.495961 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.394 seconds
[0m23:51:28.499271 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: Close
[0m23:51:28.579870 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT, now list_HOME_ASSIGNMENT_PUBLIC)
[0m23:51:28.596258 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT_PUBLIC"
[0m23:51:28.596774 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT_PUBLIC"} */
show objects in HOME_ASSIGNMENT.PUBLIC limit 10000
[0m23:51:28.597164 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:51:28.927342 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.330 seconds
[0m23:51:28.930801 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: Close
[0m23:51:29.017108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdfa3d24-93f2-4eb7-80f7-10ce0fcd47c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a56c760>]}
[0m23:51:29.018394 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:51:29.019050 [info ] [MainThread]: 
[0m23:51:29.022458 [debug] [Thread-1  ]: Began running node model.banxware_assignment.my_first_dbt_model
[0m23:51:29.023152 [debug] [Thread-2  ]: Began running node model.banxware_assignment.transformed_sales_data
[0m23:51:29.024026 [info ] [Thread-1  ]: 1 of 3 START sql table model PUBLIC.my_first_dbt_model ......................... [RUN]
[0m23:51:29.024898 [info ] [Thread-2  ]: 2 of 3 START sql table model PUBLIC.transformed_sales_data ..................... [RUN]
[0m23:51:29.025740 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT_PUBLIC, now model.banxware_assignment.my_first_dbt_model)
[0m23:51:29.028389 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.banxware_assignment.transformed_sales_data'
[0m23:51:29.028911 [debug] [Thread-1  ]: Began compiling node model.banxware_assignment.my_first_dbt_model
[0m23:51:29.029359 [debug] [Thread-2  ]: Began compiling node model.banxware_assignment.transformed_sales_data
[0m23:51:29.041074 [debug] [Thread-1  ]: Writing injected SQL for node "model.banxware_assignment.my_first_dbt_model"
[0m23:51:29.044838 [debug] [Thread-2  ]: Writing injected SQL for node "model.banxware_assignment.transformed_sales_data"
[0m23:51:29.046597 [debug] [Thread-1  ]: Began executing node model.banxware_assignment.my_first_dbt_model
[0m23:51:29.047043 [debug] [Thread-2  ]: Began executing node model.banxware_assignment.transformed_sales_data
[0m23:51:29.090559 [debug] [Thread-2  ]: Writing runtime sql for node "model.banxware_assignment.transformed_sales_data"
[0m23:51:29.093969 [debug] [Thread-1  ]: Writing runtime sql for node "model.banxware_assignment.my_first_dbt_model"
[0m23:51:29.095852 [debug] [Thread-2  ]: Using snowflake connection "model.banxware_assignment.transformed_sales_data"
[0m23:51:29.096560 [debug] [Thread-1  ]: Using snowflake connection "model.banxware_assignment.my_first_dbt_model"
[0m23:51:29.096958 [debug] [Thread-2  ]: On model.banxware_assignment.transformed_sales_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.transformed_sales_data"} */
create or replace transient table HOME_ASSIGNMENT.PUBLIC.transformed_sales_data
         as
        (-- models/transformed_sales_data.sql



WITH raw_data AS (
    SELECT
        ORDER_ID AS order_id,
        ORDER_DATE AS order_date,
        CUSTOMER_ID AS customer_id,
        PRODUCT_ID AS product_id,
        PRODUCT_NAME AS product_name,
        QUANTITY AS quantity,
        PRICE AS price,
        ORDER_STATUS AS order_status
    FROM HOME_ASSIGNMENT.PUBLIC.raw_sales_data
),

-- Extract year, month, and day from order_date
extracted_date AS (
    SELECT
        order_id,
        order_date,
        customer_id,
        product_id,
        product_name,
        quantity,
        price,
        order_status,
        EXTRACT(YEAR FROM TO_DATE(order_date, 'YYYY-MM-DD')) AS order_year,
        EXTRACT(MONTH FROM TO_DATE(order_date, 'YYYY-MM-DD')) AS order_month,
        EXTRACT(DAY FROM TO_DATE(order_date, 'YYYY-MM-DD')) AS order_day
    FROM raw_data
),

-- Calculate total sales amount for each order
aggregated_data AS (
    SELECT
        order_id,
        customer_id,
        order_year,
        order_month,
        order_day,
        SUM(quantity * price) AS total_sales_amount
    FROM extracted_date
    GROUP BY
        order_id,
        customer_id,
        order_year,
        order_month,
        order_day
)

SELECT * FROM aggregated_data
        );
[0m23:51:29.097376 [debug] [Thread-1  ]: On model.banxware_assignment.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.my_first_dbt_model"} */
create or replace transient table HOME_ASSIGNMENT.PUBLIC.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m23:51:29.097708 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:51:29.097988 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:51:29.936358 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01b6e6df-0103-075e-0000-0002ef22e0ed
[0m23:51:29.937099 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 100097 (22007): Can't parse '4/13/2023' as date with format 'YYYY-MM-DD'
[0m23:51:29.937816 [debug] [Thread-2  ]: On model.banxware_assignment.transformed_sales_data: Close
[0m23:51:29.965808 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.868 seconds
[0m23:51:29.998681 [debug] [Thread-1  ]: On model.banxware_assignment.my_first_dbt_model: Close
[0m23:51:30.047085 [debug] [Thread-2  ]: Database Error in model transformed_sales_data (models/example/transformed_sales_data.sql)
  100097 (22007): Can't parse '4/13/2023' as date with format 'YYYY-MM-DD'
  compiled Code at target/run/banxware_assignment/models/example/transformed_sales_data.sql
[0m23:51:30.049117 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdfa3d24-93f2-4eb7-80f7-10ce0fcd47c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106578d30>]}
[0m23:51:30.049923 [error] [Thread-2  ]: 2 of 3 ERROR creating sql table model PUBLIC.transformed_sales_data ............ [[31mERROR[0m in 1.02s]
[0m23:51:30.050601 [debug] [Thread-2  ]: Finished running node model.banxware_assignment.transformed_sales_data
[0m23:51:30.070428 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdfa3d24-93f2-4eb7-80f7-10ce0fcd47c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070cb640>]}
[0m23:51:30.071166 [info ] [Thread-1  ]: 1 of 3 OK created sql table model PUBLIC.my_first_dbt_model .................... [[32mSUCCESS 1[0m in 1.04s]
[0m23:51:30.071874 [debug] [Thread-1  ]: Finished running node model.banxware_assignment.my_first_dbt_model
[0m23:51:30.072809 [debug] [Thread-4  ]: Began running node model.banxware_assignment.my_second_dbt_model
[0m23:51:30.073406 [info ] [Thread-4  ]: 3 of 3 START sql view model PUBLIC.my_second_dbt_model ......................... [RUN]
[0m23:51:30.074056 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.banxware_assignment.my_second_dbt_model'
[0m23:51:30.074489 [debug] [Thread-4  ]: Began compiling node model.banxware_assignment.my_second_dbt_model
[0m23:51:30.078587 [debug] [Thread-4  ]: Writing injected SQL for node "model.banxware_assignment.my_second_dbt_model"
[0m23:51:30.079341 [debug] [Thread-4  ]: Began executing node model.banxware_assignment.my_second_dbt_model
[0m23:51:30.100294 [debug] [Thread-4  ]: Writing runtime sql for node "model.banxware_assignment.my_second_dbt_model"
[0m23:51:30.101624 [debug] [Thread-4  ]: Using snowflake connection "model.banxware_assignment.my_second_dbt_model"
[0m23:51:30.101962 [debug] [Thread-4  ]: On model.banxware_assignment.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.my_second_dbt_model"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from HOME_ASSIGNMENT.PUBLIC.my_first_dbt_model
where id = 1
  );
[0m23:51:30.102259 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:51:30.540320 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.438 seconds
[0m23:51:30.546276 [debug] [Thread-4  ]: On model.banxware_assignment.my_second_dbt_model: Close
[0m23:51:30.640035 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdfa3d24-93f2-4eb7-80f7-10ce0fcd47c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a791f40>]}
[0m23:51:30.641803 [info ] [Thread-4  ]: 3 of 3 OK created sql view model PUBLIC.my_second_dbt_model .................... [[32mSUCCESS 1[0m in 0.57s]
[0m23:51:30.643180 [debug] [Thread-4  ]: Finished running node model.banxware_assignment.my_second_dbt_model
[0m23:51:30.645056 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:51:30.645543 [debug] [MainThread]: Connection 'model.banxware_assignment.my_first_dbt_model' was properly closed.
[0m23:51:30.645956 [debug] [MainThread]: Connection 'model.banxware_assignment.transformed_sales_data' was properly closed.
[0m23:51:30.646351 [debug] [MainThread]: Connection 'model.banxware_assignment.my_second_dbt_model' was properly closed.
[0m23:51:30.646897 [info ] [MainThread]: 
[0m23:51:30.647390 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 2.56 seconds (2.56s).
[0m23:51:30.648791 [debug] [MainThread]: Command end result
[0m23:51:30.688165 [info ] [MainThread]: 
[0m23:51:30.688590 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:51:30.688848 [info ] [MainThread]: 
[0m23:51:30.689177 [error] [MainThread]:   Database Error in model transformed_sales_data (models/example/transformed_sales_data.sql)
  100097 (22007): Can't parse '4/13/2023' as date with format 'YYYY-MM-DD'
  compiled Code at target/run/banxware_assignment/models/example/transformed_sales_data.sql
[0m23:51:30.689432 [info ] [MainThread]: 
[0m23:51:30.689693 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:51:30.692685 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.4686728, "process_user_time": 4.733617, "process_kernel_time": 0.460744, "process_mem_max_rss": "198180864", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:51:30.693143 [debug] [MainThread]: Command `dbt run` failed at 23:51:30.693063 after 4.47 seconds
[0m23:51:30.693468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10502d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052696a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b23c10>]}
[0m23:51:30.693787 [debug] [MainThread]: Flushing usage events
[0m23:52:56.745242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048424f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106978cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069782e0>]}


============================== 23:52:56.749423 | c75b6181-4dad-4a1c-9916-e7c33b469c57 ==============================
[0m23:52:56.749423 [info ] [MainThread]: Running with dbt=1.8.6
[0m23:52:56.749936 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/neerajchauhan/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:52:57.937026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c75b6181-4dad-4a1c-9916-e7c33b469c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10692fa00>]}
[0m23:52:57.997278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c75b6181-4dad-4a1c-9916-e7c33b469c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067fed30>]}
[0m23:52:57.998831 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:52:58.015895 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m23:52:58.154363 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:52:58.154964 [debug] [MainThread]: Partial parsing: updated file: banxware_assignment://models/example/transformed_sales_data.sql
[0m23:52:58.452584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c75b6181-4dad-4a1c-9916-e7c33b469c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e8ede80>]}
[0m23:52:58.550923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c75b6181-4dad-4a1c-9916-e7c33b469c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e8e9550>]}
[0m23:52:58.551426 [info ] [MainThread]: Found 3 models, 2 seeds, 4 data tests, 448 macros
[0m23:52:58.551732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c75b6181-4dad-4a1c-9916-e7c33b469c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e92cc10>]}
[0m23:52:58.552923 [info ] [MainThread]: 
[0m23:52:58.553376 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:52:58.557308 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOME_ASSIGNMENT'
[0m23:52:58.569464 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT"
[0m23:52:58.569773 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT"} */
show terse schemas in database HOME_ASSIGNMENT
    limit 10000
[0m23:52:58.570029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:53:01.138265 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.568 seconds
[0m23:53:01.141951 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: Close
[0m23:53:01.245715 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT, now list_HOME_ASSIGNMENT_PUBLIC)
[0m23:53:01.261442 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT_PUBLIC"
[0m23:53:01.261947 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT_PUBLIC"} */
show objects in HOME_ASSIGNMENT.PUBLIC limit 10000
[0m23:53:01.262359 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:53:01.817295 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.555 seconds
[0m23:53:01.824194 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: Close
[0m23:53:01.920006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c75b6181-4dad-4a1c-9916-e7c33b469c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e8d45e0>]}
[0m23:53:01.921376 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:53:01.922089 [info ] [MainThread]: 
[0m23:53:01.926200 [debug] [Thread-1  ]: Began running node model.banxware_assignment.my_first_dbt_model
[0m23:53:01.926910 [debug] [Thread-2  ]: Began running node model.banxware_assignment.transformed_sales_data
[0m23:53:01.927756 [info ] [Thread-1  ]: 1 of 3 START sql table model PUBLIC.my_first_dbt_model ......................... [RUN]
[0m23:53:01.928563 [info ] [Thread-2  ]: 2 of 3 START sql table model PUBLIC.transformed_sales_data ..................... [RUN]
[0m23:53:01.929267 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT_PUBLIC, now model.banxware_assignment.my_first_dbt_model)
[0m23:53:01.931894 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.banxware_assignment.transformed_sales_data'
[0m23:53:01.932464 [debug] [Thread-1  ]: Began compiling node model.banxware_assignment.my_first_dbt_model
[0m23:53:01.933003 [debug] [Thread-2  ]: Began compiling node model.banxware_assignment.transformed_sales_data
[0m23:53:01.944784 [debug] [Thread-1  ]: Writing injected SQL for node "model.banxware_assignment.my_first_dbt_model"
[0m23:53:01.948506 [debug] [Thread-2  ]: Writing injected SQL for node "model.banxware_assignment.transformed_sales_data"
[0m23:53:01.950014 [debug] [Thread-1  ]: Began executing node model.banxware_assignment.my_first_dbt_model
[0m23:53:01.950433 [debug] [Thread-2  ]: Began executing node model.banxware_assignment.transformed_sales_data
[0m23:53:01.997845 [debug] [Thread-1  ]: Writing runtime sql for node "model.banxware_assignment.my_first_dbt_model"
[0m23:53:01.998411 [debug] [Thread-2  ]: Writing runtime sql for node "model.banxware_assignment.transformed_sales_data"
[0m23:53:01.999569 [debug] [Thread-1  ]: Using snowflake connection "model.banxware_assignment.my_first_dbt_model"
[0m23:53:02.001137 [debug] [Thread-2  ]: Using snowflake connection "model.banxware_assignment.transformed_sales_data"
[0m23:53:02.001504 [debug] [Thread-1  ]: On model.banxware_assignment.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.my_first_dbt_model"} */
create or replace transient table HOME_ASSIGNMENT.PUBLIC.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m23:53:02.001927 [debug] [Thread-2  ]: On model.banxware_assignment.transformed_sales_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.transformed_sales_data"} */
create or replace transient table HOME_ASSIGNMENT.PUBLIC.transformed_sales_data
         as
        (-- models/transformed_sales_data.sql



WITH raw_data AS (
    SELECT
        ORDER_ID AS order_id,
        ORDER_DATE AS order_date,
        CUSTOMER_ID AS customer_id,
        PRODUCT_ID AS product_id,
        PRODUCT_NAME AS product_name,
        QUANTITY AS quantity,
        PRICE AS price,
        ORDER_STATUS AS order_status
    FROM HOME_ASSIGNMENT.PUBLIC.raw_sales_data
),

-- Extract year, month, and day from order_date
extracted_date AS (
    SELECT
        order_id,
        order_date,
        customer_id,
        product_id,
        product_name,
        quantity,
        price,
        order_status,
        EXTRACT(YEAR FROM TO_DATE(order_date, 'MM/DD/YYYY')) AS order_year,
        EXTRACT(MONTH FROM TO_DATE(order_date, 'MM/DD/YYYY')) AS order_month,
        EXTRACT(DAY FROM TO_DATE(order_date, 'MM/DD/YYYY')) AS order_day
    FROM raw_data
),

-- Calculate total sales amount for each order
aggregated_data AS (
    SELECT
        order_id,
        customer_id,
        order_year,
        order_month,
        order_day,
        SUM(quantity * price) AS total_sales_amount
    FROM extracted_date
    GROUP BY
        order_id,
        customer_id,
        order_year,
        order_month,
        order_day
)

SELECT * FROM aggregated_data
        );
[0m23:53:02.002290 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:53:02.002566 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:53:02.758507 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.756 seconds
[0m23:53:02.795661 [debug] [Thread-1  ]: On model.banxware_assignment.my_first_dbt_model: Close
[0m23:53:02.863500 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c75b6181-4dad-4a1c-9916-e7c33b469c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106638c40>]}
[0m23:53:02.864632 [info ] [Thread-1  ]: 1 of 3 OK created sql table model PUBLIC.my_first_dbt_model .................... [[32mSUCCESS 1[0m in 0.93s]
[0m23:53:02.865557 [debug] [Thread-1  ]: Finished running node model.banxware_assignment.my_first_dbt_model
[0m23:53:02.866279 [debug] [Thread-4  ]: Began running node model.banxware_assignment.my_second_dbt_model
[0m23:53:02.866884 [info ] [Thread-4  ]: 3 of 3 START sql view model PUBLIC.my_second_dbt_model ......................... [RUN]
[0m23:53:02.867525 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.banxware_assignment.my_second_dbt_model'
[0m23:53:02.867977 [debug] [Thread-4  ]: Began compiling node model.banxware_assignment.my_second_dbt_model
[0m23:53:02.872110 [debug] [Thread-4  ]: Writing injected SQL for node "model.banxware_assignment.my_second_dbt_model"
[0m23:53:02.873084 [debug] [Thread-4  ]: Began executing node model.banxware_assignment.my_second_dbt_model
[0m23:53:02.895952 [debug] [Thread-4  ]: Writing runtime sql for node "model.banxware_assignment.my_second_dbt_model"
[0m23:53:02.896903 [debug] [Thread-4  ]: Using snowflake connection "model.banxware_assignment.my_second_dbt_model"
[0m23:53:02.897262 [debug] [Thread-4  ]: On model.banxware_assignment.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.my_second_dbt_model"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from HOME_ASSIGNMENT.PUBLIC.my_first_dbt_model
where id = 1
  );
[0m23:53:02.897562 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:53:03.109370 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.106 seconds
[0m23:53:03.114748 [debug] [Thread-2  ]: On model.banxware_assignment.transformed_sales_data: Close
[0m23:53:03.202284 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c75b6181-4dad-4a1c-9916-e7c33b469c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14eb3ac40>]}
[0m23:53:03.204274 [info ] [Thread-2  ]: 2 of 3 OK created sql table model PUBLIC.transformed_sales_data ................ [[32mSUCCESS 1[0m in 1.27s]
[0m23:53:03.205729 [debug] [Thread-2  ]: Finished running node model.banxware_assignment.transformed_sales_data
[0m23:53:03.276583 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.379 seconds
[0m23:53:03.279842 [debug] [Thread-4  ]: On model.banxware_assignment.my_second_dbt_model: Close
[0m23:53:03.356493 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c75b6181-4dad-4a1c-9916-e7c33b469c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14eb33070>]}
[0m23:53:03.357889 [info ] [Thread-4  ]: 3 of 3 OK created sql view model PUBLIC.my_second_dbt_model .................... [[32mSUCCESS 1[0m in 0.49s]
[0m23:53:03.359041 [debug] [Thread-4  ]: Finished running node model.banxware_assignment.my_second_dbt_model
[0m23:53:03.360837 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:53:03.361340 [debug] [MainThread]: Connection 'model.banxware_assignment.my_first_dbt_model' was properly closed.
[0m23:53:03.361759 [debug] [MainThread]: Connection 'model.banxware_assignment.transformed_sales_data' was properly closed.
[0m23:53:03.362149 [debug] [MainThread]: Connection 'model.banxware_assignment.my_second_dbt_model' was properly closed.
[0m23:53:03.362701 [info ] [MainThread]: 
[0m23:53:03.363217 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 4.81 seconds (4.81s).
[0m23:53:03.364623 [debug] [MainThread]: Command end result
[0m23:53:03.403583 [info ] [MainThread]: 
[0m23:53:03.404082 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:53:03.404355 [info ] [MainThread]: 
[0m23:53:03.404624 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:53:03.407013 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.730031, "process_user_time": 4.847019, "process_kernel_time": 0.41788, "process_mem_max_rss": "198836224", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:53:03.407404 [debug] [MainThread]: Command `dbt run` succeeded at 23:53:03.407330 after 6.73 seconds
[0m23:53:03.407706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048424f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10636ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b2071c0>]}
[0m23:53:03.408008 [debug] [MainThread]: Flushing usage events
[0m23:53:36.457867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d7a550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ebc280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ebce50>]}


============================== 23:53:36.461980 | 153116b6-c1c0-49fd-98c6-fb35e1bc618a ==============================
[0m23:53:36.461980 [info ] [MainThread]: Running with dbt=1.8.6
[0m23:53:36.462545 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/neerajchauhan/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:53:37.549401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '153116b6-c1c0-49fd-98c6-fb35e1bc618a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fed6a0>]}
[0m23:53:37.609180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '153116b6-c1c0-49fd-98c6-fb35e1bc618a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bc33520>]}
[0m23:53:37.610305 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:53:37.626803 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m23:53:37.762928 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:53:37.763351 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:53:37.858528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '153116b6-c1c0-49fd-98c6-fb35e1bc618a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bcea0a0>]}
[0m23:53:37.958913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '153116b6-c1c0-49fd-98c6-fb35e1bc618a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bf88d60>]}
[0m23:53:37.959417 [info ] [MainThread]: Found 3 models, 2 seeds, 4 data tests, 448 macros
[0m23:53:37.959721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '153116b6-c1c0-49fd-98c6-fb35e1bc618a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bd64670>]}
[0m23:53:37.961015 [info ] [MainThread]: 
[0m23:53:37.961480 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:53:37.965316 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOME_ASSIGNMENT'
[0m23:53:37.978604 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT"
[0m23:53:37.978928 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT"} */
show terse schemas in database HOME_ASSIGNMENT
    limit 10000
[0m23:53:37.979192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:53:38.347584 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.368 seconds
[0m23:53:38.350487 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: Close
[0m23:53:38.778001 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT, now list_HOME_ASSIGNMENT_PUBLIC)
[0m23:53:38.794008 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT_PUBLIC"
[0m23:53:38.794517 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT_PUBLIC"} */
show objects in HOME_ASSIGNMENT.PUBLIC limit 10000
[0m23:53:38.794909 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:53:39.159181 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.364 seconds
[0m23:53:39.164830 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: Close
[0m23:53:39.267899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '153116b6-c1c0-49fd-98c6-fb35e1bc618a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12be07910>]}
[0m23:53:39.269221 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:53:39.269886 [info ] [MainThread]: 
[0m23:53:39.274185 [debug] [Thread-1  ]: Began running node seed.banxware_assignment.customers
[0m23:53:39.274870 [debug] [Thread-2  ]: Began running node seed.banxware_assignment.sales
[0m23:53:39.275677 [info ] [Thread-1  ]: 1 of 2 START seed file PUBLIC.raw_customer_data ................................ [RUN]
[0m23:53:39.276456 [info ] [Thread-2  ]: 2 of 2 START seed file PUBLIC.raw_sales_data ................................... [RUN]
[0m23:53:39.277164 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT_PUBLIC, now seed.banxware_assignment.customers)
[0m23:53:39.278307 [debug] [Thread-2  ]: Acquiring new snowflake connection 'seed.banxware_assignment.sales'
[0m23:53:39.278851 [debug] [Thread-1  ]: Began compiling node seed.banxware_assignment.customers
[0m23:53:39.279378 [debug] [Thread-2  ]: Began compiling node seed.banxware_assignment.sales
[0m23:53:39.279902 [debug] [Thread-1  ]: Began executing node seed.banxware_assignment.customers
[0m23:53:39.280396 [debug] [Thread-2  ]: Began executing node seed.banxware_assignment.sales
[0m23:53:39.337508 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:53:39.337926 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
BEGIN
[0m23:53:39.341433 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:53:39.341746 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:53:39.342064 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
BEGIN
[0m23:53:39.342979 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:53:39.730074 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.386 seconds
[0m23:53:39.732352 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:53:39.733464 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
truncate table "HOME_ASSIGNMENT"."PUBLIC"."RAW_CUSTOMER_DATA"
  ;
[0m23:53:39.788476 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.446 seconds
[0m23:53:39.790143 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:53:39.791363 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
truncate table "HOME_ASSIGNMENT"."PUBLIC"."RAW_SALES_DATA"
  ;
[0m23:53:39.978674 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.244 seconds
[0m23:53:39.980794 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:53:39.982080 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
COMMIT
[0m23:53:40.103984 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.311 seconds
[0m23:53:40.105586 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:53:40.106382 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
COMMIT
[0m23:53:40.236125 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.253 seconds
[0m23:53:40.260464 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:53:40.260977 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
BEGIN
[0m23:53:40.325112 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.218 seconds
[0m23:53:40.332660 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:53:40.333271 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
BEGIN
[0m23:53:40.417390 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.083 seconds
[0m23:53:40.425968 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:53:40.426737 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
insert into HOME_ASSIGNMENT.PUBLIC.raw_sales_data (order_id, order_date, customer_id, product_id, product_name, quantity, price, order_status) values
            (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%...
[0m23:53:40.480643 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.219 seconds
[0m23:53:40.483480 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:53:40.484212 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
insert into HOME_ASSIGNMENT.PUBLIC.raw_customer_data (id, name) values
            (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%...
[0m23:53:40.857996 [debug] [Thread-2  ]: SQL status: SUCCESS 100 in 0.430 seconds
[0m23:53:40.860692 [debug] [Thread-1  ]: SQL status: SUCCESS 60 in 0.376 seconds
[0m23:53:40.862010 [debug] [Thread-2  ]: Using snowflake connection "seed.banxware_assignment.sales"
[0m23:53:40.863082 [debug] [Thread-1  ]: Using snowflake connection "seed.banxware_assignment.customers"
[0m23:53:40.863830 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.sales"} */
COMMIT
[0m23:53:40.864530 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "seed.banxware_assignment.customers"} */
COMMIT
[0m23:53:41.086492 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.221 seconds
[0m23:53:41.099667 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.banxware_assignment.customers"
[0m23:53:41.101627 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.236 seconds
[0m23:53:41.102821 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.banxware_assignment.sales"
[0m23:53:41.129547 [debug] [Thread-1  ]: On seed.banxware_assignment.customers: Close
[0m23:53:41.131563 [debug] [Thread-2  ]: On seed.banxware_assignment.sales: Close
[0m23:53:41.222606 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '153116b6-c1c0-49fd-98c6-fb35e1bc618a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c286370>]}
[0m23:53:41.223523 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '153116b6-c1c0-49fd-98c6-fb35e1bc618a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c3bd4c0>]}
[0m23:53:41.224346 [info ] [Thread-1  ]: 1 of 2 OK loaded seed file PUBLIC.raw_customer_data ............................ [[32mINSERT 60[0m in 1.94s]
[0m23:53:41.225124 [info ] [Thread-2  ]: 2 of 2 OK loaded seed file PUBLIC.raw_sales_data ............................... [[32mINSERT 100[0m in 1.95s]
[0m23:53:41.225929 [debug] [Thread-1  ]: Finished running node seed.banxware_assignment.customers
[0m23:53:41.226601 [debug] [Thread-2  ]: Finished running node seed.banxware_assignment.sales
[0m23:53:41.228129 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:53:41.228515 [debug] [MainThread]: Connection 'seed.banxware_assignment.customers' was properly closed.
[0m23:53:41.228846 [debug] [MainThread]: Connection 'seed.banxware_assignment.sales' was properly closed.
[0m23:53:41.229270 [info ] [MainThread]: 
[0m23:53:41.229684 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 3.27 seconds (3.27s).
[0m23:53:41.230657 [debug] [MainThread]: Command end result
[0m23:53:41.265509 [info ] [MainThread]: 
[0m23:53:41.266111 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:53:41.266390 [info ] [MainThread]: 
[0m23:53:41.266657 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:53:41.269253 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 4.8786716, "process_user_time": 4.644992, "process_kernel_time": 0.408726, "process_mem_max_rss": "192004096", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:53:41.269691 [debug] [MainThread]: Command `dbt seed` succeeded at 23:53:41.269612 after 4.88 seconds
[0m23:53:41.270011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d7a550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082c6a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10889fdc0>]}
[0m23:53:41.270330 [debug] [MainThread]: Flushing usage events
[0m00:07:02.495469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10738e4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109500df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109500190>]}


============================== 00:07:02.499884 | 56afadba-d5f1-4794-bfce-fcb738f61ebf ==============================
[0m00:07:02.499884 [info ] [MainThread]: Running with dbt=1.8.6
[0m00:07:02.500378 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/neerajchauhan/.dbt', 'log_path': '/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --models queries/top_5_products_2023', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:07:03.678748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56afadba-d5f1-4794-bfce-fcb738f61ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fe5f9a0>]}
[0m00:07:03.739171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56afadba-d5f1-4794-bfce-fcb738f61ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091c45e0>]}
[0m00:07:03.740720 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m00:07:03.757934 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m00:07:03.897947 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m00:07:03.898474 [debug] [MainThread]: Partial parsing: added file: banxware_assignment://models/queries/top_customer_october_2023.sql
[0m00:07:03.898778 [debug] [MainThread]: Partial parsing: added file: banxware_assignment://models/queries/avg_order_value_by_month_2023.sql
[0m00:07:03.899053 [debug] [MainThread]: Partial parsing: added file: banxware_assignment://models/queries/top_5_customers_2023.sql
[0m00:07:03.899318 [debug] [MainThread]: Partial parsing: added file: banxware_assignment://models/queries/top_5_products_2023.sql
[0m00:07:04.203669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56afadba-d5f1-4794-bfce-fcb738f61ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123c55130>]}
[0m00:07:04.304093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56afadba-d5f1-4794-bfce-fcb738f61ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ca5280>]}
[0m00:07:04.304584 [info ] [MainThread]: Found 7 models, 2 seeds, 4 data tests, 448 macros
[0m00:07:04.304884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56afadba-d5f1-4794-bfce-fcb738f61ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123cc9400>]}
[0m00:07:04.305551 [warn ] [MainThread]: The selection criterion 'queries/top_5_products_2023' does not match any enabled nodes
[0m00:07:04.306245 [info ] [MainThread]: 
[0m00:07:04.306514 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:07:04.306897 [debug] [MainThread]: Command end result
[0m00:07:04.336065 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9099708, "process_user_time": 4.22508, "process_kernel_time": 0.413706, "process_mem_max_rss": "189956096", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:07:04.336533 [debug] [MainThread]: Command `dbt run` succeeded at 00:07:04.336456 after 1.91 seconds
[0m00:07:04.336849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10738e4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123b4a670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fef0850>]}
[0m00:07:04.337157 [debug] [MainThread]: Flushing usage events
[0m00:07:14.674645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d61430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e9cd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e9c130>]}


============================== 00:07:14.678874 | 7eca3ccc-8b38-41ef-9934-095d6188ddbd ==============================
[0m00:07:14.678874 [info ] [MainThread]: Running with dbt=1.8.6
[0m00:07:14.679381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/neerajchauhan/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models queries/top_5_products_2023.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:07:15.590200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7eca3ccc-8b38-41ef-9934-095d6188ddbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133afb640>]}
[0m00:07:15.650279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7eca3ccc-8b38-41ef-9934-095d6188ddbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ccd160>]}
[0m00:07:15.651700 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m00:07:15.668120 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m00:07:15.805560 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:07:15.805981 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:07:15.903572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7eca3ccc-8b38-41ef-9934-095d6188ddbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e16820>]}
[0m00:07:16.002091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7eca3ccc-8b38-41ef-9934-095d6188ddbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1352b6a60>]}
[0m00:07:16.002585 [info ] [MainThread]: Found 7 models, 2 seeds, 4 data tests, 448 macros
[0m00:07:16.002887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7eca3ccc-8b38-41ef-9934-095d6188ddbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13529d2e0>]}
[0m00:07:16.003585 [warn ] [MainThread]: The selection criterion 'queries/top_5_products_2023.sql' does not match any enabled nodes
[0m00:07:16.004314 [info ] [MainThread]: 
[0m00:07:16.004600 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:07:16.006162 [debug] [MainThread]: Command end result
[0m00:07:16.035083 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4345981, "process_user_time": 3.897124, "process_kernel_time": 0.29775, "process_mem_max_rss": "183304192", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:07:16.035540 [debug] [MainThread]: Command `dbt run` succeeded at 00:07:16.035459 after 1.44 seconds
[0m00:07:16.035860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d61430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10488f910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10428ffa0>]}
[0m00:07:16.036168 [debug] [MainThread]: Flushing usage events
[0m00:07:46.540858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105239520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073acd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073ac280>]}


============================== 00:07:46.545012 | 8998e6aa-23e6-4579-99e6-1fb7149e3340 ==============================
[0m00:07:46.545012 [info ] [MainThread]: Running with dbt=1.8.6
[0m00:07:46.545536 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs', 'profiles_dir': '/Users/neerajchauhan/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --models queries', 'send_anonymous_usage_stats': 'True'}
[0m00:07:47.831620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8998e6aa-23e6-4579-99e6-1fb7149e3340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106165580>]}
[0m00:07:47.890011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8998e6aa-23e6-4579-99e6-1fb7149e3340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1323b0280>]}
[0m00:07:47.891421 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m00:07:47.908533 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m00:07:48.049037 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:07:48.049456 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:07:48.144056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8998e6aa-23e6-4579-99e6-1fb7149e3340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10722b070>]}
[0m00:07:48.243129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8998e6aa-23e6-4579-99e6-1fb7149e3340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13271d220>]}
[0m00:07:48.243610 [info ] [MainThread]: Found 7 models, 2 seeds, 4 data tests, 448 macros
[0m00:07:48.243916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8998e6aa-23e6-4579-99e6-1fb7149e3340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107362700>]}
[0m00:07:48.245092 [info ] [MainThread]: 
[0m00:07:48.245549 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:07:48.249506 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOME_ASSIGNMENT'
[0m00:07:48.262681 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT"
[0m00:07:48.262995 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT"} */
show terse schemas in database HOME_ASSIGNMENT
    limit 10000
[0m00:07:48.263263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:48.769674 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.506 seconds
[0m00:07:48.773880 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: Close
[0m00:07:48.864121 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT, now list_HOME_ASSIGNMENT_PUBLIC)
[0m00:07:48.881009 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT_PUBLIC"
[0m00:07:48.881525 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT_PUBLIC"} */
show objects in HOME_ASSIGNMENT.PUBLIC limit 10000
[0m00:07:48.881934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:07:49.278217 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.396 seconds
[0m00:07:49.283367 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: Close
[0m00:07:49.370940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8998e6aa-23e6-4579-99e6-1fb7149e3340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132376f70>]}
[0m00:07:49.371960 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:07:49.372475 [info ] [MainThread]: 
[0m00:07:49.376160 [debug] [Thread-1  ]: Began running node model.banxware_assignment.avg_order_value_by_month_2023
[0m00:07:49.376830 [debug] [Thread-2  ]: Began running node model.banxware_assignment.top_5_customers_2023
[0m00:07:49.377370 [debug] [Thread-3  ]: Began running node model.banxware_assignment.top_5_products_2023
[0m00:07:49.378144 [debug] [Thread-4  ]: Began running node model.banxware_assignment.top_customer_october_2023
[0m00:07:49.378774 [info ] [Thread-1  ]: 1 of 4 START sql view model PUBLIC.avg_order_value_by_month_2023 ............... [RUN]
[0m00:07:49.379264 [info ] [Thread-2  ]: 2 of 4 START sql view model PUBLIC.top_5_customers_2023 ........................ [RUN]
[0m00:07:49.379851 [info ] [Thread-3  ]: 3 of 4 START sql view model PUBLIC.top_5_products_2023 ......................... [RUN]
[0m00:07:49.380934 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT_PUBLIC, now model.banxware_assignment.avg_order_value_by_month_2023)
[0m00:07:49.380387 [info ] [Thread-4  ]: 4 of 4 START sql view model PUBLIC.top_customer_october_2023 ................... [RUN]
[0m00:07:49.381556 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.banxware_assignment.top_5_customers_2023'
[0m00:07:49.382040 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.banxware_assignment.top_5_products_2023'
[0m00:07:49.382427 [debug] [Thread-1  ]: Began compiling node model.banxware_assignment.avg_order_value_by_month_2023
[0m00:07:49.382896 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.banxware_assignment.top_customer_october_2023'
[0m00:07:49.383272 [debug] [Thread-2  ]: Began compiling node model.banxware_assignment.top_5_customers_2023
[0m00:07:49.383633 [debug] [Thread-3  ]: Began compiling node model.banxware_assignment.top_5_products_2023
[0m00:07:49.394410 [debug] [Thread-1  ]: Writing injected SQL for node "model.banxware_assignment.avg_order_value_by_month_2023"
[0m00:07:49.394896 [debug] [Thread-4  ]: Began compiling node model.banxware_assignment.top_customer_october_2023
[0m00:07:49.398974 [debug] [Thread-2  ]: Writing injected SQL for node "model.banxware_assignment.top_5_customers_2023"
[0m00:07:49.402158 [debug] [Thread-3  ]: Writing injected SQL for node "model.banxware_assignment.top_5_products_2023"
[0m00:07:49.405464 [debug] [Thread-4  ]: Writing injected SQL for node "model.banxware_assignment.top_customer_october_2023"
[0m00:07:49.406666 [debug] [Thread-1  ]: Began executing node model.banxware_assignment.avg_order_value_by_month_2023
[0m00:07:49.407077 [debug] [Thread-2  ]: Began executing node model.banxware_assignment.top_5_customers_2023
[0m00:07:49.407466 [debug] [Thread-3  ]: Began executing node model.banxware_assignment.top_5_products_2023
[0m00:07:49.407840 [debug] [Thread-4  ]: Began executing node model.banxware_assignment.top_customer_october_2023
[0m00:07:49.437337 [debug] [Thread-2  ]: Writing runtime sql for node "model.banxware_assignment.top_5_customers_2023"
[0m00:07:49.438932 [debug] [Thread-1  ]: Writing runtime sql for node "model.banxware_assignment.avg_order_value_by_month_2023"
[0m00:07:49.441623 [debug] [Thread-3  ]: Writing runtime sql for node "model.banxware_assignment.top_5_products_2023"
[0m00:07:49.444254 [debug] [Thread-4  ]: Writing runtime sql for node "model.banxware_assignment.top_customer_october_2023"
[0m00:07:49.445590 [debug] [Thread-3  ]: Using snowflake connection "model.banxware_assignment.top_5_products_2023"
[0m00:07:49.446302 [debug] [Thread-1  ]: Using snowflake connection "model.banxware_assignment.avg_order_value_by_month_2023"
[0m00:07:49.447087 [debug] [Thread-2  ]: Using snowflake connection "model.banxware_assignment.top_5_customers_2023"
[0m00:07:49.447775 [debug] [Thread-4  ]: Using snowflake connection "model.banxware_assignment.top_customer_october_2023"
[0m00:07:49.448078 [debug] [Thread-3  ]: On model.banxware_assignment.top_5_products_2023: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.top_5_products_2023"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.top_5_products_2023
  
   as (
    -- queries/top_5_products_2023.sql

SELECT 
    product_name,
    SUM(total_sales_amount) AS total_sales
FROM HOME_ASSIGNMENT.PUBLIC.transformed_sales_data
WHERE order_year = 2023
GROUP BY product_name
ORDER BY total_sales DESC
LIMIT 5;
[0m00:07:49.448417 [debug] [Thread-1  ]: On model.banxware_assignment.avg_order_value_by_month_2023: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.avg_order_value_by_month_2023"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.avg_order_value_by_month_2023
  
   as (
    -- queries/avg_order_value_by_month_2023.sql

SELECT 
    order_month,
    AVG(total_sales_amount) AS avg_order_value
FROM HOME_ASSIGNMENT.PUBLIC.transformed_sales_data
WHERE order_year = 2023
GROUP BY order_month
ORDER BY order_month;
[0m00:07:49.448753 [debug] [Thread-2  ]: On model.banxware_assignment.top_5_customers_2023: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.top_5_customers_2023"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.top_5_customers_2023
  
   as (
    -- queries/top_5_customers_2023.sql

SELECT 
    c.customer_name,
    SUM(t.total_sales_amount) AS total_sales
FROM HOME_ASSIGNMENT.PUBLIC.transformed_sales_data t
JOIN HOME_ASSIGNMENT.PUBLIC.raw_customer_data c ON t.customer_id = c.customer_id
WHERE t.order_year = 2023
GROUP BY c.customer_name
ORDER BY total_sales DESC
LIMIT 5;
[0m00:07:49.449123 [debug] [Thread-4  ]: On model.banxware_assignment.top_customer_october_2023: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.top_customer_october_2023"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.top_customer_october_2023
  
   as (
    -- queries/top_customer_october_2023.sql

SELECT 
    customer_id,
    COUNT(order_id) AS order_volume
FROM HOME_ASSIGNMENT.PUBLIC.transformed_sales_data
WHERE order_year = 2023
AND order_month = 10
GROUP BY customer_id
ORDER BY order_volume DESC
LIMIT 1;
[0m00:07:49.449490 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m00:07:49.449798 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:07:49.450087 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m00:07:49.450373 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m00:07:49.859707 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01b6e6ef-0103-0760-0000-0002ef22b225
[0m00:07:49.860524 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 7 unexpected ';'.
[0m00:07:49.861292 [debug] [Thread-2  ]: On model.banxware_assignment.top_5_customers_2023: Close
[0m00:07:49.866286 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b6e6ef-0103-075f-0000-0002ef22d19d
[0m00:07:49.866826 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 12 at position 20 unexpected ';'.
[0m00:07:49.867417 [debug] [Thread-1  ]: On model.banxware_assignment.avg_order_value_by_month_2023: Close
[0m00:07:49.871963 [debug] [Thread-3  ]: Snowflake adapter: Snowflake query id: 01b6e6ef-0103-075e-0000-0002ef22e1d1
[0m00:07:49.872424 [debug] [Thread-3  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 7 unexpected ';'.
[0m00:07:49.873403 [debug] [Thread-3  ]: On model.banxware_assignment.top_5_products_2023: Close
[0m00:07:49.875383 [debug] [Thread-4  ]: Snowflake adapter: Snowflake query id: 01b6e6ef-0103-075d-0000-0002ef228b55
[0m00:07:49.875834 [debug] [Thread-4  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 7 unexpected ';'.
[0m00:07:49.876698 [debug] [Thread-4  ]: On model.banxware_assignment.top_customer_october_2023: Close
[0m00:07:49.949424 [debug] [Thread-2  ]: Database Error in model top_5_customers_2023 (models/queries/top_5_customers_2023.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 7 unexpected ';'.
  compiled Code at target/run/banxware_assignment/models/queries/top_5_customers_2023.sql
[0m00:07:49.951510 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8998e6aa-23e6-4579-99e6-1fb7149e3340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132376f70>]}
[0m00:07:49.952962 [error] [Thread-2  ]: 2 of 4 ERROR creating sql view model PUBLIC.top_5_customers_2023 ............... [[31mERROR[0m in 0.57s]
[0m00:07:49.953876 [debug] [Thread-2  ]: Finished running node model.banxware_assignment.top_5_customers_2023
[0m00:07:49.955670 [debug] [Thread-4  ]: Database Error in model top_customer_october_2023 (models/queries/top_customer_october_2023.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 7 unexpected ';'.
  compiled Code at target/run/banxware_assignment/models/queries/top_customer_october_2023.sql
[0m00:07:49.957329 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8998e6aa-23e6-4579-99e6-1fb7149e3340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067cf8b0>]}
[0m00:07:49.958288 [error] [Thread-4  ]: 4 of 4 ERROR creating sql view model PUBLIC.top_customer_october_2023 .......... [[31mERROR[0m in 0.57s]
[0m00:07:49.959158 [debug] [Thread-4  ]: Finished running node model.banxware_assignment.top_customer_october_2023
[0m00:07:49.961353 [debug] [Thread-1  ]: Database Error in model avg_order_value_by_month_2023 (models/queries/avg_order_value_by_month_2023.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 20 unexpected ';'.
  compiled Code at target/run/banxware_assignment/models/queries/avg_order_value_by_month_2023.sql
[0m00:07:49.961901 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8998e6aa-23e6-4579-99e6-1fb7149e3340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132700130>]}
[0m00:07:49.963070 [debug] [Thread-3  ]: Database Error in model top_5_products_2023 (models/queries/top_5_products_2023.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 7 unexpected ';'.
  compiled Code at target/run/banxware_assignment/models/queries/top_5_products_2023.sql
[0m00:07:49.963844 [error] [Thread-1  ]: 1 of 4 ERROR creating sql view model PUBLIC.avg_order_value_by_month_2023 ...... [[31mERROR[0m in 0.58s]
[0m00:07:49.964428 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8998e6aa-23e6-4579-99e6-1fb7149e3340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133190e20>]}
[0m00:07:49.965135 [debug] [Thread-1  ]: Finished running node model.banxware_assignment.avg_order_value_by_month_2023
[0m00:07:49.965807 [error] [Thread-3  ]: 3 of 4 ERROR creating sql view model PUBLIC.top_5_products_2023 ................ [[31mERROR[0m in 0.58s]
[0m00:07:49.966523 [debug] [Thread-3  ]: Finished running node model.banxware_assignment.top_5_products_2023
[0m00:07:49.967735 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:07:49.968061 [debug] [MainThread]: Connection 'model.banxware_assignment.avg_order_value_by_month_2023' was properly closed.
[0m00:07:49.968351 [debug] [MainThread]: Connection 'model.banxware_assignment.top_5_customers_2023' was properly closed.
[0m00:07:49.968625 [debug] [MainThread]: Connection 'model.banxware_assignment.top_5_products_2023' was properly closed.
[0m00:07:49.968892 [debug] [MainThread]: Connection 'model.banxware_assignment.top_customer_october_2023' was properly closed.
[0m00:07:49.969277 [info ] [MainThread]: 
[0m00:07:49.969626 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 1.72 seconds (1.72s).
[0m00:07:49.970762 [debug] [MainThread]: Command end result
[0m00:07:50.003032 [info ] [MainThread]: 
[0m00:07:50.003468 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m00:07:50.003734 [info ] [MainThread]: 
[0m00:07:50.004068 [error] [MainThread]:   Database Error in model top_5_customers_2023 (models/queries/top_5_customers_2023.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 7 unexpected ';'.
  compiled Code at target/run/banxware_assignment/models/queries/top_5_customers_2023.sql
[0m00:07:50.004326 [info ] [MainThread]: 
[0m00:07:50.004630 [error] [MainThread]:   Database Error in model top_customer_october_2023 (models/queries/top_customer_october_2023.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 7 unexpected ';'.
  compiled Code at target/run/banxware_assignment/models/queries/top_customer_october_2023.sql
[0m00:07:50.004879 [info ] [MainThread]: 
[0m00:07:50.005173 [error] [MainThread]:   Database Error in model avg_order_value_by_month_2023 (models/queries/avg_order_value_by_month_2023.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 20 unexpected ';'.
  compiled Code at target/run/banxware_assignment/models/queries/avg_order_value_by_month_2023.sql
[0m00:07:50.005413 [info ] [MainThread]: 
[0m00:07:50.005699 [error] [MainThread]:   Database Error in model top_5_products_2023 (models/queries/top_5_products_2023.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 7 unexpected ';'.
  compiled Code at target/run/banxware_assignment/models/queries/top_5_products_2023.sql
[0m00:07:50.005944 [info ] [MainThread]: 
[0m00:07:50.006215 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:07:50.008636 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.5400066, "process_user_time": 4.842115, "process_kernel_time": 0.577253, "process_mem_max_rss": "190185472", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:07:50.009063 [debug] [MainThread]: Command `dbt run` failed at 00:07:50.008985 after 3.54 seconds
[0m00:07:50.009383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105239520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106165580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106da7160>]}
[0m00:07:50.009693 [debug] [MainThread]: Flushing usage events
[0m00:08:26.644776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10727b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093fd610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093fda30>]}


============================== 00:08:26.649117 | a5345497-f6dd-4ac6-97b3-da6c2602fc01 ==============================
[0m00:08:26.649117 [info ] [MainThread]: Running with dbt=1.8.6
[0m00:08:26.649636 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/neerajchauhan/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models queries', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:08:27.904303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5345497-f6dd-4ac6-97b3-da6c2602fc01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b71ff70>]}
[0m00:08:27.967434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5345497-f6dd-4ac6-97b3-da6c2602fc01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b7c51f0>]}
[0m00:08:27.968476 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m00:08:27.985939 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m00:08:28.134954 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:08:28.135541 [debug] [MainThread]: Partial parsing: updated file: banxware_assignment://models/queries/top_5_products_2023.sql
[0m00:08:28.432680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5345497-f6dd-4ac6-97b3-da6c2602fc01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bc28fd0>]}
[0m00:08:28.532064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5345497-f6dd-4ac6-97b3-da6c2602fc01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bc4cca0>]}
[0m00:08:28.532553 [info ] [MainThread]: Found 7 models, 2 seeds, 4 data tests, 448 macros
[0m00:08:28.532852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5345497-f6dd-4ac6-97b3-da6c2602fc01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bbddd60>]}
[0m00:08:28.533975 [info ] [MainThread]: 
[0m00:08:28.534422 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:08:28.538393 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOME_ASSIGNMENT'
[0m00:08:28.550323 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT"
[0m00:08:28.550655 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT"} */
show terse schemas in database HOME_ASSIGNMENT
    limit 10000
[0m00:08:28.550906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:08:28.898758 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.348 seconds
[0m00:08:28.901581 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: Close
[0m00:08:28.980107 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT, now list_HOME_ASSIGNMENT_PUBLIC)
[0m00:08:28.995225 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT_PUBLIC"
[0m00:08:28.995740 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT_PUBLIC"} */
show objects in HOME_ASSIGNMENT.PUBLIC limit 10000
[0m00:08:28.996140 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:08:29.382967 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.387 seconds
[0m00:08:29.388616 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: Close
[0m00:08:29.490089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5345497-f6dd-4ac6-97b3-da6c2602fc01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107543910>]}
[0m00:08:29.491484 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:08:29.492189 [info ] [MainThread]: 
[0m00:08:29.496635 [debug] [Thread-1  ]: Began running node model.banxware_assignment.avg_order_value_by_month_2023
[0m00:08:29.497344 [debug] [Thread-2  ]: Began running node model.banxware_assignment.top_5_customers_2023
[0m00:08:29.498197 [info ] [Thread-1  ]: 1 of 4 START sql view model PUBLIC.avg_order_value_by_month_2023 ............... [RUN]
[0m00:08:29.498946 [debug] [Thread-3  ]: Began running node model.banxware_assignment.top_5_products_2023
[0m00:08:29.499988 [debug] [Thread-4  ]: Began running node model.banxware_assignment.top_customer_october_2023
[0m00:08:29.500754 [info ] [Thread-2  ]: 2 of 4 START sql view model PUBLIC.top_5_customers_2023 ........................ [RUN]
[0m00:08:29.501493 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT_PUBLIC, now model.banxware_assignment.avg_order_value_by_month_2023)
[0m00:08:29.502283 [info ] [Thread-3  ]: 3 of 4 START sql view model PUBLIC.top_5_products_2023 ......................... [RUN]
[0m00:08:29.503059 [info ] [Thread-4  ]: 4 of 4 START sql view model PUBLIC.top_customer_october_2023 ................... [RUN]
[0m00:08:29.503836 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.banxware_assignment.top_5_customers_2023'
[0m00:08:29.504348 [debug] [Thread-1  ]: Began compiling node model.banxware_assignment.avg_order_value_by_month_2023
[0m00:08:29.504948 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.banxware_assignment.top_5_products_2023'
[0m00:08:29.505499 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.banxware_assignment.top_customer_october_2023'
[0m00:08:29.505965 [debug] [Thread-2  ]: Began compiling node model.banxware_assignment.top_5_customers_2023
[0m00:08:29.518132 [debug] [Thread-1  ]: Writing injected SQL for node "model.banxware_assignment.avg_order_value_by_month_2023"
[0m00:08:29.518559 [debug] [Thread-3  ]: Began compiling node model.banxware_assignment.top_5_products_2023
[0m00:08:29.518973 [debug] [Thread-4  ]: Began compiling node model.banxware_assignment.top_customer_october_2023
[0m00:08:29.522551 [debug] [Thread-2  ]: Writing injected SQL for node "model.banxware_assignment.top_5_customers_2023"
[0m00:08:29.526160 [debug] [Thread-3  ]: Writing injected SQL for node "model.banxware_assignment.top_5_products_2023"
[0m00:08:29.529136 [debug] [Thread-4  ]: Writing injected SQL for node "model.banxware_assignment.top_customer_october_2023"
[0m00:08:29.529831 [debug] [Thread-1  ]: Began executing node model.banxware_assignment.avg_order_value_by_month_2023
[0m00:08:29.555467 [debug] [Thread-3  ]: Began executing node model.banxware_assignment.top_5_products_2023
[0m00:08:29.555908 [debug] [Thread-4  ]: Began executing node model.banxware_assignment.top_customer_october_2023
[0m00:08:29.557990 [debug] [Thread-1  ]: Writing runtime sql for node "model.banxware_assignment.avg_order_value_by_month_2023"
[0m00:08:29.558306 [debug] [Thread-2  ]: Began executing node model.banxware_assignment.top_5_customers_2023
[0m00:08:29.561142 [debug] [Thread-3  ]: Writing runtime sql for node "model.banxware_assignment.top_5_products_2023"
[0m00:08:29.563767 [debug] [Thread-4  ]: Writing runtime sql for node "model.banxware_assignment.top_customer_october_2023"
[0m00:08:29.566503 [debug] [Thread-2  ]: Writing runtime sql for node "model.banxware_assignment.top_5_customers_2023"
[0m00:08:29.567463 [debug] [Thread-1  ]: Using snowflake connection "model.banxware_assignment.avg_order_value_by_month_2023"
[0m00:08:29.567843 [debug] [Thread-1  ]: On model.banxware_assignment.avg_order_value_by_month_2023: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.avg_order_value_by_month_2023"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.avg_order_value_by_month_2023
  
   as (
    -- queries/avg_order_value_by_month_2023.sql

SELECT 
    order_month,
    AVG(total_sales_amount) AS avg_order_value
FROM HOME_ASSIGNMENT.PUBLIC.transformed_sales_data
WHERE order_year = 2023
GROUP BY order_month
ORDER BY order_month;
[0m00:08:29.568210 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:08:29.568883 [debug] [Thread-3  ]: Using snowflake connection "model.banxware_assignment.top_5_products_2023"
[0m00:08:29.569669 [debug] [Thread-4  ]: Using snowflake connection "model.banxware_assignment.top_customer_october_2023"
[0m00:08:29.570948 [debug] [Thread-2  ]: Using snowflake connection "model.banxware_assignment.top_5_customers_2023"
[0m00:08:29.571269 [debug] [Thread-3  ]: On model.banxware_assignment.top_5_products_2023: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.top_5_products_2023"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.top_5_products_2023
  
   as (
    -- queries/top_5_products_2023.sql

SELECT 
    product_name,
    SUM(total_sales_amount) AS total_sales
FROM HOME_ASSIGNMENT.PUBLIC.transformed_sales_data
WHERE order_year = 2023
GROUP BY product_name
ORDER BY total_sales DESC
LIMIT 5
  );
[0m00:08:29.571630 [debug] [Thread-4  ]: On model.banxware_assignment.top_customer_october_2023: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.top_customer_october_2023"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.top_customer_october_2023
  
   as (
    -- queries/top_customer_october_2023.sql

SELECT 
    customer_id,
    COUNT(order_id) AS order_volume
FROM HOME_ASSIGNMENT.PUBLIC.transformed_sales_data
WHERE order_year = 2023
AND order_month = 10
GROUP BY customer_id
ORDER BY order_volume DESC
LIMIT 1;
[0m00:08:29.572832 [debug] [Thread-2  ]: On model.banxware_assignment.top_5_customers_2023: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.top_5_customers_2023"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.top_5_customers_2023
  
   as (
    -- queries/top_5_customers_2023.sql

SELECT 
    c.customer_name,
    SUM(t.total_sales_amount) AS total_sales
FROM HOME_ASSIGNMENT.PUBLIC.transformed_sales_data t
JOIN HOME_ASSIGNMENT.PUBLIC.raw_customer_data c ON t.customer_id = c.customer_id
WHERE t.order_year = 2023
GROUP BY c.customer_name
ORDER BY total_sales DESC
LIMIT 5;
[0m00:08:29.573270 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m00:08:29.573795 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m00:08:29.574089 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m00:08:29.933546 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b6e6f0-0103-0748-0000-0002ef22c1d5
[0m00:08:29.934522 [debug] [Thread-4  ]: Snowflake adapter: Snowflake query id: 01b6e6f0-0103-0748-0000-0002ef22c1d1
[0m00:08:29.935316 [debug] [Thread-3  ]: Snowflake adapter: Snowflake query id: 01b6e6f0-0103-0748-0000-0002ef22c1cd
[0m00:08:29.935817 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 12 at position 20 unexpected ';'.
[0m00:08:29.936335 [debug] [Thread-4  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 7 unexpected ';'.
[0m00:08:29.936852 [debug] [Thread-3  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 4
invalid identifier 'PRODUCT_NAME'
[0m00:08:29.937591 [debug] [Thread-1  ]: On model.banxware_assignment.avg_order_value_by_month_2023: Close
[0m00:08:29.938180 [debug] [Thread-4  ]: On model.banxware_assignment.top_customer_october_2023: Close
[0m00:08:29.939151 [debug] [Thread-3  ]: On model.banxware_assignment.top_5_products_2023: Close
[0m00:08:30.022018 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01b6e6f0-0103-075d-0000-0002ef228b61
[0m00:08:30.022777 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 7 unexpected ';'.
[0m00:08:30.023524 [debug] [Thread-2  ]: On model.banxware_assignment.top_5_customers_2023: Close
[0m00:08:30.030938 [debug] [Thread-4  ]: Database Error in model top_customer_october_2023 (models/queries/top_customer_october_2023.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 7 unexpected ';'.
  compiled Code at target/run/banxware_assignment/models/queries/top_customer_october_2023.sql
[0m00:08:30.033106 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5345497-f6dd-4ac6-97b3-da6c2602fc01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12be90850>]}
[0m00:08:30.034454 [error] [Thread-4  ]: 4 of 4 ERROR creating sql view model PUBLIC.top_customer_october_2023 .......... [[31mERROR[0m in 0.53s]
[0m00:08:30.035375 [debug] [Thread-4  ]: Finished running node model.banxware_assignment.top_customer_october_2023
[0m00:08:30.037762 [debug] [Thread-1  ]: Database Error in model avg_order_value_by_month_2023 (models/queries/avg_order_value_by_month_2023.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 20 unexpected ';'.
  compiled Code at target/run/banxware_assignment/models/queries/avg_order_value_by_month_2023.sql
[0m00:08:30.038513 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5345497-f6dd-4ac6-97b3-da6c2602fc01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bf7e2b0>]}
[0m00:08:30.039179 [error] [Thread-1  ]: 1 of 4 ERROR creating sql view model PUBLIC.avg_order_value_by_month_2023 ...... [[31mERROR[0m in 0.54s]
[0m00:08:30.039828 [debug] [Thread-1  ]: Finished running node model.banxware_assignment.avg_order_value_by_month_2023
[0m00:08:30.041048 [debug] [Thread-3  ]: Database Error in model top_5_products_2023 (models/queries/top_5_products_2023.sql)
  000904 (42000): SQL compilation error: error line 7 at position 4
  invalid identifier 'PRODUCT_NAME'
  compiled Code at target/run/banxware_assignment/models/queries/top_5_products_2023.sql
[0m00:08:30.041491 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5345497-f6dd-4ac6-97b3-da6c2602fc01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bdf82e0>]}
[0m00:08:30.042086 [error] [Thread-3  ]: 3 of 4 ERROR creating sql view model PUBLIC.top_5_products_2023 ................ [[31mERROR[0m in 0.54s]
[0m00:08:30.042689 [debug] [Thread-3  ]: Finished running node model.banxware_assignment.top_5_products_2023
[0m00:08:30.109175 [debug] [Thread-2  ]: Database Error in model top_5_customers_2023 (models/queries/top_5_customers_2023.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 7 unexpected ';'.
  compiled Code at target/run/banxware_assignment/models/queries/top_5_customers_2023.sql
[0m00:08:30.110085 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5345497-f6dd-4ac6-97b3-da6c2602fc01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bc4ce50>]}
[0m00:08:30.111080 [error] [Thread-2  ]: 2 of 4 ERROR creating sql view model PUBLIC.top_5_customers_2023 ............... [[31mERROR[0m in 0.61s]
[0m00:08:30.112010 [debug] [Thread-2  ]: Finished running node model.banxware_assignment.top_5_customers_2023
[0m00:08:30.113831 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:08:30.114299 [debug] [MainThread]: Connection 'model.banxware_assignment.avg_order_value_by_month_2023' was properly closed.
[0m00:08:30.114698 [debug] [MainThread]: Connection 'model.banxware_assignment.top_5_customers_2023' was properly closed.
[0m00:08:30.115083 [debug] [MainThread]: Connection 'model.banxware_assignment.top_5_products_2023' was properly closed.
[0m00:08:30.115468 [debug] [MainThread]: Connection 'model.banxware_assignment.top_customer_october_2023' was properly closed.
[0m00:08:30.116002 [info ] [MainThread]: 
[0m00:08:30.116499 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 1.58 seconds (1.58s).
[0m00:08:30.118095 [debug] [MainThread]: Command end result
[0m00:08:30.158082 [info ] [MainThread]: 
[0m00:08:30.158512 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m00:08:30.158771 [info ] [MainThread]: 
[0m00:08:30.159104 [error] [MainThread]:   Database Error in model top_customer_october_2023 (models/queries/top_customer_october_2023.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 7 unexpected ';'.
  compiled Code at target/run/banxware_assignment/models/queries/top_customer_october_2023.sql
[0m00:08:30.159362 [info ] [MainThread]: 
[0m00:08:30.159667 [error] [MainThread]:   Database Error in model avg_order_value_by_month_2023 (models/queries/avg_order_value_by_month_2023.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 20 unexpected ';'.
  compiled Code at target/run/banxware_assignment/models/queries/avg_order_value_by_month_2023.sql
[0m00:08:30.159915 [info ] [MainThread]: 
[0m00:08:30.160210 [error] [MainThread]:   Database Error in model top_5_products_2023 (models/queries/top_5_products_2023.sql)
  000904 (42000): SQL compilation error: error line 7 at position 4
  invalid identifier 'PRODUCT_NAME'
  compiled Code at target/run/banxware_assignment/models/queries/top_5_products_2023.sql
[0m00:08:30.160448 [info ] [MainThread]: 
[0m00:08:30.160729 [error] [MainThread]:   Database Error in model top_5_customers_2023 (models/queries/top_5_customers_2023.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 7 unexpected ';'.
  compiled Code at target/run/banxware_assignment/models/queries/top_5_customers_2023.sql
[0m00:08:30.160980 [info ] [MainThread]: 
[0m00:08:30.161240 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:08:30.163677 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.5872922, "process_user_time": 4.841104, "process_kernel_time": 0.611176, "process_mem_max_rss": "198049792", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:08:30.164062 [debug] [MainThread]: Command `dbt run` failed at 00:08:30.163992 after 3.59 seconds
[0m00:08:30.164365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10727b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b84d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108de79d0>]}
[0m00:08:30.164660 [debug] [MainThread]: Flushing usage events
[0m00:09:10.019088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de9430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108264d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108264130>]}


============================== 00:09:10.023334 | 35f3c94c-106f-4aef-ba7d-0bf491863b0b ==============================
[0m00:09:10.023334 [info ] [MainThread]: Running with dbt=1.8.6
[0m00:09:10.023838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/neerajchauhan/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --models queries', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:09:11.305435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35f3c94c-106f-4aef-ba7d-0bf491863b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b2dd640>]}
[0m00:09:11.365914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35f3c94c-106f-4aef-ba7d-0bf491863b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108095160>]}
[0m00:09:11.367490 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m00:09:11.386106 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m00:09:11.526899 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m00:09:11.527495 [debug] [MainThread]: Partial parsing: updated file: banxware_assignment://models/queries/top_5_customers_2023.sql
[0m00:09:11.527850 [debug] [MainThread]: Partial parsing: updated file: banxware_assignment://models/queries/avg_order_value_by_month_2023.sql
[0m00:09:11.528175 [debug] [MainThread]: Partial parsing: updated file: banxware_assignment://models/queries/top_customer_october_2023.sql
[0m00:09:11.831793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35f3c94c-106f-4aef-ba7d-0bf491863b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c301130>]}
[0m00:09:11.930675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35f3c94c-106f-4aef-ba7d-0bf491863b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c325e80>]}
[0m00:09:11.931180 [info ] [MainThread]: Found 7 models, 2 seeds, 4 data tests, 448 macros
[0m00:09:11.931486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35f3c94c-106f-4aef-ba7d-0bf491863b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c3018e0>]}
[0m00:09:11.932599 [info ] [MainThread]: 
[0m00:09:11.933047 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:09:11.937026 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOME_ASSIGNMENT'
[0m00:09:11.948908 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT"
[0m00:09:11.949229 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT"} */
show terse schemas in database HOME_ASSIGNMENT
    limit 10000
[0m00:09:11.949483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:09:12.300883 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.351 seconds
[0m00:09:12.306083 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: Close
[0m00:09:12.416473 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT, now list_HOME_ASSIGNMENT_PUBLIC)
[0m00:09:12.432722 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT_PUBLIC"
[0m00:09:12.433243 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT_PUBLIC"} */
show objects in HOME_ASSIGNMENT.PUBLIC limit 10000
[0m00:09:12.433645 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:09:12.815233 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.381 seconds
[0m00:09:12.820363 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: Close
[0m00:09:12.905676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35f3c94c-106f-4aef-ba7d-0bf491863b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b2dd340>]}
[0m00:09:12.907196 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:09:12.908040 [info ] [MainThread]: 
[0m00:09:12.911906 [debug] [Thread-1  ]: Began running node model.banxware_assignment.avg_order_value_by_month_2023
[0m00:09:12.912597 [debug] [Thread-2  ]: Began running node model.banxware_assignment.top_5_customers_2023
[0m00:09:12.913219 [debug] [Thread-3  ]: Began running node model.banxware_assignment.top_5_products_2023
[0m00:09:12.914603 [debug] [Thread-4  ]: Began running node model.banxware_assignment.top_customer_october_2023
[0m00:09:12.914081 [info ] [Thread-1  ]: 1 of 4 START sql view model PUBLIC.avg_order_value_by_month_2023 ............... [RUN]
[0m00:09:12.915914 [info ] [Thread-2  ]: 2 of 4 START sql view model PUBLIC.top_5_customers_2023 ........................ [RUN]
[0m00:09:12.916687 [info ] [Thread-3  ]: 3 of 4 START sql view model PUBLIC.top_5_products_2023 ......................... [RUN]
[0m00:09:12.917423 [info ] [Thread-4  ]: 4 of 4 START sql view model PUBLIC.top_customer_october_2023 ................... [RUN]
[0m00:09:12.918129 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT_PUBLIC, now model.banxware_assignment.avg_order_value_by_month_2023)
[0m00:09:12.918816 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.banxware_assignment.top_5_customers_2023'
[0m00:09:12.919389 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.banxware_assignment.top_5_products_2023'
[0m00:09:12.919960 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.banxware_assignment.top_customer_october_2023'
[0m00:09:12.920413 [debug] [Thread-1  ]: Began compiling node model.banxware_assignment.avg_order_value_by_month_2023
[0m00:09:12.920877 [debug] [Thread-2  ]: Began compiling node model.banxware_assignment.top_5_customers_2023
[0m00:09:12.921322 [debug] [Thread-3  ]: Began compiling node model.banxware_assignment.top_5_products_2023
[0m00:09:12.921746 [debug] [Thread-4  ]: Began compiling node model.banxware_assignment.top_customer_october_2023
[0m00:09:12.933192 [debug] [Thread-1  ]: Writing injected SQL for node "model.banxware_assignment.avg_order_value_by_month_2023"
[0m00:09:12.936740 [debug] [Thread-2  ]: Writing injected SQL for node "model.banxware_assignment.top_5_customers_2023"
[0m00:09:12.940129 [debug] [Thread-3  ]: Writing injected SQL for node "model.banxware_assignment.top_5_products_2023"
[0m00:09:12.942859 [debug] [Thread-4  ]: Writing injected SQL for node "model.banxware_assignment.top_customer_october_2023"
[0m00:09:12.944031 [debug] [Thread-4  ]: Began executing node model.banxware_assignment.top_customer_october_2023
[0m00:09:12.944408 [debug] [Thread-2  ]: Began executing node model.banxware_assignment.top_5_customers_2023
[0m00:09:12.944788 [debug] [Thread-1  ]: Began executing node model.banxware_assignment.avg_order_value_by_month_2023
[0m00:09:12.945146 [debug] [Thread-3  ]: Began executing node model.banxware_assignment.top_5_products_2023
[0m00:09:12.976100 [debug] [Thread-4  ]: Writing runtime sql for node "model.banxware_assignment.top_customer_october_2023"
[0m00:09:12.979433 [debug] [Thread-2  ]: Writing runtime sql for node "model.banxware_assignment.top_5_customers_2023"
[0m00:09:12.982057 [debug] [Thread-1  ]: Writing runtime sql for node "model.banxware_assignment.avg_order_value_by_month_2023"
[0m00:09:12.984634 [debug] [Thread-3  ]: Writing runtime sql for node "model.banxware_assignment.top_5_products_2023"
[0m00:09:12.985942 [debug] [Thread-4  ]: Using snowflake connection "model.banxware_assignment.top_customer_october_2023"
[0m00:09:12.986761 [debug] [Thread-2  ]: Using snowflake connection "model.banxware_assignment.top_5_customers_2023"
[0m00:09:12.987101 [debug] [Thread-4  ]: On model.banxware_assignment.top_customer_october_2023: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.top_customer_october_2023"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.top_customer_october_2023
  
   as (
    -- queries/top_customer_october_2023.sql

SELECT 
    customer_id,
    COUNT(order_id) AS order_volume
FROM HOME_ASSIGNMENT.PUBLIC.transformed_sales_data
WHERE order_year = 2023
AND order_month = 10
GROUP BY customer_id
ORDER BY order_volume DESC
LIMIT 1
  );
[0m00:09:12.987809 [debug] [Thread-1  ]: Using snowflake connection "model.banxware_assignment.avg_order_value_by_month_2023"
[0m00:09:12.988158 [debug] [Thread-2  ]: On model.banxware_assignment.top_5_customers_2023: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.top_5_customers_2023"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.top_5_customers_2023
  
   as (
    -- queries/top_5_customers_2023.sql

SELECT 
    c.customer_name,
    SUM(t.total_sales_amount) AS total_sales
FROM HOME_ASSIGNMENT.PUBLIC.transformed_sales_data t
JOIN HOME_ASSIGNMENT.PUBLIC.raw_customer_data c ON t.customer_id = c.customer_id
WHERE t.order_year = 2023
GROUP BY c.customer_name
ORDER BY total_sales DESC
LIMIT 5
  );
[0m00:09:12.988830 [debug] [Thread-3  ]: Using snowflake connection "model.banxware_assignment.top_5_products_2023"
[0m00:09:12.989197 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m00:09:12.989530 [debug] [Thread-1  ]: On model.banxware_assignment.avg_order_value_by_month_2023: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.avg_order_value_by_month_2023"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.avg_order_value_by_month_2023
  
   as (
    -- queries/avg_order_value_by_month_2023.sql

SELECT 
    order_month,
    AVG(total_sales_amount) AS avg_order_value
FROM HOME_ASSIGNMENT.PUBLIC.transformed_sales_data
WHERE order_year = 2023
GROUP BY order_month
ORDER BY order_month
  );
[0m00:09:12.989846 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m00:09:12.990151 [debug] [Thread-3  ]: On model.banxware_assignment.top_5_products_2023: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.top_5_products_2023"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.top_5_products_2023
  
   as (
    -- queries/top_5_products_2023.sql

SELECT 
    product_name,
    SUM(total_sales_amount) AS total_sales
FROM HOME_ASSIGNMENT.PUBLIC.transformed_sales_data
WHERE order_year = 2023
GROUP BY product_name
ORDER BY total_sales DESC
LIMIT 5
  );
[0m00:09:12.991036 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:09:12.992129 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m00:09:13.455100 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01b6e6f1-0103-075f-0000-0002ef22d1ad
[0m00:09:13.455886 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 4
invalid identifier 'C.CUSTOMER_NAME'
[0m00:09:13.456647 [debug] [Thread-2  ]: On model.banxware_assignment.top_5_customers_2023: Close
[0m00:09:13.461728 [debug] [Thread-3  ]: Snowflake adapter: Snowflake query id: 01b6e6f1-0103-0748-0000-0002ef22c1e1
[0m00:09:13.462247 [debug] [Thread-3  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 4
invalid identifier 'PRODUCT_NAME'
[0m00:09:13.462874 [debug] [Thread-3  ]: On model.banxware_assignment.top_5_products_2023: Close
[0m00:09:13.550083 [debug] [Thread-3  ]: Database Error in model top_5_products_2023 (models/queries/top_5_products_2023.sql)
  000904 (42000): SQL compilation error: error line 7 at position 4
  invalid identifier 'PRODUCT_NAME'
  compiled Code at target/run/banxware_assignment/models/queries/top_5_products_2023.sql
[0m00:09:13.551769 [debug] [Thread-2  ]: Database Error in model top_5_customers_2023 (models/queries/top_5_customers_2023.sql)
  000904 (42000): SQL compilation error: error line 7 at position 4
  invalid identifier 'C.CUSTOMER_NAME'
  compiled Code at target/run/banxware_assignment/models/queries/top_5_customers_2023.sql
[0m00:09:13.554326 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35f3c94c-106f-4aef-ba7d-0bf491863b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c3c6220>]}
[0m00:09:13.555022 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35f3c94c-106f-4aef-ba7d-0bf491863b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c77f3a0>]}
[0m00:09:13.556059 [error] [Thread-3  ]: 3 of 4 ERROR creating sql view model PUBLIC.top_5_products_2023 ................ [[31mERROR[0m in 0.63s]
[0m00:09:13.557161 [error] [Thread-2  ]: 2 of 4 ERROR creating sql view model PUBLIC.top_5_customers_2023 ............... [[31mERROR[0m in 0.64s]
[0m00:09:13.558183 [debug] [Thread-3  ]: Finished running node model.banxware_assignment.top_5_products_2023
[0m00:09:13.558999 [debug] [Thread-2  ]: Finished running node model.banxware_assignment.top_5_customers_2023
[0m00:09:13.585138 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.594 seconds
[0m00:09:13.615301 [debug] [Thread-1  ]: On model.banxware_assignment.avg_order_value_by_month_2023: Close
[0m00:09:13.719959 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35f3c94c-106f-4aef-ba7d-0bf491863b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d5b970>]}
[0m00:09:13.721382 [info ] [Thread-1  ]: 1 of 4 OK created sql view model PUBLIC.avg_order_value_by_month_2023 .......... [[32mSUCCESS 1[0m in 0.80s]
[0m00:09:13.722318 [debug] [Thread-1  ]: Finished running node model.banxware_assignment.avg_order_value_by_month_2023
[0m00:09:15.019911 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.030 seconds
[0m00:09:15.026651 [debug] [Thread-4  ]: On model.banxware_assignment.top_customer_october_2023: Close
[0m00:09:15.109250 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35f3c94c-106f-4aef-ba7d-0bf491863b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c3c6280>]}
[0m00:09:15.111122 [info ] [Thread-4  ]: 4 of 4 OK created sql view model PUBLIC.top_customer_october_2023 .............. [[32mSUCCESS 1[0m in 2.19s]
[0m00:09:15.112175 [debug] [Thread-4  ]: Finished running node model.banxware_assignment.top_customer_october_2023
[0m00:09:15.114694 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:09:15.115241 [debug] [MainThread]: Connection 'model.banxware_assignment.avg_order_value_by_month_2023' was properly closed.
[0m00:09:15.115670 [debug] [MainThread]: Connection 'model.banxware_assignment.top_5_customers_2023' was properly closed.
[0m00:09:15.116072 [debug] [MainThread]: Connection 'model.banxware_assignment.top_5_products_2023' was properly closed.
[0m00:09:15.116460 [debug] [MainThread]: Connection 'model.banxware_assignment.top_customer_october_2023' was properly closed.
[0m00:09:15.117001 [info ] [MainThread]: 
[0m00:09:15.117511 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 3.18 seconds (3.18s).
[0m00:09:15.119173 [debug] [MainThread]: Command end result
[0m00:09:15.161433 [info ] [MainThread]: 
[0m00:09:15.161912 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m00:09:15.162176 [info ] [MainThread]: 
[0m00:09:15.162527 [error] [MainThread]:   Database Error in model top_5_products_2023 (models/queries/top_5_products_2023.sql)
  000904 (42000): SQL compilation error: error line 7 at position 4
  invalid identifier 'PRODUCT_NAME'
  compiled Code at target/run/banxware_assignment/models/queries/top_5_products_2023.sql
[0m00:09:15.162786 [info ] [MainThread]: 
[0m00:09:15.163078 [error] [MainThread]:   Database Error in model top_5_customers_2023 (models/queries/top_5_customers_2023.sql)
  000904 (42000): SQL compilation error: error line 7 at position 4
  invalid identifier 'C.CUSTOMER_NAME'
  compiled Code at target/run/banxware_assignment/models/queries/top_5_customers_2023.sql
[0m00:09:15.163325 [info ] [MainThread]: 
[0m00:09:15.163578 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m00:09:15.166265 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.2149568, "process_user_time": 5.116603, "process_kernel_time": 0.494156, "process_mem_max_rss": "196476928", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:09:15.166703 [debug] [MainThread]: Command `dbt run` failed at 00:09:15.166633 after 5.22 seconds
[0m00:09:15.167032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de9430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c325f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c5a9a0>]}
[0m00:09:15.167326 [debug] [MainThread]: Flushing usage events
[0m00:13:37.107568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a65430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b60d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b60130>]}


============================== 00:13:37.111838 | 46a1afe0-9184-48b5-a104-5bcb397ceac3 ==============================
[0m00:13:37.111838 [info ] [MainThread]: Running with dbt=1.8.6
[0m00:13:37.112357 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs', 'profiles_dir': '/Users/neerajchauhan/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models queries', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:13:38.282890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46a1afe0-9184-48b5-a104-5bcb397ceac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d33b640>]}
[0m00:13:38.342756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46a1afe0-9184-48b5-a104-5bcb397ceac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108991160>]}
[0m00:13:38.344205 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m00:13:38.360623 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m00:13:38.500970 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:13:38.501557 [debug] [MainThread]: Partial parsing: updated file: banxware_assignment://models/queries/top_5_products_2023.sql
[0m00:13:38.501913 [debug] [MainThread]: Partial parsing: updated file: banxware_assignment://models/queries/top_5_customers_2023.sql
[0m00:13:38.799978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46a1afe0-9184-48b5-a104-5bcb397ceac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13da45130>]}
[0m00:13:38.900465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46a1afe0-9184-48b5-a104-5bcb397ceac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13da635b0>]}
[0m00:13:38.900990 [info ] [MainThread]: Found 7 models, 2 seeds, 4 data tests, 448 macros
[0m00:13:38.901379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46a1afe0-9184-48b5-a104-5bcb397ceac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d9f30d0>]}
[0m00:13:38.902685 [info ] [MainThread]: 
[0m00:13:38.903181 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:13:38.907367 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOME_ASSIGNMENT'
[0m00:13:38.919694 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT"
[0m00:13:38.920102 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT"} */
show terse schemas in database HOME_ASSIGNMENT
    limit 10000
[0m00:13:38.920363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:13:39.316995 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.396 seconds
[0m00:13:39.320707 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: Close
[0m00:13:39.427960 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT, now list_HOME_ASSIGNMENT_PUBLIC)
[0m00:13:39.443633 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT_PUBLIC"
[0m00:13:39.444129 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT_PUBLIC"} */
show objects in HOME_ASSIGNMENT.PUBLIC limit 10000
[0m00:13:39.444539 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:13:39.892504 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.448 seconds
[0m00:13:39.897760 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: Close
[0m00:13:40.133384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46a1afe0-9184-48b5-a104-5bcb397ceac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d33b340>]}
[0m00:13:40.134394 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:13:40.134928 [info ] [MainThread]: 
[0m00:13:40.139069 [debug] [Thread-1  ]: Began running node model.banxware_assignment.avg_order_value_by_month_2023
[0m00:13:40.139750 [debug] [Thread-2  ]: Began running node model.banxware_assignment.top_5_customers_2023
[0m00:13:40.140341 [debug] [Thread-3  ]: Began running node model.banxware_assignment.top_5_products_2023
[0m00:13:40.141296 [debug] [Thread-4  ]: Began running node model.banxware_assignment.top_customer_october_2023
[0m00:13:40.142127 [info ] [Thread-1  ]: 1 of 4 START sql view model PUBLIC.avg_order_value_by_month_2023 ............... [RUN]
[0m00:13:40.142891 [info ] [Thread-2  ]: 2 of 4 START sql view model PUBLIC.top_5_customers_2023 ........................ [RUN]
[0m00:13:40.143537 [info ] [Thread-3  ]: 3 of 4 START sql view model PUBLIC.top_5_products_2023 ......................... [RUN]
[0m00:13:40.144167 [info ] [Thread-4  ]: 4 of 4 START sql view model PUBLIC.top_customer_october_2023 ................... [RUN]
[0m00:13:40.144767 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT_PUBLIC, now model.banxware_assignment.avg_order_value_by_month_2023)
[0m00:13:40.145399 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.banxware_assignment.top_5_customers_2023'
[0m00:13:40.145954 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.banxware_assignment.top_5_products_2023'
[0m00:13:40.146520 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.banxware_assignment.top_customer_october_2023'
[0m00:13:40.146973 [debug] [Thread-1  ]: Began compiling node model.banxware_assignment.avg_order_value_by_month_2023
[0m00:13:40.147401 [debug] [Thread-2  ]: Began compiling node model.banxware_assignment.top_5_customers_2023
[0m00:13:40.147809 [debug] [Thread-3  ]: Began compiling node model.banxware_assignment.top_5_products_2023
[0m00:13:40.148227 [debug] [Thread-4  ]: Began compiling node model.banxware_assignment.top_customer_october_2023
[0m00:13:40.158857 [debug] [Thread-1  ]: Writing injected SQL for node "model.banxware_assignment.avg_order_value_by_month_2023"
[0m00:13:40.161367 [debug] [Thread-2  ]: Writing injected SQL for node "model.banxware_assignment.top_5_customers_2023"
[0m00:13:40.163613 [debug] [Thread-3  ]: Writing injected SQL for node "model.banxware_assignment.top_5_products_2023"
[0m00:13:40.166451 [debug] [Thread-4  ]: Writing injected SQL for node "model.banxware_assignment.top_customer_october_2023"
[0m00:13:40.167886 [debug] [Thread-3  ]: Began executing node model.banxware_assignment.top_5_products_2023
[0m00:13:40.168288 [debug] [Thread-4  ]: Began executing node model.banxware_assignment.top_customer_october_2023
[0m00:13:40.168619 [debug] [Thread-2  ]: Began executing node model.banxware_assignment.top_5_customers_2023
[0m00:13:40.175336 [debug] [Thread-1  ]: Began executing node model.banxware_assignment.avg_order_value_by_month_2023
[0m00:13:40.212409 [debug] [Thread-3  ]: Writing runtime sql for node "model.banxware_assignment.top_5_products_2023"
[0m00:13:40.215437 [debug] [Thread-4  ]: Writing runtime sql for node "model.banxware_assignment.top_customer_october_2023"
[0m00:13:40.215945 [debug] [Thread-2  ]: Writing runtime sql for node "model.banxware_assignment.top_5_customers_2023"
[0m00:13:40.218720 [debug] [Thread-1  ]: Writing runtime sql for node "model.banxware_assignment.avg_order_value_by_month_2023"
[0m00:13:40.220151 [debug] [Thread-4  ]: Using snowflake connection "model.banxware_assignment.top_customer_october_2023"
[0m00:13:40.220902 [debug] [Thread-1  ]: Using snowflake connection "model.banxware_assignment.avg_order_value_by_month_2023"
[0m00:13:40.221657 [debug] [Thread-3  ]: Using snowflake connection "model.banxware_assignment.top_5_products_2023"
[0m00:13:40.222383 [debug] [Thread-2  ]: Using snowflake connection "model.banxware_assignment.top_5_customers_2023"
[0m00:13:40.222683 [debug] [Thread-4  ]: On model.banxware_assignment.top_customer_october_2023: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.top_customer_october_2023"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.top_customer_october_2023
  
   as (
    -- queries/top_customer_october_2023.sql

SELECT 
    customer_id,
    COUNT(order_id) AS order_volume
FROM HOME_ASSIGNMENT.PUBLIC.transformed_sales_data
WHERE order_year = 2023
AND order_month = 10
GROUP BY customer_id
ORDER BY order_volume DESC
LIMIT 1
  );
[0m00:13:40.223084 [debug] [Thread-1  ]: On model.banxware_assignment.avg_order_value_by_month_2023: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.avg_order_value_by_month_2023"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.avg_order_value_by_month_2023
  
   as (
    -- queries/avg_order_value_by_month_2023.sql

SELECT 
    order_month,
    AVG(total_sales_amount) AS avg_order_value
FROM HOME_ASSIGNMENT.PUBLIC.transformed_sales_data
WHERE order_year = 2023
GROUP BY order_month
ORDER BY order_month
  );
[0m00:13:40.223567 [debug] [Thread-3  ]: On model.banxware_assignment.top_5_products_2023: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.top_5_products_2023"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.top_5_products_2023
  
   as (
    SELECT 
    r.PRODUCT_NAME,
    SUM(t.TOTAL_SALES_AMOUNT) AS total_sales
FROM HOME_ASSIGNMENT.PUBLIC.TRANSFORMED_SALES_DATA t
JOIN HOME_ASSIGNMENT.PUBLIC.RAW_SALES_DATA r
    ON t.ORDER_ID = r.ORDER_ID
WHERE t.ORDER_YEAR = 2023
GROUP BY r.PRODUCT_NAME
ORDER BY total_sales DESC
LIMIT 5;
[0m00:13:40.223938 [debug] [Thread-2  ]: On model.banxware_assignment.top_5_customers_2023: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.top_5_customers_2023"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.top_5_customers_2023
  
   as (
    SELECT 
    c.NAME AS customer_name,
    SUM(t.TOTAL_SALES_AMOUNT) AS total_sales
FROM HOME_ASSIGNMENT.PUBLIC.TRANSFORMED_SALES_DATA t
JOIN HOME_ASSIGNMENT.PUBLIC.RAW_CUSTOMER_DATA c
    ON t.CUSTOMER_ID = c.ID
WHERE t.ORDER_YEAR = 2023
GROUP BY c.NAME
ORDER BY total_sales DESC
LIMIT 5;
[0m00:13:40.224286 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m00:13:40.224581 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:13:40.224852 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m00:13:40.225122 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m00:14:06.002506 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:14:06.447341 [debug] [MainThread]: Snowflake adapter: Cancelling query 'model.banxware_assignment.avg_order_value_by_month_2023' (12601933721)
[0m00:14:06.448551 [debug] [MainThread]: Using snowflake connection "master"
[0m00:14:06.449078 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "master"} */
select system$cancel_all_queries(12601933721)
[0m00:14:06.449571 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:14:06.994959 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.545 seconds
[0m00:14:06.998431 [debug] [MainThread]: Snowflake adapter: Cancel query 'model.banxware_assignment.avg_order_value_by_month_2023': ('0 cancelled. ',)
[0m00:14:06.999072 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:14:07.246522 [debug] [MainThread]: Snowflake adapter: Cancelling query 'model.banxware_assignment.top_5_customers_2023' (12601933725)
[0m00:14:07.248125 [debug] [MainThread]: Using snowflake connection "master"
[0m00:14:07.248693 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "master"} */
select system$cancel_all_queries(12601933725)
[0m00:14:07.317823 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.068 seconds
[0m00:14:07.319873 [debug] [MainThread]: Snowflake adapter: Cancel query 'model.banxware_assignment.top_5_customers_2023': ('0 cancelled. ',)
[0m00:14:07.320813 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:14:07.530700 [debug] [MainThread]: Snowflake adapter: Cancelling query 'model.banxware_assignment.top_5_products_2023' (12601929405)
[0m00:14:07.532390 [debug] [MainThread]: Using snowflake connection "master"
[0m00:14:07.532889 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "master"} */
select system$cancel_all_queries(12601929405)
[0m00:14:07.618837 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.085 seconds
[0m00:14:07.620724 [debug] [MainThread]: Snowflake adapter: Cancel query 'model.banxware_assignment.top_5_products_2023': ('0 cancelled. ',)
[0m00:14:07.621511 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:14:07.943715 [debug] [MainThread]: Snowflake adapter: Cancelling query 'model.banxware_assignment.top_customer_october_2023' (12601945605)
[0m00:14:07.945195 [debug] [MainThread]: Using snowflake connection "master"
[0m00:14:07.945903 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "master"} */
select system$cancel_all_queries(12601945605)
[0m00:14:08.021494 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.075 seconds
[0m00:14:08.023286 [debug] [MainThread]: Snowflake adapter: Cancel query 'model.banxware_assignment.top_customer_october_2023': ('0 cancelled. ',)
[0m00:14:08.024436 [error] [MainThread]: CANCEL query model.banxware_assignment.avg_order_value_by_month_2023 ........... [[31mCANCEL[0m]
[0m00:14:08.025070 [error] [MainThread]: CANCEL query model.banxware_assignment.top_5_customers_2023 .................... [[31mCANCEL[0m]
[0m00:14:08.026181 [error] [MainThread]: CANCEL query model.banxware_assignment.top_5_products_2023 ..................... [[31mCANCEL[0m]
[0m00:14:08.026971 [error] [MainThread]: CANCEL query model.banxware_assignment.top_customer_october_2023 ............... [[31mCANCEL[0m]
[0m00:14:08.027639 [debug] [MainThread]: On master: Close
[0m00:14:10.030605 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:14:10.031783 [debug] [MainThread]: Connection 'model.banxware_assignment.avg_order_value_by_month_2023' was left open.
[0m00:14:10.032364 [debug] [MainThread]: On model.banxware_assignment.avg_order_value_by_month_2023: Close
[0m00:14:10.153997 [debug] [MainThread]: Connection 'model.banxware_assignment.top_5_customers_2023' was left open.
[0m00:14:10.155937 [debug] [MainThread]: On model.banxware_assignment.top_5_customers_2023: Close
[0m00:14:10.237990 [debug] [MainThread]: Connection 'model.banxware_assignment.top_5_products_2023' was left open.
[0m00:14:10.238741 [debug] [MainThread]: On model.banxware_assignment.top_5_products_2023: Close
[0m00:14:10.336782 [debug] [MainThread]: Connection 'model.banxware_assignment.top_customer_october_2023' was left open.
[0m00:14:10.337827 [debug] [MainThread]: On model.banxware_assignment.top_customer_october_2023: Close
[0m00:14:10.433873 [info ] [MainThread]: 
[0m00:14:10.434878 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 31.53 seconds (31.53s).
[0m00:14:10.435865 [error] [MainThread]: Encountered an error:

[0m00:14:10.445460 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/neerajchauhan/mambaforge/envs/virat/lib/python3.9/site-packages/dbt/task/runnable.py", line 397, in execute_nodes
    self.run_queue(pool)
  File "/Users/neerajchauhan/mambaforge/envs/virat/lib/python3.9/site-packages/dbt/task/runnable.py", line 315, in run_queue
    self.job_queue.join()
  File "/Users/neerajchauhan/mambaforge/envs/virat/lib/python3.9/site-packages/dbt/graph/queue.py", line 198, in join
    self.inner.join()
  File "/Users/neerajchauhan/mambaforge/envs/virat/lib/python3.9/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/Users/neerajchauhan/mambaforge/envs/virat/lib/python3.9/threading.py", line 312, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/neerajchauhan/mambaforge/envs/virat/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/neerajchauhan/mambaforge/envs/virat/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/Users/neerajchauhan/mambaforge/envs/virat/lib/python3.9/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/Users/neerajchauhan/mambaforge/envs/virat/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/Users/neerajchauhan/mambaforge/envs/virat/lib/python3.9/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/Users/neerajchauhan/mambaforge/envs/virat/lib/python3.9/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "/Users/neerajchauhan/mambaforge/envs/virat/lib/python3.9/site-packages/dbt/cli/main.py", line 569, in run
    results = task.run()
  File "/Users/neerajchauhan/mambaforge/envs/virat/lib/python3.9/site-packages/dbt/task/runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/neerajchauhan/mambaforge/envs/virat/lib/python3.9/site-packages/dbt/task/runnable.py", line 487, in execute_with_hooks
    res = self.execute_nodes()
  File "/Users/neerajchauhan/mambaforge/envs/virat/lib/python3.9/site-packages/dbt/task/runnable.py", line 422, in execute_nodes
    self._cancel_connections(pool)
  File "/Users/neerajchauhan/mambaforge/envs/virat/lib/python3.9/site-packages/dbt/task/runnable.py", line 379, in _cancel_connections
    pool.join()
  File "/Users/neerajchauhan/mambaforge/envs/virat/lib/python3.9/multiprocessing/pool.py", line 666, in join
    p.join()
  File "/Users/neerajchauhan/mambaforge/envs/virat/lib/python3.9/threading.py", line 1053, in join
    self._wait_for_tstate_lock()
  File "/Users/neerajchauhan/mambaforge/envs/virat/lib/python3.9/threading.py", line 1069, in _wait_for_tstate_lock
    elif lock.acquire(block, timeout):
KeyboardInterrupt

[0m00:14:10.450718 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 33.413048, "process_user_time": 5.312029, "process_kernel_time": 0.489427, "process_mem_max_rss": "197640192", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:14:10.451647 [debug] [MainThread]: Command `dbt run` failed at 00:14:10.451511 after 33.41 seconds
[0m00:14:10.452367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a65430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13da35cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13da35a90>]}
[0m00:14:10.452900 [debug] [MainThread]: Flushing usage events
[0m00:14:17.296838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bbd400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129e8910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129e8460>]}


============================== 00:14:17.300731 | aba22302-8453-46f4-a996-61638137803f ==============================
[0m00:14:17.300731 [info ] [MainThread]: Running with dbt=1.8.6
[0m00:14:17.301223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/neerajchauhan/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models queries', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:14:18.289493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aba22302-8453-46f4-a996-61638137803f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119a2070>]}
[0m00:14:18.350060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aba22302-8453-46f4-a996-61638137803f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112976310>]}
[0m00:14:18.351006 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m00:14:18.369782 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m00:14:18.511489 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:14:18.512087 [debug] [MainThread]: Partial parsing: updated file: banxware_assignment://models/queries/top_5_products_2023.sql
[0m00:14:18.512445 [debug] [MainThread]: Partial parsing: updated file: banxware_assignment://models/queries/top_5_customers_2023.sql
[0m00:14:18.811414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aba22302-8453-46f4-a996-61638137803f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e005fd0>]}
[0m00:14:18.912219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aba22302-8453-46f4-a996-61638137803f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e025760>]}
[0m00:14:18.912695 [info ] [MainThread]: Found 7 models, 2 seeds, 4 data tests, 448 macros
[0m00:14:18.912999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aba22302-8453-46f4-a996-61638137803f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13dfb2220>]}
[0m00:14:18.914128 [info ] [MainThread]: 
[0m00:14:18.914587 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:14:18.918543 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOME_ASSIGNMENT'
[0m00:14:18.930613 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT"
[0m00:14:18.930924 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT"} */
show terse schemas in database HOME_ASSIGNMENT
    limit 10000
[0m00:14:18.931178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:19.292380 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.361 seconds
[0m00:14:19.295284 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: Close
[0m00:14:19.380113 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT, now list_HOME_ASSIGNMENT_PUBLIC)
[0m00:14:19.395061 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT_PUBLIC"
[0m00:14:19.395577 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT_PUBLIC"} */
show objects in HOME_ASSIGNMENT.PUBLIC limit 10000
[0m00:14:19.395966 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:19.733311 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.337 seconds
[0m00:14:19.738110 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: Close
[0m00:14:19.833755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aba22302-8453-46f4-a996-61638137803f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d7e7a30>]}
[0m00:14:19.834815 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:14:19.835375 [info ] [MainThread]: 
[0m00:14:19.839665 [debug] [Thread-1  ]: Began running node model.banxware_assignment.avg_order_value_by_month_2023
[0m00:14:19.840370 [debug] [Thread-2  ]: Began running node model.banxware_assignment.top_5_customers_2023
[0m00:14:19.841245 [info ] [Thread-1  ]: 1 of 4 START sql view model PUBLIC.avg_order_value_by_month_2023 ............... [RUN]
[0m00:14:19.842677 [info ] [Thread-2  ]: 2 of 4 START sql view model PUBLIC.top_5_customers_2023 ........................ [RUN]
[0m00:14:19.841970 [debug] [Thread-3  ]: Began running node model.banxware_assignment.top_5_products_2023
[0m00:14:19.843784 [debug] [Thread-4  ]: Began running node model.banxware_assignment.top_customer_october_2023
[0m00:14:19.844424 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT_PUBLIC, now model.banxware_assignment.avg_order_value_by_month_2023)
[0m00:14:19.845156 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.banxware_assignment.top_5_customers_2023'
[0m00:14:19.845913 [info ] [Thread-3  ]: 3 of 4 START sql view model PUBLIC.top_5_products_2023 ......................... [RUN]
[0m00:14:19.846563 [info ] [Thread-4  ]: 4 of 4 START sql view model PUBLIC.top_customer_october_2023 ................... [RUN]
[0m00:14:19.847081 [debug] [Thread-1  ]: Began compiling node model.banxware_assignment.avg_order_value_by_month_2023
[0m00:14:19.847521 [debug] [Thread-2  ]: Began compiling node model.banxware_assignment.top_5_customers_2023
[0m00:14:19.848072 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.banxware_assignment.top_5_products_2023'
[0m00:14:19.848625 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.banxware_assignment.top_customer_october_2023'
[0m00:14:19.859839 [debug] [Thread-1  ]: Writing injected SQL for node "model.banxware_assignment.avg_order_value_by_month_2023"
[0m00:14:19.862167 [debug] [Thread-2  ]: Writing injected SQL for node "model.banxware_assignment.top_5_customers_2023"
[0m00:14:19.862594 [debug] [Thread-3  ]: Began compiling node model.banxware_assignment.top_5_products_2023
[0m00:14:19.862986 [debug] [Thread-4  ]: Began compiling node model.banxware_assignment.top_customer_october_2023
[0m00:14:19.865617 [debug] [Thread-3  ]: Writing injected SQL for node "model.banxware_assignment.top_5_products_2023"
[0m00:14:19.868638 [debug] [Thread-4  ]: Writing injected SQL for node "model.banxware_assignment.top_customer_october_2023"
[0m00:14:19.869226 [debug] [Thread-1  ]: Began executing node model.banxware_assignment.avg_order_value_by_month_2023
[0m00:14:19.869649 [debug] [Thread-2  ]: Began executing node model.banxware_assignment.top_5_customers_2023
[0m00:14:19.881570 [debug] [Thread-3  ]: Began executing node model.banxware_assignment.top_5_products_2023
[0m00:14:19.900451 [debug] [Thread-4  ]: Began executing node model.banxware_assignment.top_customer_october_2023
[0m00:14:19.927264 [debug] [Thread-3  ]: Writing runtime sql for node "model.banxware_assignment.top_5_products_2023"
[0m00:14:19.927759 [debug] [Thread-1  ]: Writing runtime sql for node "model.banxware_assignment.avg_order_value_by_month_2023"
[0m00:14:19.929671 [debug] [Thread-2  ]: Writing runtime sql for node "model.banxware_assignment.top_5_customers_2023"
[0m00:14:19.930765 [debug] [Thread-4  ]: Writing runtime sql for node "model.banxware_assignment.top_customer_october_2023"
[0m00:14:19.932210 [debug] [Thread-1  ]: Using snowflake connection "model.banxware_assignment.avg_order_value_by_month_2023"
[0m00:14:19.932951 [debug] [Thread-4  ]: Using snowflake connection "model.banxware_assignment.top_customer_october_2023"
[0m00:14:19.933699 [debug] [Thread-3  ]: Using snowflake connection "model.banxware_assignment.top_5_products_2023"
[0m00:14:19.934431 [debug] [Thread-2  ]: Using snowflake connection "model.banxware_assignment.top_5_customers_2023"
[0m00:14:19.934739 [debug] [Thread-1  ]: On model.banxware_assignment.avg_order_value_by_month_2023: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.avg_order_value_by_month_2023"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.avg_order_value_by_month_2023
  
   as (
    -- queries/avg_order_value_by_month_2023.sql

SELECT 
    order_month,
    AVG(total_sales_amount) AS avg_order_value
FROM HOME_ASSIGNMENT.PUBLIC.transformed_sales_data
WHERE order_year = 2023
GROUP BY order_month
ORDER BY order_month
  );
[0m00:14:19.935106 [debug] [Thread-4  ]: On model.banxware_assignment.top_customer_october_2023: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.top_customer_october_2023"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.top_customer_october_2023
  
   as (
    -- queries/top_customer_october_2023.sql

SELECT 
    customer_id,
    COUNT(order_id) AS order_volume
FROM HOME_ASSIGNMENT.PUBLIC.transformed_sales_data
WHERE order_year = 2023
AND order_month = 10
GROUP BY customer_id
ORDER BY order_volume DESC
LIMIT 1
  );
[0m00:14:19.935485 [debug] [Thread-3  ]: On model.banxware_assignment.top_5_products_2023: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.top_5_products_2023"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.top_5_products_2023
  
   as (
    SELECT 
    r.PRODUCT_NAME,
    SUM(t.TOTAL_SALES_AMOUNT) AS total_sales
FROM HOME_ASSIGNMENT.PUBLIC.TRANSFORMED_SALES_DATA t
JOIN HOME_ASSIGNMENT.PUBLIC.RAW_SALES_DATA r
    ON t.ORDER_ID = r.ORDER_ID
WHERE t.ORDER_YEAR = 2023
GROUP BY r.PRODUCT_NAME
ORDER BY total_sales DESC
LIMIT 5
  );
[0m00:14:19.935824 [debug] [Thread-2  ]: On model.banxware_assignment.top_5_customers_2023: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.top_5_customers_2023"} */
create or replace   view HOME_ASSIGNMENT.PUBLIC.top_5_customers_2023
  
   as (
    SELECT 
    c.NAME AS customer_name,
    SUM(t.TOTAL_SALES_AMOUNT) AS total_sales
FROM HOME_ASSIGNMENT.PUBLIC.TRANSFORMED_SALES_DATA t
JOIN HOME_ASSIGNMENT.PUBLIC.RAW_CUSTOMER_DATA c
    ON t.CUSTOMER_ID = c.ID
WHERE t.ORDER_YEAR = 2023
GROUP BY c.NAME
ORDER BY total_sales DESC
LIMIT 5
  );
[0m00:14:19.936148 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:14:19.936427 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m00:14:19.936707 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m00:14:19.936973 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m00:14:20.433015 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.495 seconds
[0m00:14:20.470621 [debug] [Thread-2  ]: On model.banxware_assignment.top_5_customers_2023: Close
[0m00:14:20.472949 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.536 seconds
[0m00:14:20.475296 [debug] [Thread-3  ]: On model.banxware_assignment.top_5_products_2023: Close
[0m00:14:20.477128 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.541 seconds
[0m00:14:20.488940 [debug] [Thread-1  ]: On model.banxware_assignment.avg_order_value_by_month_2023: Close
[0m00:14:20.542030 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.606 seconds
[0m00:14:20.544214 [debug] [Thread-4  ]: On model.banxware_assignment.top_customer_october_2023: Close
[0m00:14:20.578457 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aba22302-8453-46f4-a996-61638137803f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e2647c0>]}
[0m00:14:20.579101 [info ] [Thread-2  ]: 2 of 4 OK created sql view model PUBLIC.top_5_customers_2023 ................... [[32mSUCCESS 1[0m in 0.73s]
[0m00:14:20.579630 [debug] [Thread-2  ]: Finished running node model.banxware_assignment.top_5_customers_2023
[0m00:14:20.581775 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aba22302-8453-46f4-a996-61638137803f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e225f70>]}
[0m00:14:20.582232 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aba22302-8453-46f4-a996-61638137803f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d7e7a30>]}
[0m00:14:20.582760 [info ] [Thread-1  ]: 1 of 4 OK created sql view model PUBLIC.avg_order_value_by_month_2023 .......... [[32mSUCCESS 1[0m in 0.74s]
[0m00:14:20.583240 [info ] [Thread-3  ]: 3 of 4 OK created sql view model PUBLIC.top_5_products_2023 .................... [[32mSUCCESS 1[0m in 0.73s]
[0m00:14:20.583792 [debug] [Thread-1  ]: Finished running node model.banxware_assignment.avg_order_value_by_month_2023
[0m00:14:20.584257 [debug] [Thread-3  ]: Finished running node model.banxware_assignment.top_5_products_2023
[0m00:14:20.611476 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aba22302-8453-46f4-a996-61638137803f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e1d02e0>]}
[0m00:14:20.612035 [info ] [Thread-4  ]: 4 of 4 OK created sql view model PUBLIC.top_customer_october_2023 .............. [[32mSUCCESS 1[0m in 0.76s]
[0m00:14:20.612559 [debug] [Thread-4  ]: Finished running node model.banxware_assignment.top_customer_october_2023
[0m00:14:20.613590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:14:20.613868 [debug] [MainThread]: Connection 'model.banxware_assignment.avg_order_value_by_month_2023' was properly closed.
[0m00:14:20.614112 [debug] [MainThread]: Connection 'model.banxware_assignment.top_5_customers_2023' was properly closed.
[0m00:14:20.614347 [debug] [MainThread]: Connection 'model.banxware_assignment.top_5_products_2023' was properly closed.
[0m00:14:20.614579 [debug] [MainThread]: Connection 'model.banxware_assignment.top_customer_october_2023' was properly closed.
[0m00:14:20.614900 [info ] [MainThread]: 
[0m00:14:20.615195 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 1.70 seconds (1.70s).
[0m00:14:20.616260 [debug] [MainThread]: Command end result
[0m00:14:20.647797 [info ] [MainThread]: 
[0m00:14:20.648212 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:14:20.648482 [info ] [MainThread]: 
[0m00:14:20.648758 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:14:20.651363 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.4223907, "process_user_time": 5.036833, "process_kernel_time": 0.346939, "process_mem_max_rss": "196460544", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:14:20.651773 [debug] [MainThread]: Command `dbt run` succeeded at 00:14:20.651699 after 3.42 seconds
[0m00:14:20.652083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bbd400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112976310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119a7c10>]}
[0m00:14:20.652389 [debug] [MainThread]: Flushing usage events
[0m03:43:25.654135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10326d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053a0ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053a02b0>]}


============================== 03:43:25.657250 | 33201a61-d9f7-4a88-8b92-475d9eb4f961 ==============================
[0m03:43:25.657250 [info ] [MainThread]: Running with dbt=1.8.6
[0m03:43:25.657633 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/neerajchauhan/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/neerajchauhan/data-engineering-home-assignment/dbt_banxware_assignment/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models transformed_sales_data', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:43:27.008494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33201a61-d9f7-4a88-8b92-475d9eb4f961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034e1670>]}
[0m03:43:27.044502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33201a61-d9f7-4a88-8b92-475d9eb4f961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10532f370>]}
[0m03:43:27.045207 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m03:43:27.063260 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m03:43:27.158177 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:43:27.158635 [debug] [MainThread]: Partial parsing: updated file: banxware_assignment://models/example/schema.yml
[0m03:43:27.233897 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m03:43:27.234222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '33201a61-d9f7-4a88-8b92-475d9eb4f961', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130267a00>]}
[0m03:43:27.356392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33201a61-d9f7-4a88-8b92-475d9eb4f961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130826130>]}
[0m03:43:27.424174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33201a61-d9f7-4a88-8b92-475d9eb4f961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1307cc1c0>]}
[0m03:43:27.424518 [info ] [MainThread]: Found 7 models, 2 seeds, 11 data tests, 448 macros
[0m03:43:27.424708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33201a61-d9f7-4a88-8b92-475d9eb4f961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1308748e0>]}
[0m03:43:27.425415 [info ] [MainThread]: 
[0m03:43:27.425710 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:43:27.426187 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOME_ASSIGNMENT'
[0m03:43:27.433520 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT"
[0m03:43:27.433709 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT"} */
show terse schemas in database HOME_ASSIGNMENT
    limit 10000
[0m03:43:27.433863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:43:28.002003 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.568 seconds
[0m03:43:28.005300 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT: Close
[0m03:43:28.093797 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT, now list_HOME_ASSIGNMENT_PUBLIC)
[0m03:43:28.107821 [debug] [ThreadPool]: Using snowflake connection "list_HOME_ASSIGNMENT_PUBLIC"
[0m03:43:28.108313 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "connection_name": "list_HOME_ASSIGNMENT_PUBLIC"} */
show objects in HOME_ASSIGNMENT.PUBLIC limit 10000
[0m03:43:28.108707 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:43:28.573655 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.465 seconds
[0m03:43:28.580160 [debug] [ThreadPool]: On list_HOME_ASSIGNMENT_PUBLIC: Close
[0m03:43:28.675182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33201a61-d9f7-4a88-8b92-475d9eb4f961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130811910>]}
[0m03:43:28.676310 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:43:28.676828 [info ] [MainThread]: 
[0m03:43:28.680906 [debug] [Thread-1  ]: Began running node model.banxware_assignment.transformed_sales_data
[0m03:43:28.681840 [info ] [Thread-1  ]: 1 of 1 START sql table model PUBLIC.transformed_sales_data ..................... [RUN]
[0m03:43:28.682574 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_HOME_ASSIGNMENT_PUBLIC, now model.banxware_assignment.transformed_sales_data)
[0m03:43:28.683143 [debug] [Thread-1  ]: Began compiling node model.banxware_assignment.transformed_sales_data
[0m03:43:28.696345 [debug] [Thread-1  ]: Writing injected SQL for node "model.banxware_assignment.transformed_sales_data"
[0m03:43:28.698312 [debug] [Thread-1  ]: Began executing node model.banxware_assignment.transformed_sales_data
[0m03:43:28.728718 [debug] [Thread-1  ]: Writing runtime sql for node "model.banxware_assignment.transformed_sales_data"
[0m03:43:28.730488 [debug] [Thread-1  ]: Using snowflake connection "model.banxware_assignment.transformed_sales_data"
[0m03:43:28.730834 [debug] [Thread-1  ]: On model.banxware_assignment.transformed_sales_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "banxware_assignment", "target_name": "dev", "node_id": "model.banxware_assignment.transformed_sales_data"} */
create or replace transient table HOME_ASSIGNMENT.PUBLIC.transformed_sales_data
         as
        (-- models/transformed_sales_data.sql



WITH raw_data AS (
    SELECT
        ORDER_ID AS order_id,
        ORDER_DATE AS order_date,
        CUSTOMER_ID AS customer_id,
        PRODUCT_ID AS product_id,
        PRODUCT_NAME AS product_name,
        QUANTITY AS quantity,
        PRICE AS price,
        ORDER_STATUS AS order_status
    FROM HOME_ASSIGNMENT.PUBLIC.raw_sales_data
),

-- Extract year, month, and day from order_date
extracted_date AS (
    SELECT
        order_id,
        order_date,
        customer_id,
        product_id,
        product_name,
        quantity,
        price,
        order_status,
        EXTRACT(YEAR FROM TO_DATE(order_date, 'MM/DD/YYYY')) AS order_year,
        EXTRACT(MONTH FROM TO_DATE(order_date, 'MM/DD/YYYY')) AS order_month,
        EXTRACT(DAY FROM TO_DATE(order_date, 'MM/DD/YYYY')) AS order_day
    FROM raw_data
),

-- Calculate total sales amount for each order
aggregated_data AS (
    SELECT
        order_id,
        customer_id,
        order_year,
        order_month,
        order_day,
        SUM(quantity * price) AS total_sales_amount
    FROM extracted_date
    GROUP BY
        order_id,
        customer_id,
        order_year,
        order_month,
        order_day
)

SELECT * FROM aggregated_data
        );
[0m03:43:28.731150 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:43:30.492109 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.760 seconds
[0m03:43:30.528598 [debug] [Thread-1  ]: On model.banxware_assignment.transformed_sales_data: Close
[0m03:43:30.601977 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33201a61-d9f7-4a88-8b92-475d9eb4f961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10534f670>]}
[0m03:43:30.603111 [info ] [Thread-1  ]: 1 of 1 OK created sql table model PUBLIC.transformed_sales_data ................ [[32mSUCCESS 1[0m in 1.92s]
[0m03:43:30.604054 [debug] [Thread-1  ]: Finished running node model.banxware_assignment.transformed_sales_data
[0m03:43:30.605728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:43:30.606248 [debug] [MainThread]: Connection 'model.banxware_assignment.transformed_sales_data' was properly closed.
[0m03:43:30.606729 [info ] [MainThread]: 
[0m03:43:30.607232 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.18 seconds (3.18s).
[0m03:43:30.608229 [debug] [MainThread]: Command end result
[0m03:43:30.650929 [info ] [MainThread]: 
[0m03:43:30.651432 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:43:30.651715 [info ] [MainThread]: 
[0m03:43:30.651993 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:43:30.660608 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.0584598, "process_user_time": 3.763824, "process_kernel_time": 0.343913, "process_mem_max_rss": "194969600", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:43:30.661136 [debug] [MainThread]: Command `dbt run` succeeded at 03:43:30.661055 after 5.06 seconds
[0m03:43:30.661462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10326d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10532f370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d9b160>]}
[0m03:43:30.661780 [debug] [MainThread]: Flushing usage events
